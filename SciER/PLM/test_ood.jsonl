{"doc_id": "AAAI2024 (2)", "doc_tokens": ["GxVAEs", ":", "Two", "Joint", "VAEs", "Generate", "Hit", "Molecules", "from", "Gene", "Expression", "Profiles", ".", "The", "de", "novo", "generation", "of", "hit-like", "molecules", "that", "show", "bioactivity", "and", "drug-likeness", "is", "an", "important", "task", "in", "computer-aided", "drug", "discovery", ".", "Although", "artificial", "intelligence", "can", "generate", "molecules", "with", "desired", "chemical", "properties", ",", "most", "previous", "studies", "have", "ignored", "the", "influence", "of", "disease-related", "cellular", "environments", ".", "This", "study", "proposes", "a", "novel", "deep", "generative", "model", "called", "GxVAEs", "to", "generate", "hit-like", "molecules", "from", "gene", "expression", "profiles", "by", "leveraging", "two", "joint", "variational", "autoencoders", "(", "VAEs", ")", ".", "The", "first", "VAE", ",", "ProfileVAE", ",", "extracts", "latent", "features", "from", "gene", "expression", "profiles", ".", "The", "extracted", "features", "serve", "as", "the", "conditions", "that", "guide", "the", "second", "VAE", ",", "which", "is", "called", "MolVAE", ",", "in", "generating", "hit-like", "molecules", ".", "GxVAEs", "bridge", "the", "gap", "between", "molecular", "generation", "and", "the", "cellular", "environment", "in", "a", "biological", "system", ",", "and", "produce", "molecules", "that", "are", "biologically", "meaningful", "in", "the", "context", "of", "specific", "diseases", ".", "Experiments", "and", "case", "studies", "on", "the", "generation", "of", "therapeutic", "molecules", "show", "that", "GxVAEs", "outperforms", "current", "state-of-the-art", "baselines", "and", "yield", "hit-like", "molecules", "with", "potential", "bioactivity", "and", "drug-like", "properties", ".", "Hit", "identification", ",", "which", "involves", "discovering", "hit", "molecules", "with", "the", "desired", "bioactivity", "and", "therapeutic", "effects", "within", "an", "infinite", "chemical", "space", ",", "is", "a", "critical", "challenge", "in", "drug", "discovery", "(", "Dobson", "et", "al", ".", "2004", ")", ".", "Traditionally", ",", "hit", "identification", "campaigns", "have", "been", "conducted", "using", "experimental", "approaches", "such", "as", "high-throughput", "screening", "(", "HTS", ")", "(", "Hertzberg", "and", "Pope", "2000", ")", ".", "HTS", "provides", "a", "valuable", "methodology", "for", "identifying", "hits", "with", "desired", "bioactivity", "(", "Scannell", "et", "al", ".", "2022", ")", ".", "However", ",", "the", "hit", "rate", "observed", "in", "HTS", "campaigns", "tends", "to", "be", "relatively", "low", ",", "which", "results", "in", "many", "molecules", "that", "are", "inactive", "or", "that", "hold", "less", "promise", "being", "screened", "out", "(", "Rahman", "et", "al", ".", "2022", ")", ".", "Additionally", ",", "experimental", "approaches", "to", "drug", "discovery", "typically", "rely", "on", "laborintensive", "and", "time-consuming", "processes", ".", "De", "novo", "molecular", "generation", "using", "artificial", "intelligence", "(", "AI", ")", "techniques", "has", "emerged", "as", "a", "promising", "approach", "for", "computer-aided", "drug", "discovery", ".", "The", "power", "of", "deep", "learning", "and", "computational", "chemistry", "enables", "the", "generation", "of", "new", "molecules", "with", "desired", "bioactivity", "for", "specific", "therapeutic", "targets", ".", "Deep", "generative", "models", ",", "such", "as", "generative", "adversarial", "networks", "(", "GANs", ")", "(", "Guimaraes", "et", "al", ".", "2017", ";", "De", "Cao", "and", "Kipf", "2018", ";", "Li", "et", "al", ".", "2022", ")", "and", "variational", "autoencoders", "(", "VAEs", ")", "(", "Oliveira", ",", "Da", "Silva", ",", "and", "Quiles", "2022", ";", "Dollar", "et", "al", ".", "2021", ";", "Kusner", ",", "Paige", ",", "and", "Hern\u00e1ndez-Lobato", "2017", ";", "Jin", ",", "Barzilay", ",", "and", "Jaakkola", "2018", ")", "accelerate", "the", "drug", "discovery", "process", "by", "employing", "computational", "models", "to", "generate", "molecules", "having", "a", "specific", "bioactivity", ".", "By", "capturing", "the", "essential", "features", "of", "molecules", ",", "deep", "generative", "models", "can", "produce", "new", "molecules", "with", "similar", "structures", "and", "related", "properties", ".", "Most", "AI-driven", "molecular", "generation", "models", "focus", "on", "the", "generation", "of", "new", "molecules", "with", "improved", "chemical", "properties", "of", "interest", ".", "While", "omics-based", "approaches", "to", "drug", "discovery", "offer", "promising", "opportunities", ",", "it", "is", "essential", "to", "understand", "their", "limitations", "(", "Kang", ",", "Ko", ",", "and", "Mersha", "2022", ")", ".", "Interpretation", "of", "omics", "data", "in", "the", "context", "of", "drug", "discovery", "also", "requires", "a", "deep", "understanding", "of", "the", "underlying", "biological", "and", "disease", "mechanisms", ".", "In", "this", "study", ",", "we", "proposed", "GxVAEs", "to", "generate", "hit-like", "molecules", "from", "gene", "expression", "profiles", "using", "two", "joint", "VAEs", "(", "i.e", ".", ",", "ProfileVAE", "and", "MolVAE", ")", ".", "First", ",", "ProfileVAE", "functions", "as", "a", "feature", "extractor", "to", "extract", "latent", "features", "from", "gene", "expression", "profiles", ".", "The", "extracted", "features", "are", "then", "used", "as", "conditions", "to", "guide", "MolVAE", "in", "generating", "hit-like", "molecules", ".", "GxVAEs", "bridges", "the", "gap", "between", "molecular", "generation", "and", "the", "cellular", "environment", "of", "a", "biological", "system", ",", "making", "the", "produced", "molecules", "more", "biologically", "meaningful", "in", "the", "context", "of", "specific", "diseases", ".", "The", "main", "contributions", "of", "this", "study", "are", "summarized", "as", "follows", ":", "\u2022", "Hit-like", "molecular", "generation", "that", "considered", "the", "cellular", "environment", ":", "This", "study", "considers", "the", "influence", "of", "the", "cellular", "environment", "on", "specific", "diseases", "during", "the", "molecular", "generation", "process", ".", "\u2022", "A", "simple", "but", "effective", "model", "architecture", ":", "The", "combination", "of", "two", "VAEs", "successfully", "generated", "hit-like", "molecules", "from", "gene", "expression", "profiles", ".", "\u2022", "Superior", "performance", "over", "state-of-the-art", "(", "SOTA", ")", "models", ":", "Experiments", "and", "case", "studies", "demonstrate", "that", "the", "proposed", "GxVAEs", "outperform", "the", "current", "SOTA", "models", "for", "the", "same", "objectives", ".", "De", "novo", "molecular", "generation", "aims", "to", "produce", "new", "molecules", "with", "specific", "chemical", "properties", ".", "Generally", ",", "the", "data", "structures", "used", "for", "de", "novo", "molecular", "generation", "are", "molecular", "graphs", "(", "Manolopoulos", "and", "Fowler", "1992", ")", "and", "simplified", "molecular", "input", "line", "entry", "system", "(", "SMILES", ")", "strings", "(", "Weininger", "1988", ")", ".", "TransVAE", "(", "Dollar", "et", "al", ".", "2021", ")", "and", "Gram-marVAE", "(", "Kusner", ",", "Paige", ",", "and", "Hern\u00e1ndez-Lobato", "2017", ")", "are", "two", "deep", "generative", "models", "that", "produce", "molecules", "from", "SMILES", "strings", "using", "VAEs", ".", "JTVAE", "(", "Jin", ",", "Barzilay", ",", "and", "Jaakkola", "2018", ")", "uses", "a", "node", "tree", "to", "generate", "molecules", "from", "a", "molecular", "graph", ".", "It", "first", "creates", "a", "tree-structured", "scaffold", "on", "a", "substructure", "and", "then", "combines", "the", "tree-structured", "scaffold", "into", "a", "molecule", "using", "a", "graphical", "message-passing", "network", "(", "Dai", ",", "Dai", ",", "and", "Song", "2016", ")", ".", "MolGAN", "(", "De", "Cao", "and", "Kipf", "2018", ")", "and", "TransORGAN", "(", "Li", "et", "al", ".", "2022", ")", "are", "discrete", "GANs", "that", "use", "reinforcement", "learning", "to", "generate", "molecular", "graphs", "and", "SMILES", "strings", ",", "respectively", ".", "With", "the", "development", "of", "omics", "data", "analysis", ",", "especially", "gene", "expression", "profiles", "used", "in", "drug", "discovery", "(", "Turanli", "et", "al", ".", "2018", ";", "Chen", "et", "al", ".", "2020", ")", ",", "chemists", "have", "begun", "to", "use", "comprehensive", "biological", "response", "information", "to", "generate", "therapeutic", "molecules", "for", "the", "treatment", "of", "specific", "diseases", ".", "ExpressionGAN", "(", "M\u00e9ndez-Lucio", "et", "al", ".", "2020", ")", "and", "TRI-OMPHE", "(", "Kaitoh", "and", "Yamanishi", "2021", ")", "are", "the", "SOTA", "deep", "generative", "models", "that", "are", "most", "relevant", "to", "our", "study", "on", "generating", "hit-like", "molecules", "for", "target", "proteins", "with", "no", "prior", "annotation", "of", "the", "target", "training", "molecules", ".", "Expres-sionGAN", "is", "a", "GAN", "model", "that", "bridges", "systems", "biology", "and", "molecular", "design", "to", "produce", "molecules", "with", "a", "high", "probability", "of", "inducing", "the", "desired", "transcriptome", "features", "automatically", "from", "gene", "expression", "profiles", ".", "TRIOMPHE", "first", "calculates", "the", "correlation", "of", "ligand-target", "interactions", "between", "the", "chemically", "induced", "transcriptome", "profiles", "of", "cellular", "responses", "to", "molecular", "treatment", "and", "the", "transcriptome", "profiles", "of", "gene", "perturbations", "that", "reflect", "cellular", "responses", "to", "gene", "knockdown", "or", "gene", "overexpression", "of", "target", "proteins", ".", "Next", ",", "a", "VAE", "was", "employed", "to", "generate", "a", "new", "molecule", "with", "the", "desired", "transcriptome", "profile", ".", "However", ",", "ExpressionGAN", "generates", "hit-like", "molecules", "with", "low", "validity", "(", ">", "8.5%", ")", ",", "and", "its", "ability", "to", "reproduce", "known", "ligands", "is", "limited", ".", "Additionally", ",", "TRIOMPHE", "only", "utilizes", "gene", "expression", "profiles", "in", "correlation", "calculations", ",", "whose", "VAE", "is", "not", "involved", "in", "molecular", "generation", ".", "To", "address", "these", "issues", ",", "GxVAEs", "were", "proposed", "in", "this", "study", ".", "By", "bridging", "the", "gap", "between", "the", "cellular", "environment", "and", "the", "generation", "of", "ther", "-", "The", "Thirty-Eighth", "AAAI", "Conference", "on", "Artificial", "Intelligence", "(", "AAAI", "-", "24", ")", "apeutic", "molecules", ",", "GxVAEs", "generate", "molecules", "that", "are", "biologically", "meaningful", "in", "the", "context", "of", "specific", "diseases", "using", "gene", "expression", "profiles", ".", "Figure", "1", "shows", "an", "overview", "of", "the", "GxVAEs", ".", "GxVAEs", "mainly", "consists", "of", "two", "joint", "VAEs", ",", "namely", "ProfileVAE", "and", "MolVAE", ".", "ProfileVAE", "acts", "as", "a", "feature", "extractor", "to", "extract", "low-dimensional", "feature", "vectors", "from", "high-dimensional", "gene", "expression", "profiles", ".", "MolVAE", "consists", "of", "bidirectional", "GRUs", "that", "are", "conditioned", "on", "the", "features", "of", "gene", "expression", "profiles", "using", "non-canonical", "SMILES", "(", "i.e", ".", ",", "variant", "SMILES", "(", "Li", "and", "Yamanishi", "2023", ")", ")", "strings", "to", "generate", "hitlike", "molecules", ".", "Note", "that", "teacher", "forcing", "(", "Yan", "et", "al", ".", "2023", ")", "is", "used", "to", "stabilize", "the", "training", "and", "accelerate", "the", "convergence", "of", "the", "GxVAEs", "during", "the", "training", "phase", "of", "the", "MolVAE", ".", "ProfileVAE", ".", "The", "goal", "of", "Profil-eVAE", "is", "to", "learn", "the", "marginal", "likelihood", "of", "gene", "expression", "profiles", "during", "the", "following", "generative", "process", ":", "max", "EQUATION", "where", "E", "[", "\u2022", "]", "is", "an", "expectation", "operation", ",", "C", "is", "the", "latent", "variable", ",", "\u03b8", "and", "\u03d5", "denote", "the", "parameters", "of", "the", "ProfileVAE", "encoder", "and", "ProfileVAE", "decoder", ",", "respectively", ",", "and", "p", "\u03d5", "(", "X", "|", "C", ")", "and", "q", "\u03b8", "(", "C", "|", "X", ")", "are", "the", "likelihood", "function", "and", "posterior", "distribution", ",", "respectively", ".", "The", "loss", "function", "of", "the", "ProfileVAE", "can", "be", "formulated", "as", "follows", ":", "L", "G", "(", "\u03b8", ",", "\u03d5", ",", "X", ",", "C", ",", "\u03b2", ")", "=", "E", "q", "\u03b8", "(", "C", "|", "X", ")", "[", "log", "p", "\u03d5", "(", "X", "|", "C", ")", "]", "(", "2", ")", "-", "\u03b2", "\u2022", "D", "KL", "(", "q", "\u03b8", "(", "C", "|", "X", ")", "|", "|", "p", "\u03d5", "(", "C", ")", ")", ",", "where", "\u03b2", "denotes", "the", "weight", "of", "the", "KL", "divergence", "D", "KL", "(", "Joyce", "2011", ")", ".", "MolVAE", ".", "Then", ",", "EQUATION", ")", "Note", "that", "the", "feature", "vectors", "C", "of", "the", "extracted", "gene", "expression", "profiles", "are", "used", "as", "the", "conditions", "for", "MolVAE", ".", "MolVAE", "aims", "to", "maximize", "the", "lower", "bound", "of", "the", "true", "logmarginal", "likelihood", "as", "follows", ":", "EQUATION", "-", "D", "KL", "(", "q", "\u03c8", "(", "Z", "|", "S", ")", "|", "|", "p", "\u03c6", "(", "Z", ")", ")", ".", "Three", "types", "of", "gene", "expression", "profiles", "were", "used", "to", "validate", "the", "effectiveness", "of", "the", "proposed", "GxVAEs", ".", "\u2022", "Chemically", "induced", "profiles", "were", "collected", "from", "the", "LINCS", "L1000", "database", "(", "Duan", "et", "al", ".", "2014", ")", ".", "Here", ",", "gene", "expression", "profiles", "of", "MCF7", "cell", "line", "treated", "with", "13", ",", "755", "molecules", "were", "used", ".", "\u2022", "Target", "perturbation", "profiles", "were", "obtained", "from", "the", "LINCS", "database", ".", "For", "example", ",", "we", "analyzed", "RAC-\u03b1", "serine", "/", "threonine-protein", "kinase", "(", "AKT1", ")", ",", "RAC\u03b2", "serine", "/", "threonine-protein", "kinase", "(", "AKT2", ")", ",", "Aurora", "B", "kinase", "(", "AURKB", ")", ",", "cysteine", "synthase", "A", "(", "CTSK", ")", ",", "epidermal", "growth", "factor", "receptor", "(", "EGFR", ")", ",", "histone", "deacetylase", "1", "(", "HDAC1", ")", ",", "mammalian", "target", "of", "rapamycin", "(", "MTOR", ")", ",", "phosphatidylinositol", "3", "-", "kinase", "catalytic", "subunit", "(", "PIK3CA", ")", ",", "decapentaplegic", "homolog", "3", "(", "SMAD3", ")", ",", "and", "tumor", "protein", "p53", "(", "TP53", ")", ",", "which", "are", "therapeutic", "proteins", "for", "cancers", ".", "\u2022", "Disease-specific", "profiles", "were", "collected", "from", "the", "crowd", "extracted", "expression", "of", "differential", "signatures", "(", "CREEDS", ")", "database", "(", "Wang", "et", "al", ".", "2016", ")", ".", "Validity", "refers", "to", "the", "ratio", "of", "chemically", "valid", "molecules", "generated", ",", "which", "can", "be", "verified", "in", "practice", "using", "the", "RDKit", "tool", "(", "Landrum", "2013", ")", ".", "A", "quantitative", "estimate", "of", "drug-likeness", "(", "QED", ")", "quantifies", "the", "likelihood", "that", "a", "molecule", "is", "a", "drug", "(", "Appendix", "D", ")", ".", "To", "demonstrate", "that", "ProfileVAE", "has", "the", "ability", "to", "extract", "the", "biological", "features", "of", "gene", "expression", "profiles", ",", "we", "compared", "the", "distributions", "of", "the", "input", "gene", "expression", "profiles", "and", "the", "reconstructed", "profiles", ".", "The", "distributions", "of", "the", "reconstructed", "profiles", "approximate", "those", "of", "the", "corresponding", "validation", "data", ",", "which", "indicates", "that", "ProfileVAE", "extracted", "the", "features", "of", "the", "gene", "expression", "profiles", "well", ",", "and", "proved", "the", "effectiveness", "of", "the", "proposed", "GxVAEs", ".", "to", "those", "in", "the", "validation", "set", ".", "Furthermore", ",", "Table", "1", "lists", "the", "statistics", "for", "the", "validation", "set", "and", "molecules", "generated", "by", "the", "proposed", "GxVAEs", ".", "The", "average", ",", "maximum", ",", "minimum", "lengths", ",", "and", "the", "average", "molecular", "weight", "of", "the", "generated", "SMILES", "strings", "were", "basically", "consistent", "with", "the", "SMILES", "strings", "in", "the", "original", "validation", "set", ",", "indicating", "that", "GxVAEs", "learned", "the", "data", "distributions", "of", "the", "SMILES", "strings", "well", ".", "Table", "2", "shows", "the", "ability", "of", "the", "proposed", "Gx-VAEs", "to", "generate", "candidate", "molecules", ".", "Note", "that", "Expres-sionGAN", "has", "limited", "ability", "to", "generate", "valid", "molecules", ",", "thus", "we", "only", "compared", "GxVAEs", "to", "the", "TRIOMPHE", "baseline", ".", "The", "experimental", "results", "demonstrate", "that", "the", "validity", "of", "the", "proposed", "GxVAEs", "is", "three", "times", "higher", "than", "that", "of", "TRIOMPHE", "for", "generating", "ligand-like", "molecules", "using", "the", "gene", "expression", "profiles", "of", "the", "ten", "target", "proteins", ",", "reaching", "at", "least", "78.0%", "(", "HDAC1", ")", ".", "Moreover", ",", "the", "uniqueness", "of", "the", "GxVAEs", "exceeds", "that", "of", "TRIOMPHE", "except", "for", "PIK3CA", "(", "93.5%", "<", "97.2%", ")", ".", "Additionally", ",", "the", "novelty", "of", "the", "GxVAEs", "(", "97.7%", ")", "is", "close", "to", "that", "of", "TRIOMPHE", ".", "Overall", ",", "the", "proposed", "GxVAEs", "provided", "a", "sufficient", "number", "of", "candidate", "ligands", "for", "the", "ten", "target", "proteins", ".", "Table", "3", "compares", "the", "Tanimoto", "coefficients", "of", "GxVAEs", "with", "those", "of", "the", "two", "SOTA", "models", ".", "The", "experimental", "results", "illustrate", "that", "the", "Tanimoto", "coefficients", "of", "the", "candidate", "ligands", "generated", "by", "GxVAEs", "for", "the", "ten", "target", "proteins", "were", "much", "higher", "than", "those", "of", "the", "two", "SOTA", "models", ".", "For", "example", ",", "the", "Tanimoto", "coefficient", "of", "GxVAEs", "for", "AKT1", "was", "2.7", "and", "2.0", "times", "higher", "than", "those", "of", "the", "two", "baselines", ".", "The", "chemical", "structures", "of", "the", "hit-like", "molecules", "generated", "by", "GxVAEs", "are", "all", "similar", "to", "the", "structures", "of", "the", "known", "ligands", ".", "Overall", ",", "the", "proposed", "GxVAEs", "show", "excellent", "performance", "in", "generating", "hit-like", "molecules", "from", "the", "gene", "expression", "profiles", ",", "and", "the", "biological", "activity", "of", "the", "generated", "molecules", "far", "exceeded", "the", "SOTA", "baselines", ".", "Figure", "5", "shows", "the", "process", "undertaken", "by", "GxVAEs", "for", "therapeutic", "molecular", "generation", ".", "Finally", ",", "the", "disease", "reversal", "profiles", "were", "input", "into", "GxVAEs", "to", "generate", "candidate", "therapeutic", "molecules", ".", "We", "compared", "the", "results", "generated", "by", "GxVAEs", "with", "those", "generated", "by", "DRAGONET", "(", "Yamanaka", "et", "al", ".", "2023", ")", ".", "For", "a", "fair", "comparison", ",", "we", "used", "the", "same", "datasets", "on", "patient", "gene", "expression", "profiles", "and", "molecule", "chemical", "structures", "in", "DRAGONET", ".", "Figure", "6", "shows", "the", "therapeutic", "molecules", "generated", "by", "DRAGONET", "and", "GxVAEs", ",", "as", "well", "as", "the", "Tanimoto", "coefficients", "calculated", "relative", "to", "known", "approved", "drugs", ".", "The", "Tanimoto", "coefficients", "between", "hydrocortisone", "and", "the", "molecules", "generated", "by", "GxVAEs", "using", "the", "disease", "reversal", "profile", "of", "patients", "having", "atopic", "dermatitis", "reached", "1.0", ".", "This", "result", "indicates", "that", "GxVAEs", "effectively", "captured", "the", "structural", "features", "of", "the", "drugs", "approved", "for", "the", "treatment", "of", "atopic", "dermatitis", ".", "Furthermore", ",", "the", "molecules", "generated", "by", "GxVAEs", "for", "treating", "gastric", "cancer", "and", "Alzheimer's", "disease", "showed", "structural", "features", "that", "were", "similar", "to", "those", "of", "known", "approved", "drugs", ".", "Thus", ",", "the", "proposed", "GxVAEs", "can", "generate", "molecules", "that", "have", "higher", "therapeutic", "properties", "than", "DRAGONET", ".", "We", "proposed", "GxVAEs", ",", "which", "consisted", "of", "two", "joint", "VAEs", "(", "i.e", ".", ",", "ProfileVAE", "and", "MolVAE", ")", ",", "to", "generate", "hit-like", "molecules", "from", "gene", "expression", "profiles", ".", "ProfileVAE", "extracted", "the", "features", "of", "the", "gene", "expression", "profiles", ",", "which", "were", "then", "used", "as", "conditions", "to", "guide", "MolVAE", "in", "producing", "hit-like", "molecules", ".", "The", "experimental", "results", "showed", "that", "GxVAEs", "outperformed", "the", "current", "SOTA", "baselines", "and", "efficiently", "generated", "hit-like", "molecules", "from", "gene", "expression", "profiles", ".", "Furthermore", ",", "we", "showed", "the", "capability", "of", "GxVAEs", "to", "create", "molecular", "structures", "with", "the", "potential", "therapeutic", "effects", "for", "various", "diseases", "from", "patients", "'", "disease", "profiles", ".", "One", "limitation", "of", "GxVAEs", "is", "that", "the", "diversity", "may", "be", "influenced", "by", "the", "size", "of", "the", "latent", "space", ".", "If", "an", "implementation", "of", "MolVAE", "adopts", "a", "fixed", "latent", "vector", ",", "it", "could", "potentially", "constrain", "the", "diversity", "of", "newly", "generated", "molecules", "."], "sentences": [["GxVAEs", ":", "Two", "Joint", "VAEs", "Generate", "Hit", "Molecules", "from", "Gene", "Expression", "Profiles", "."], ["The", "de", "novo", "generation", "of", "hit-like", "molecules", "that", "show", "bioactivity", "and", "drug-likeness", "is", "an", "important", "task", "in", "computer-aided", "drug", "discovery", "."], ["Although", "artificial", "intelligence", "can", "generate", "molecules", "with", "desired", "chemical", "properties", ",", "most", "previous", "studies", "have", "ignored", "the", "influence", "of", "disease-related", "cellular", "environments", "."], ["This", "study", "proposes", "a", "novel", "deep", "generative", "model", "called", "GxVAEs", "to", "generate", "hit-like", "molecules", "from", "gene", "expression", "profiles", "by", "leveraging", "two", "joint", "variational", "autoencoders", "(", "VAEs", ")", "."], ["The", "first", "VAE", ",", "ProfileVAE", ",", "extracts", "latent", "features", "from", "gene", "expression", "profiles", "."], ["The", "extracted", "features", "serve", "as", "the", "conditions", "that", "guide", "the", "second", "VAE", ",", "which", "is", "called", "MolVAE", ",", "in", "generating", "hit-like", "molecules", "."], ["GxVAEs", "bridge", "the", "gap", "between", "molecular", "generation", "and", "the", "cellular", "environment", "in", "a", "biological", "system", ",", "and", "produce", "molecules", "that", "are", "biologically", "meaningful", "in", "the", "context", "of", "specific", "diseases", "."], ["Experiments", "and", "case", "studies", "on", "the", "generation", "of", "therapeutic", "molecules", "show", "that", "GxVAEs", "outperforms", "current", "state-of-the-art", "baselines", "and", "yield", "hit-like", "molecules", "with", "potential", "bioactivity", "and", "drug-like", "properties", "."], ["Hit", "identification", ",", "which", "involves", "discovering", "hit", "molecules", "with", "the", "desired", "bioactivity", "and", "therapeutic", "effects", "within", "an", "infinite", "chemical", "space", ",", "is", "a", "critical", "challenge", "in", "drug", "discovery", "(", "Dobson", "et", "al", ".", "2004", ")", "."], ["Traditionally", ",", "hit", "identification", "campaigns", "have", "been", "conducted", "using", "experimental", "approaches", "such", "as", "high-throughput", "screening", "(", "HTS", ")", "(", "Hertzberg", "and", "Pope", "2000", ")", "."], ["HTS", "provides", "a", "valuable", "methodology", "for", "identifying", "hits", "with", "desired", "bioactivity", "(", "Scannell", "et", "al", ".", "2022", ")", "."], ["However", ",", "the", "hit", "rate", "observed", "in", "HTS", "campaigns", "tends", "to", "be", "relatively", "low", ",", "which", "results", "in", "many", "molecules", "that", "are", "inactive", "or", "that", "hold", "less", "promise", "being", "screened", "out", "(", "Rahman", "et", "al", ".", "2022", ")", "."], ["Additionally", ",", "experimental", "approaches", "to", "drug", "discovery", "typically", "rely", "on", "laborintensive", "and", "time-consuming", "processes", "."], ["De", "novo", "molecular", "generation", "using", "artificial", "intelligence", "(", "AI", ")", "techniques", "has", "emerged", "as", "a", "promising", "approach", "for", "computer-aided", "drug", "discovery", "."], ["The", "power", "of", "deep", "learning", "and", "computational", "chemistry", "enables", "the", "generation", "of", "new", "molecules", "with", "desired", "bioactivity", "for", "specific", "therapeutic", "targets", "."], ["Deep", "generative", "models", ",", "such", "as", "generative", "adversarial", "networks", "(", "GANs", ")", "(", "Guimaraes", "et", "al", ".", "2017", ";", "De", "Cao", "and", "Kipf", "2018", ";", "Li", "et", "al", ".", "2022", ")", "and", "variational", "autoencoders", "(", "VAEs", ")", "(", "Oliveira", ",", "Da", "Silva", ",", "and", "Quiles", "2022", ";", "Dollar", "et", "al", ".", "2021", ";", "Kusner", ",", "Paige", ",", "and", "Hern\u00e1ndez-Lobato", "2017", ";", "Jin", ",", "Barzilay", ",", "and", "Jaakkola", "2018", ")", "accelerate", "the", "drug", "discovery", "process", "by", "employing", "computational", "models", "to", "generate", "molecules", "having", "a", "specific", "bioactivity", "."], ["By", "capturing", "the", "essential", "features", "of", "molecules", ",", "deep", "generative", "models", "can", "produce", "new", "molecules", "with", "similar", "structures", "and", "related", "properties", "."], ["Most", "AI-driven", "molecular", "generation", "models", "focus", "on", "the", "generation", "of", "new", "molecules", "with", "improved", "chemical", "properties", "of", "interest", "."], ["While", "omics-based", "approaches", "to", "drug", "discovery", "offer", "promising", "opportunities", ",", "it", "is", "essential", "to", "understand", "their", "limitations", "(", "Kang", ",", "Ko", ",", "and", "Mersha", "2022", ")", "."], ["Interpretation", "of", "omics", "data", "in", "the", "context", "of", "drug", "discovery", "also", "requires", "a", "deep", "understanding", "of", "the", "underlying", "biological", "and", "disease", "mechanisms", "."], ["In", "this", "study", ",", "we", "proposed", "GxVAEs", "to", "generate", "hit-like", "molecules", "from", "gene", "expression", "profiles", "using", "two", "joint", "VAEs", "(", "i.e", ".", ",", "ProfileVAE", "and", "MolVAE", ")", "."], ["First", ",", "ProfileVAE", "functions", "as", "a", "feature", "extractor", "to", "extract", "latent", "features", "from", "gene", "expression", "profiles", "."], ["The", "extracted", "features", "are", "then", "used", "as", "conditions", "to", "guide", "MolVAE", "in", "generating", "hit-like", "molecules", "."], ["GxVAEs", "bridges", "the", "gap", "between", "molecular", "generation", "and", "the", "cellular", "environment", "of", "a", "biological", "system", ",", "making", "the", "produced", "molecules", "more", "biologically", "meaningful", "in", "the", "context", "of", "specific", "diseases", "."], ["The", "main", "contributions", "of", "this", "study", "are", "summarized", "as", "follows", ":", "\u2022", "Hit-like", "molecular", "generation", "that", "considered", "the", "cellular", "environment", ":", "This", "study", "considers", "the", "influence", "of", "the", "cellular", "environment", "on", "specific", "diseases", "during", "the", "molecular", "generation", "process", ".", "\u2022", "A", "simple", "but", "effective", "model", "architecture", ":", "The", "combination", "of", "two", "VAEs", "successfully", "generated", "hit-like", "molecules", "from", "gene", "expression", "profiles", ".", "\u2022", "Superior", "performance", "over", "state-of-the-art", "(", "SOTA", ")", "models", ":", "Experiments", "and", "case", "studies", "demonstrate", "that", "the", "proposed", "GxVAEs", "outperform", "the", "current", "SOTA", "models", "for", "the", "same", "objectives", "."], ["De", "novo", "molecular", "generation", "aims", "to", "produce", "new", "molecules", "with", "specific", "chemical", "properties", "."], ["Generally", ",", "the", "data", "structures", "used", "for", "de", "novo", "molecular", "generation", "are", "molecular", "graphs", "(", "Manolopoulos", "and", "Fowler", "1992", ")", "and", "simplified", "molecular", "input", "line", "entry", "system", "(", "SMILES", ")", "strings", "(", "Weininger", "1988", ")", "."], ["TransVAE", "(", "Dollar", "et", "al", ".", "2021", ")", "and", "Gram-marVAE", "(", "Kusner", ",", "Paige", ",", "and", "Hern\u00e1ndez-Lobato", "2017", ")", "are", "two", "deep", "generative", "models", "that", "produce", "molecules", "from", "SMILES", "strings", "using", "VAEs", "."], ["JTVAE", "(", "Jin", ",", "Barzilay", ",", "and", "Jaakkola", "2018", ")", "uses", "a", "node", "tree", "to", "generate", "molecules", "from", "a", "molecular", "graph", "."], ["It", "first", "creates", "a", "tree-structured", "scaffold", "on", "a", "substructure", "and", "then", "combines", "the", "tree-structured", "scaffold", "into", "a", "molecule", "using", "a", "graphical", "message-passing", "network", "(", "Dai", ",", "Dai", ",", "and", "Song", "2016", ")", "."], ["MolGAN", "(", "De", "Cao", "and", "Kipf", "2018", ")", "and", "TransORGAN", "(", "Li", "et", "al", ".", "2022", ")", "are", "discrete", "GANs", "that", "use", "reinforcement", "learning", "to", "generate", "molecular", "graphs", "and", "SMILES", "strings", ",", "respectively", "."], ["With", "the", "development", "of", "omics", "data", "analysis", ",", "especially", "gene", "expression", "profiles", "used", "in", "drug", "discovery", "(", "Turanli", "et", "al", ".", "2018", ";", "Chen", "et", "al", ".", "2020", ")", ",", "chemists", "have", "begun", "to", "use", "comprehensive", "biological", "response", "information", "to", "generate", "therapeutic", "molecules", "for", "the", "treatment", "of", "specific", "diseases", "."], ["ExpressionGAN", "(", "M\u00e9ndez-Lucio", "et", "al", ".", "2020", ")", "and", "TRI-OMPHE", "(", "Kaitoh", "and", "Yamanishi", "2021", ")", "are", "the", "SOTA", "deep", "generative", "models", "that", "are", "most", "relevant", "to", "our", "study", "on", "generating", "hit-like", "molecules", "for", "target", "proteins", "with", "no", "prior", "annotation", "of", "the", "target", "training", "molecules", "."], ["Expres-sionGAN", "is", "a", "GAN", "model", "that", "bridges", "systems", "biology", "and", "molecular", "design", "to", "produce", "molecules", "with", "a", "high", "probability", "of", "inducing", "the", "desired", "transcriptome", "features", "automatically", "from", "gene", "expression", "profiles", "."], ["TRIOMPHE", "first", "calculates", "the", "correlation", "of", "ligand-target", "interactions", "between", "the", "chemically", "induced", "transcriptome", "profiles", "of", "cellular", "responses", "to", "molecular", "treatment", "and", "the", "transcriptome", "profiles", "of", "gene", "perturbations", "that", "reflect", "cellular", "responses", "to", "gene", "knockdown", "or", "gene", "overexpression", "of", "target", "proteins", "."], ["Next", ",", "a", "VAE", "was", "employed", "to", "generate", "a", "new", "molecule", "with", "the", "desired", "transcriptome", "profile", "."], ["However", ",", "ExpressionGAN", "generates", "hit-like", "molecules", "with", "low", "validity", "(", ">", "8.5%", ")", ",", "and", "its", "ability", "to", "reproduce", "known", "ligands", "is", "limited", "."], ["Additionally", ",", "TRIOMPHE", "only", "utilizes", "gene", "expression", "profiles", "in", "correlation", "calculations", ",", "whose", "VAE", "is", "not", "involved", "in", "molecular", "generation", "."], ["To", "address", "these", "issues", ",", "GxVAEs", "were", "proposed", "in", "this", "study", "."], ["By", "bridging", "the", "gap", "between", "the", "cellular", "environment", "and", "the", "generation", "of", "ther", "-", "The", "Thirty-Eighth", "AAAI", "Conference", "on", "Artificial", "Intelligence", "(", "AAAI", "-", "24", ")", "apeutic", "molecules", ",", "GxVAEs", "generate", "molecules", "that", "are", "biologically", "meaningful", "in", "the", "context", "of", "specific", "diseases", "using", "gene", "expression", "profiles", "."], ["Figure", "1", "shows", "an", "overview", "of", "the", "GxVAEs", "."], ["GxVAEs", "mainly", "consists", "of", "two", "joint", "VAEs", ",", "namely", "ProfileVAE", "and", "MolVAE", "."], ["ProfileVAE", "acts", "as", "a", "feature", "extractor", "to", "extract", "low-dimensional", "feature", "vectors", "from", "high-dimensional", "gene", "expression", "profiles", "."], ["MolVAE", "consists", "of", "bidirectional", "GRUs", "that", "are", "conditioned", "on", "the", "features", "of", "gene", "expression", "profiles", "using", "non-canonical", "SMILES", "(", "i.e", ".", ",", "variant", "SMILES", "(", "Li", "and", "Yamanishi", "2023", ")", ")", "strings", "to", "generate", "hitlike", "molecules", "."], ["Note", "that", "teacher", "forcing", "(", "Yan", "et", "al", ".", "2023", ")", "is", "used", "to", "stabilize", "the", "training", "and", "accelerate", "the", "convergence", "of", "the", "GxVAEs", "during", "the", "training", "phase", "of", "the", "MolVAE", "."], ["ProfileVAE", "."], ["The", "goal", "of", "Profil-eVAE", "is", "to", "learn", "the", "marginal", "likelihood", "of", "gene", "expression", "profiles", "during", "the", "following", "generative", "process", ":", "max", "EQUATION", "where", "E", "[", "\u2022", "]", "is", "an", "expectation", "operation", ",", "C", "is", "the", "latent", "variable", ",", "\u03b8", "and", "\u03d5", "denote", "the", "parameters", "of", "the", "ProfileVAE", "encoder", "and", "ProfileVAE", "decoder", ",", "respectively", ",", "and", "p", "\u03d5", "(", "X", "|", "C", ")", "and", "q", "\u03b8", "(", "C", "|", "X", ")", "are", "the", "likelihood", "function", "and", "posterior", "distribution", ",", "respectively", "."], ["The", "loss", "function", "of", "the", "ProfileVAE", "can", "be", "formulated", "as", "follows", ":", "L", "G", "(", "\u03b8", ",", "\u03d5", ",", "X", ",", "C", ",", "\u03b2", ")", "=", "E", "q", "\u03b8", "(", "C", "|", "X", ")", "[", "log", "p", "\u03d5", "(", "X", "|", "C", ")", "]", "(", "2", ")", "-", "\u03b2", "\u2022", "D", "KL", "(", "q", "\u03b8", "(", "C", "|", "X", ")", "|", "|", "p", "\u03d5", "(", "C", ")", ")", ",", "where", "\u03b2", "denotes", "the", "weight", "of", "the", "KL", "divergence", "D", "KL", "(", "Joyce", "2011", ")", "."], ["MolVAE", "."], ["Then", ",", "EQUATION", ")", "Note", "that", "the", "feature", "vectors", "C", "of", "the", "extracted", "gene", "expression", "profiles", "are", "used", "as", "the", "conditions", "for", "MolVAE", "."], ["MolVAE", "aims", "to", "maximize", "the", "lower", "bound", "of", "the", "true", "logmarginal", "likelihood", "as", "follows", ":", "EQUATION", "-", "D", "KL", "(", "q", "\u03c8", "(", "Z", "|", "S", ")", "|", "|", "p", "\u03c6", "(", "Z", ")", ")", "."], ["Three", "types", "of", "gene", "expression", "profiles", "were", "used", "to", "validate", "the", "effectiveness", "of", "the", "proposed", "GxVAEs", ".", "\u2022", "Chemically", "induced", "profiles", "were", "collected", "from", "the", "LINCS", "L1000", "database", "(", "Duan", "et", "al", ".", "2014", ")", "."], ["Here", ",", "gene", "expression", "profiles", "of", "MCF7", "cell", "line", "treated", "with", "13", ",", "755", "molecules", "were", "used", ".", "\u2022", "Target", "perturbation", "profiles", "were", "obtained", "from", "the", "LINCS", "database", "."], ["For", "example", ",", "we", "analyzed", "RAC-\u03b1", "serine", "/", "threonine-protein", "kinase", "(", "AKT1", ")", ",", "RAC\u03b2", "serine", "/", "threonine-protein", "kinase", "(", "AKT2", ")", ",", "Aurora", "B", "kinase", "(", "AURKB", ")", ",", "cysteine", "synthase", "A", "(", "CTSK", ")", ",", "epidermal", "growth", "factor", "receptor", "(", "EGFR", ")", ",", "histone", "deacetylase", "1", "(", "HDAC1", ")", ",", "mammalian", "target", "of", "rapamycin", "(", "MTOR", ")", ",", "phosphatidylinositol", "3", "-", "kinase", "catalytic", "subunit", "(", "PIK3CA", ")", ",", "decapentaplegic", "homolog", "3", "(", "SMAD3", ")", ",", "and", "tumor", "protein", "p53", "(", "TP53", ")", ",", "which", "are", "therapeutic", "proteins", "for", "cancers", ".", "\u2022", "Disease-specific", "profiles", "were", "collected", "from", "the", "crowd", "extracted", "expression", "of", "differential", "signatures", "(", "CREEDS", ")", "database", "(", "Wang", "et", "al", ".", "2016", ")", "."], ["Validity", "refers", "to", "the", "ratio", "of", "chemically", "valid", "molecules", "generated", ",", "which", "can", "be", "verified", "in", "practice", "using", "the", "RDKit", "tool", "(", "Landrum", "2013", ")", "."], ["A", "quantitative", "estimate", "of", "drug-likeness", "(", "QED", ")", "quantifies", "the", "likelihood", "that", "a", "molecule", "is", "a", "drug", "(", "Appendix", "D", ")", "."], ["To", "demonstrate", "that", "ProfileVAE", "has", "the", "ability", "to", "extract", "the", "biological", "features", "of", "gene", "expression", "profiles", ",", "we", "compared", "the", "distributions", "of", "the", "input", "gene", "expression", "profiles", "and", "the", "reconstructed", "profiles", "."], ["The", "distributions", "of", "the", "reconstructed", "profiles", "approximate", "those", "of", "the", "corresponding", "validation", "data", ",", "which", "indicates", "that", "ProfileVAE", "extracted", "the", "features", "of", "the", "gene", "expression", "profiles", "well", ",", "and", "proved", "the", "effectiveness", "of", "the", "proposed", "GxVAEs", ".", "to", "those", "in", "the", "validation", "set", "."], ["Furthermore", ",", "Table", "1", "lists", "the", "statistics", "for", "the", "validation", "set", "and", "molecules", "generated", "by", "the", "proposed", "GxVAEs", "."], ["The", "average", ",", "maximum", ",", "minimum", "lengths", ",", "and", "the", "average", "molecular", "weight", "of", "the", "generated", "SMILES", "strings", "were", "basically", "consistent", "with", "the", "SMILES", "strings", "in", "the", "original", "validation", "set", ",", "indicating", "that", "GxVAEs", "learned", "the", "data", "distributions", "of", "the", "SMILES", "strings", "well", "."], ["Table", "2", "shows", "the", "ability", "of", "the", "proposed", "Gx-VAEs", "to", "generate", "candidate", "molecules", "."], ["Note", "that", "Expres-sionGAN", "has", "limited", "ability", "to", "generate", "valid", "molecules", ",", "thus", "we", "only", "compared", "GxVAEs", "to", "the", "TRIOMPHE", "baseline", "."], ["The", "experimental", "results", "demonstrate", "that", "the", "validity", "of", "the", "proposed", "GxVAEs", "is", "three", "times", "higher", "than", "that", "of", "TRIOMPHE", "for", "generating", "ligand-like", "molecules", "using", "the", "gene", "expression", "profiles", "of", "the", "ten", "target", "proteins", ",", "reaching", "at", "least", "78.0%", "(", "HDAC1", ")", "."], ["Moreover", ",", "the", "uniqueness", "of", "the", "GxVAEs", "exceeds", "that", "of", "TRIOMPHE", "except", "for", "PIK3CA", "(", "93.5%", "<", "97.2%", ")", "."], ["Additionally", ",", "the", "novelty", "of", "the", "GxVAEs", "(", "97.7%", ")", "is", "close", "to", "that", "of", "TRIOMPHE", "."], ["Overall", ",", "the", "proposed", "GxVAEs", "provided", "a", "sufficient", "number", "of", "candidate", "ligands", "for", "the", "ten", "target", "proteins", "."], ["Table", "3", "compares", "the", "Tanimoto", "coefficients", "of", "GxVAEs", "with", "those", "of", "the", "two", "SOTA", "models", "."], ["The", "experimental", "results", "illustrate", "that", "the", "Tanimoto", "coefficients", "of", "the", "candidate", "ligands", "generated", "by", "GxVAEs", "for", "the", "ten", "target", "proteins", "were", "much", "higher", "than", "those", "of", "the", "two", "SOTA", "models", "."], ["For", "example", ",", "the", "Tanimoto", "coefficient", "of", "GxVAEs", "for", "AKT1", "was", "2.7", "and", "2.0", "times", "higher", "than", "those", "of", "the", "two", "baselines", "."], ["The", "chemical", "structures", "of", "the", "hit-like", "molecules", "generated", "by", "GxVAEs", "are", "all", "similar", "to", "the", "structures", "of", "the", "known", "ligands", "."], ["Overall", ",", "the", "proposed", "GxVAEs", "show", "excellent", "performance", "in", "generating", "hit-like", "molecules", "from", "the", "gene", "expression", "profiles", ",", "and", "the", "biological", "activity", "of", "the", "generated", "molecules", "far", "exceeded", "the", "SOTA", "baselines", "."], ["Figure", "5", "shows", "the", "process", "undertaken", "by", "GxVAEs", "for", "therapeutic", "molecular", "generation", "."], ["Finally", ",", "the", "disease", "reversal", "profiles", "were", "input", "into", "GxVAEs", "to", "generate", "candidate", "therapeutic", "molecules", "."], ["We", "compared", "the", "results", "generated", "by", "GxVAEs", "with", "those", "generated", "by", "DRAGONET", "(", "Yamanaka", "et", "al", ".", "2023", ")", "."], ["For", "a", "fair", "comparison", ",", "we", "used", "the", "same", "datasets", "on", "patient", "gene", "expression", "profiles", "and", "molecule", "chemical", "structures", "in", "DRAGONET", "."], ["Figure", "6", "shows", "the", "therapeutic", "molecules", "generated", "by", "DRAGONET", "and", "GxVAEs", ",", "as", "well", "as", "the", "Tanimoto", "coefficients", "calculated", "relative", "to", "known", "approved", "drugs", "."], ["The", "Tanimoto", "coefficients", "between", "hydrocortisone", "and", "the", "molecules", "generated", "by", "GxVAEs", "using", "the", "disease", "reversal", "profile", "of", "patients", "having", "atopic", "dermatitis", "reached", "1.0", "."], ["This", "result", "indicates", "that", "GxVAEs", "effectively", "captured", "the", "structural", "features", "of", "the", "drugs", "approved", "for", "the", "treatment", "of", "atopic", "dermatitis", "."], ["Furthermore", ",", "the", "molecules", "generated", "by", "GxVAEs", "for", "treating", "gastric", "cancer", "and", "Alzheimer's", "disease", "showed", "structural", "features", "that", "were", "similar", "to", "those", "of", "known", "approved", "drugs", "."], ["Thus", ",", "the", "proposed", "GxVAEs", "can", "generate", "molecules", "that", "have", "higher", "therapeutic", "properties", "than", "DRAGONET", "."], ["We", "proposed", "GxVAEs", ",", "which", "consisted", "of", "two", "joint", "VAEs", "(", "i.e", ".", ",", "ProfileVAE", "and", "MolVAE", ")", ",", "to", "generate", "hit-like", "molecules", "from", "gene", "expression", "profiles", "."], ["ProfileVAE", "extracted", "the", "features", "of", "the", "gene", "expression", "profiles", ",", "which", "were", "then", "used", "as", "conditions", "to", "guide", "MolVAE", "in", "producing", "hit-like", "molecules", "."], ["The", "experimental", "results", "showed", "that", "GxVAEs", "outperformed", "the", "current", "SOTA", "baselines", "and", "efficiently", "generated", "hit-like", "molecules", "from", "gene", "expression", "profiles", "."], ["Furthermore", ",", "we", "showed", "the", "capability", "of", "GxVAEs", "to", "create", "molecular", "structures", "with", "the", "potential", "therapeutic", "effects", "for", "various", "diseases", "from", "patients", "'", "disease", "profiles", "."], ["One", "limitation", "of", "GxVAEs", "is", "that", "the", "diversity", "may", "be", "influenced", "by", "the", "size", "of", "the", "latent", "space", "."], ["If", "an", "implementation", "of", "MolVAE", "adopts", "a", "fixed", "latent", "vector", ",", "it", "could", "potentially", "constrain", "the", "diversity", "of", "newly", "generated", "molecules", "."]], "ner": [[[0, 0, "Method"], [4, 4, "Method"]], [[14, 16, "Task"], [30, 32, "Task"]], [[35, 36, "Method"]], [[62, 64, "Method"], [66, 66, "Method"], [79, 80, "Method"], [82, 82, "Method"]], [[87, 87, "Method"], [89, 89, "Method"]], [[110, 110, "Method"], [115, 115, "Method"]], [[122, 122, "Method"], [127, 128, "Task"]], [[164, 164, "Method"]], [[180, 181, "Task"], [206, 207, "Task"]], [[218, 219, "Task"], [229, 230, "Method"], [232, 232, "Method"]], [[241, 241, "Method"]], [[267, 267, "Method"]], [[304, 305, "Task"]], [[315, 317, "Task"], [319, 320, "Method"], [322, 322, "Method"], [332, 334, "Task"]], [[339, 340, "Method"], [342, 343, "Method"]], [[358, 360, "Method"], [364, 366, "Method"], [368, 368, "Method"], [390, 391, "Method"], [393, 393, "Method"], [429, 430, "Task"]], [[452, 454, "Method"]], [[467, 470, "Method"]], [[486, 487, "Method"], [489, 490, "Task"]], [[520, 521, "Task"]], [[541, 541, "Method"], [553, 553, "Method"], [558, 558, "Method"], [560, 560, "Method"]], [[565, 565, "Method"], [569, 570, "Method"]], [[590, 590, "Method"]], [[596, 596, "Method"], [601, 602, "Task"]], [[638, 640, "Task"], [661, 662, "Task"], [677, 677, "Method"], [705, 705, "Method"]], [[716, 719, "Task"]], [[737, 740, "Task"]], [[766, 766, "Method"], [775, 775, "Method"], [787, 789, "Method"], [797, 797, "Method"]], [[799, 799, "Method"]], [[841, 843, "Method"]], [[854, 854, "Method"], [863, 863, "Method"], [872, 873, "Method"], [876, 877, "Method"]], [[902, 903, "Task"]], [[938, 938, "Method"], [947, 947, "Method"], [957, 959, "Method"]], [[984, 984, "Method"], [987, 987, "Method"]], [[1015, 1015, "Method"]], [[1059, 1059, "Method"]], [[1075, 1075, "Method"]], [[1099, 1099, "Method"], [1110, 1110, "Method"]], [[1123, 1123, "Method"]], [[1159, 1159, "Method"]], [[1184, 1184, "Method"]], [[1186, 1186, "Method"], [1192, 1192, "Method"], [1195, 1195, "Method"], [1197, 1197, "Method"]], [[1199, 1199, "Method"]], [[1216, 1216, "Method"], [1219, 1220, "Method"]], [[1276, 1276, "Method"], [1283, 1283, "Method"]], [[1285, 1285, "Method"]], [[1290, 1290, "Method"], [1333, 1334, "Method"], [1336, 1337, "Method"], [1359, 1360, "Method"], [1362, 1363, "Method"]], [[1372, 1372, "Method"], [1443, 1444, "Method"]], [[1452, 1452, "Method"]], [[1476, 1476, "Method"]], [[1478, 1478, "Method"]], [[1529, 1529, "Method"], [1539, 1540, "Dataset"]], [[1576, 1576, "Dataset"]], [[1678, 1683, "Dataset"], [1685, 1685, "Dataset"]], [[1715, 1716, "Method"]], [[1723, 1726, "Method"], [1728, 1728, "Method"]], [[1747, 1747, "Method"]], [[1793, 1793, "Method"], [1811, 1811, "Method"]], [[1837, 1837, "Method"]], [[1872, 1872, "Method"]], [[1891, 1891, "Method"]], [[1899, 1899, "Method"], [1912, 1912, "Method"], [1915, 1915, "Method"]], [[1928, 1928, "Method"], [1936, 1936, "Method"]], [[1966, 1966, "Method"], [1970, 1970, "Method"]], [[1986, 1986, "Method"], [1995, 1995, "Method"]], [[2001, 2001, "Method"]], [[2022, 2022, "Method"]], [[2045, 2045, "Method"]], [[2069, 2069, "Method"]], [[2094, 2094, "Method"]], [[2110, 2110, "Method"]], [[2145, 2145, "Method"], [2147, 2149, "Task"]], [[2160, 2160, "Method"]], [[2173, 2173, "Method"], [2178, 2178, "Method"]], [[2207, 2207, "Method"]], [[2217, 2217, "Method"], [2219, 2219, "Method"]], [[2244, 2244, "Method"]], [[2262, 2262, "Method"]], [[2285, 2285, "Method"]], [[2310, 2310, "Method"], [2320, 2320, "Method"]], [[2324, 2324, "Method"], [2331, 2331, "Method"], [2336, 2336, "Method"], [2338, 2338, "Method"]], [[2350, 2350, "Method"], [2368, 2368, "Method"]], [[2379, 2379, "Method"]], [[2402, 2402, "Method"]], [[2424, 2424, "Method"]], [[2444, 2444, "Method"]]], "relations": [[[4, 4, 0, 0, "Part-Of"]], [[14, 16, 30, 32, "SubTask-Of"]], [], [[66, 66, 62, 64, "SubClass-Of"], [79, 80, 66, 66, "Part-Of"], [82, 82, 79, 80, "Synonym-Of"]], [[89, 89, 87, 87, "SubClass-Of"]], [[115, 115, 110, 110, "SubClass-Of"]], [[122, 122, 127, 128, "Used-For"]], [], [[180, 181, 206, 207, "SubTask-Of"]], [[229, 230, 218, 219, "Used-For"], [232, 232, 229, 230, "Synonym-Of"]], [], [], [], [[319, 320, 315, 317, "Used-For"], [322, 322, 319, 320, "Synonym-Of"], [319, 320, 332, 334, "Used-For"], [315, 317, 332, 334, "SubTask-Of"]], [], [[364, 366, 358, 360, "SubClass-Of"], [390, 391, 358, 360, "SubClass-Of"], [368, 368, 364, 366, "Synonym-Of"], [393, 393, 390, 391, "Synonym-Of"], [390, 391, 429, 430, "Used-For"], [364, 366, 429, 430, "Used-For"], [358, 360, 429, 430, "Used-For"]], [], [], [[486, 487, 489, 490, "Used-For"]], [], [[553, 553, 541, 541, "Part-Of"], [558, 558, 541, 541, "Part-Of"], [560, 560, 541, 541, "Part-Of"], [558, 558, 553, 553, "SubClass-Of"], [560, 560, 553, 553, "SubClass-Of"]], [[565, 565, 569, 570, "SubClass-Of"]], [], [[596, 596, 601, 602, "Used-For"]], [[677, 677, 638, 640, "Used-For"], [705, 705, 638, 640, "Used-For"], [677, 677, 661, 662, "Used-For"], [705, 705, 661, 662, "Used-For"]], [], [], [[797, 797, 766, 766, "Part-Of"], [797, 797, 775, 775, "Part-Of"], [775, 775, 787, 789, "SubClass-Of"], [766, 766, 787, 789, "SubClass-Of"]], [], [], [[876, 877, 854, 854, "Used-For"], [876, 877, 863, 863, "Used-For"], [863, 863, 872, 873, "SubClass-Of"], [854, 854, 872, 873, "SubClass-Of"]], [], [[947, 947, 957, 959, "SubClass-Of"], [938, 938, 957, 959, "SubClass-Of"]], [[984, 984, 987, 987, "SubClass-Of"]], [], [], [], [[1110, 1110, 1099, 1099, "Part-Of"]], [], [], [], [[1192, 1192, 1186, 1186, "Part-Of"], [1197, 1197, 1186, 1186, "Part-Of"], [1195, 1195, 1186, 1186, "Part-Of"], [1195, 1195, 1192, 1192, "SubClass-Of"], [1197, 1197, 1192, 1192, "SubClass-Of"]], [], [[1219, 1220, 1216, 1216, "Part-Of"]], [[1283, 1283, 1276, 1276, "Part-Of"]], [], [[1362, 1363, 1333, 1334, "Part-Of"], [1359, 1360, 1336, 1337, "Part-Of"]], [[1443, 1444, 1372, 1372, "Part-Of"]], [], [], [], [[1529, 1529, 1539, 1540, "Evaluated-With"]], [], [[1685, 1685, 1678, 1683, "Synonym-Of"]], [], [[1728, 1728, 1723, 1726, "Synonym-Of"]], [], [[1793, 1793, 1811, 1811, "Part-Of"]], [], [], [], [[1912, 1912, 1915, 1915, "Compare-With"]], [[1928, 1928, 1936, 1936, "Compare-With"]], [[1966, 1966, 1970, 1970, "Compare-With"]], [[1986, 1986, 1995, 1995, "Compare-With"]], [], [], [], [], [], [], [[2145, 2145, 2147, 2149, "Used-For"]], [], [[2173, 2173, 2178, 2178, "Compare-With"]], [], [[2217, 2217, 2219, 2219, "Compare-With"]], [], [], [], [[2310, 2310, 2320, 2320, "Compare-With"]], [[2331, 2331, 2324, 2324, "Part-Of"], [2336, 2336, 2324, 2324, "Part-Of"], [2338, 2338, 2324, 2324, "Part-Of"], [2336, 2336, 2331, 2331, "SubClass-Of"], [2338, 2338, 2331, 2331, "SubClass-Of"]], [], [], [], [], []]}
{"doc_id": "NeurIPS2023-AI4Science", "doc_tokens": ["XLUMINA", ":", "An", "Auto-differentiating", "Discovery", "Framework", "for", "Super-Resolution", "Microscopy", "In", "this", "work", "we", "introduce", "XLUMINA", ",", "an", "original", "computational", "framework", "designed", "for", "the", "discovery", "of", "novel", "optical", "hardware", "in", "super-resolution", "microscopy", ".", "Our", "framework", "offers", "auto-differentiation", "capabilities", ",", "allowing", "for", "the", "fast", "and", "efficient", "simulation", "and", "automated", "design", "of", "entirely", "new", "optical", "setups", "from", "scratch", ".", "We", "showcase", "its", "potential", "by", "rediscovering", "three", "foundational", "experiments", ",", "each", "one", "covering", "different", "areas", "in", "optics", ":", "an", "optical", "telescope", ",", "STED", "microscopy", "and", "the", "focusing", "beyond", "the", "diffraction", "limit", "of", "a", "radially", "polarized", "light", "beam", ".", "With", "XLUMINA", ",", "can", "we", "go", "beyond", "simple", "optimization", "and", "calibration", "of", "known", "experimental", "setups", ",", "opening", "the", "door", "to", "potentially", "uncovering", "new", "microscopy", "concepts", "within", "the", "vast", "landscape", "of", "experimental", "possibilities", ".", "FINAL", "SET-UP", "AI-based", "exploration", "tool", "Objective", "function", "e.g", ".", "spot", "size", ",", "\u03d5", "=", "\u03c0", "FWHMxFWHMy", "4", "Enormously", "large", "search", "space", "OPTICS", "SIMULATOR", "FINAL", "SET-UP", "The", "space", "of", "all", "possible", "experimental", "optical", "configurations", "is", "enormous", ".", "This", "is", "where", "AI-based", "exploration", "techniques", "could", "provide", "enormous", "benefit", ",", "by", "exploring", "the", "space", "in", "a", "fast", ",", "unbiased", "way", "[", "1", ",", "2", "]", ".", "Among", "them", ",", "the", "discovery", "of", "super-resolution", "(", "SR", ")", "methods", ",", "which", "circumvent", "the", "classical", "diffraction", "limit", "of", "light", ",", "stand", "out", "in", "particular", ".", "Examples", "for", "versatile", "and", "powerful", "SR", "techniques", "are", "STED", "[", "10", "]", ",", "PALM", "/", "F-PALM", "[", "11", ",", "12", "]", ",", "(", "d", ")", "STORM", "[", "13", ",", "14", "]", ",", "SIM", "[", "15", "]", ",", "and", "MINFLUX", "[", "16", "]", ",", "with", "considerable", "impact", "in", "biology", "[", "17", "]", "[", "18", "]", "[", "19", "]", ",", "chemistry", "[", "20", "]", "and", "material", "sciences", "[", "21", "]", "for", "example", ".", "Rather", ",", "this", "work", "sets", "out", "to", "discover", "novel", ",", "experimentally", "viable", "concepts", "for", "advanced", "optical", "microscopy", "that", "are", "at-present", "entirely", "untapped", ".", "The", "simulator", "can", "either", "be", "called", "directly", "by", "gradient-based", "optimization", "techniques", ",", "or", "it", "can", "be", "used", "for", "generating", "the", "training", "data", "for", "deep-learning-based", "surrogate", "models", ".", "We", "introduce", "XLUMINA", ",", "an", "efficient", "framework", "with", "auto-differentiation", "capabilities", "[", "23", "]", "for", "the", "ultimate", "goal", "of", "discovering", "new", "optical", "design", "principles", ".", "We", "demonstrate", "our", "approach", "on", "three", "foundational", "optical", "layouts", ":", "a", "telescope", "version", ",", "the", "polarization-based", "beam", "shaping", "as", "used", "in", "STED", "(", "stimulated", "emission", "depletion", ")", "microscopy", "[", "10", "]", "and", "the", "sharp", "focus", "of", "a", "radially", "polarized", "light", "beam", "[", "24", "]", ".", "Rather", ",", "the", "future", "application", "of", "XLUMINA", "is", "the", "AI-driven", "discovery", "of", "completely", "novel", "physical", "concepts", "for", "advanced", "optical", "microscopy", ".", "Optimization", "in", "microscopy", "Our", "approach", "is", "radically", "different", "from", "previous", "strategies", "that", "employ", "AI", "for", "data-driven", "design", "of", "single", "optical", "elements", "[", "25", ",", "26", "]", "or", "data", "analysis", "in", "microscopy", ",", "e.g", ".", "denoising", ",", "contrast", "enhancement", "or", "point-spread-function", "(", "PSF", ")", "engineering", "[", "27", "]", ".", "In", "contrast", ",", "XLUMINA", "is", "equipped", "with", "tools", "for", "simulate", ",", "optimize", "and", "automatically", "design", "new", "optical", "setups", "and", "concepts", "from", "scratch", ".", "The", "main", "approach", "is", "the", "development", "of", "efficient", "PDE-solvers", "for", "Maxwell's", "equations", ",", "including", "efficient", "ways", "to", "compute", "the", "gradients", "of", "the", "vast", "amount", "of", "parameters", ",", "usually", "by", "a", "physics-inspired", "technique", "called", "the", "adjoint", "method", "[", "38", ",", "39", "]", ".", "Interestingly", ",", "the", "adjoint", "method", "can", "be", "seen", "as", "a", "special", "case", "of", "auto-differentiation", "(", "which", "we", "use", ")", "[", "39", "]", ".", "Several", "open-source", "software", "tools", ",", "like", "Diffractio", "for", "light", "diffraction", "and", "interference", "simulations", "[", "41", "]", ",", "Finesse", "for", "simulating", "gravitational", "wave", "detectors", "[", "42", "]", ",", "and", "POPPY", ",", "developed", "as", "a", "part", "of", "the", "simulation", "package", "of", "the", "James", "Webb", "Telescope", "[", "43", "]", ",", "facilitate", "classical", "optics", "phenomena", "simulations", ".", "There", "are", "also", "specialized", "resources", "like", "those", "focusing", "on", "the", "design", "of", "Laguerre-Gaussian", "mode", "sorters", "utilizing", "multi-plane", "light", "conversion", "(", "MPLC", ")", "methods", "[", "44", "]", ".", "While", "these", "software", "offer", "optics", "simulation", "capabilities", ",", "XLUMINA", "uniquely", "integrates", "simulation", "with", "AI-driven", "automated", "design", "powered", "with", "JAX's", "autodiff", "and", "just-in-time", "(", "jit", ")", "compilation", "capabilities", ".", "2", "Software", "workflow", "and", "performance", "XLUMINA", "allows", "for", "the", "simulation", "of", "classical", "optics", "hardware", "configurations", "and", "enables", "the", "optimization", "and", "automated", "discovery", "of", "new", "setup", "designs", ".", "The", "software", "is", "developed", "using", "JAX", "[", "45", "]", ",", "which", "provides", "an", "advantage", "of", "heightened", "computational", "speed", "while", "seamlessly", "integrating", "the", "auto-differentiation", "framework", "[", "23", "]", ".", "The", "first", "benchmark", "is", "to", "rediscover", "highly", "impactful", "microscopy", "strategies", ",", "such", "as", "STED", "microscopy", "[", "10", "]", "or", "the", "sharp", "focus", "of", "a", "radially", "polarized", "light", "beam", "[", "24", "]", ",", "as", "each", "of", "these", "incorporate", "different", "ideas", "or", "physical", "properties", "of", "light", ".", "To", "that", "end", ",", "the", "algorithm", "is", "equipped", "with", "an", "optics", "simulator", ",", "which", "contains", "a", "diverse", "set", "of", "optical", "manipulation", ",", "interaction", ",", "and", "measurement", "technologies", ".", "The", "simulator", "enables", ",", "among", "many", "other", "features", ",", "to", "define", "light", "sources", "(", "of", "any", "wavelength", "and", "power", ")", ",", "phase", "masks", "(", "i.e", ".", ",", "spatial", "light", "modulators", ",", "SLMs", ")", ",", "polarizers", ",", "variable", "retarders", "(", "e.g", ".", ",", "liquid", "crystal", "displays", ",", "LCDs", ")", ",", "diffraction", "gratings", ",", "and", "high", "NA", "lenses", "to", "replicate", "strong", "focusing", "conditions", ".", "Light", "propagation", "and", "diffraction", "is", "simulated", "by", "two", "methods", ",", "each", "available", "for", "both", "scalar", "and", "vectorial", "regimes", ":", "the", "fast-Fourier-transform", "(", "FFT", ")", "based", "numerical", "integration", "of", "the", "Rayleigh-Sommerfeld", "(", "RS", ")", "diffraction", "integral", "[", "46", ",", "47", "]", "and", "the", "Chirped", "z-transform", "(", "CZT", ")", "[", "48", "]", ".", "The", "CZT", "is", "an", "accelerated", "version", "of", "the", "RS", "algorithm", ",", "which", "allows", "for", "arbitrary", "selection", "and", "sampling", "of", "the", "region", "of", "interest", ".", "Some", "functionalities", "of", "XLUMINA's", "optics", "simulator", "(", "e.g", ".", ",", "optical", "propagation", "algorithms", ",", "planar", "lens", "or", "amplitude", "masks", ")", "are", "inspired", "in", "an", "open-source", "NumPy-based", "Python", "module", "for", "diffraction", "and", "interferometry", "simulation", ",", "Diffractio", "[", "41", "]", ",", "although", "we", "have", "rewritten", "and", "modified", "these", "approaches", "to", "combine", "them", "with", "JAX's", "just-in-time", "(", "jit", ")", "functionality", ".", "On", "top", "of", "that", ",", "we", "developed", "completely", "new", "functions", "(", "e.g", ".", ",", "LCDs", "or", "propagation", "through", "high", "NA", "objective", "lens", "with", "CZT", "methods", ",", "to", "name", "a", "few", ")", "which", "significantly", "expand", "the", "software", "capabilities", ".", "The", "most", "important", "hardware", "addition", "on", "the", "optical", "simulator", "are", "the", "SLMs", ",", "each", "pixel", "of", "which", "possesses", "an", "independent", "(", "and", "variable", ")", "phase", "value", ".", "They", "serve", "as", "a", "universal", "approximation", "for", "phase", "masks", "(", "including", "lenses", ")", "and", "offer", "a", "computational", "advantage", ":", "given", "a", "specific", "pixel", "resolution", ",", "they", "allow", "for", "unrestricted", "phase", "design", "selection", ".", "In", "addition", ",", "we", "defined", "under", "the", "name", "of", "super-SLM", "(", "sSLM", ")", "a", "hardware-box-type", "which", "consists", "of", "two", "SLMs", ",", "each", "one", "independently", "imprinting", "a", "phase", "mask", "on", "the", "horizontal", "and", "vertical", "orthogonal", "polarization", "components", "of", "the", "field", ".", "To", "include", "the", "automated", "discovery", "feature", ",", "XLUMINA's", "optical", "simulator", "and", "optimizer", "are", "tied", "together", "by", "the", "loss", "function", ".", "Thus", ",", "it", "is", "essential", "to", "reduce", "the", "computation", "time", "by", "maximizing", "the", "speed", "of", "optical", "simulation", "functions", ".", "Thus", ",", "we", "evaluate", "the", "performance", "of", "our", "optimized", "functions", "against", "their", "counterparts", "in", "Diffractio", "by", "propagating", "a", "Gaussian", "beam", "within", "a", "computational", "window", "sized", "at", "2048", "\u00d7", "2048", ".", "The", "average", "run-time", "for", "both", "Diffractio", "and", "our", "approach", "is", "shown", "in", "Figure", "2a", ".", "Generally", ",", "our", "methods", "significantly", "enhance", "computational", "speeds", "for", "simulating", "light", "diffraction", "and", "propagation", ".", "For", "instance", ",", "we", "observe", "a", "speedup", "of", "roughly", "a", "factor", "of", "2", "for", "RS", "and", "VCZT", "and", "about", "2.5", "for", "VRS", "using", "the", "CPU", ".", "CZT", "has", "less", "significant", "speedup", ",", "but", "there", "is", "still", "a", "0.5", "-", "second", "improvement", ".", "When", "it", "comes", "to", "the", "nature", "of", "the", "optimizer", ",", "it", "can", "be", "either", "direct", "(", "gradient-based", ")", "or", "deep", "learningbased", "(", "surrogate", "models", "or", "deep", "generative", "models", ",", "e.g", ".", ",", "variational", "autoencoders", "[", "49", "]", ")", ".", "In", "this", "work", ",", "we", "adopt", "a", "gradient-based", "strategy", ",", "where", "the", "experimental", "setup's", "parameters", "are", "adjusted", "iteratively", "in", "the", "steepest", "descent", "direction", ".", "To", "chose", "the", "optimizer", ",", "we", "evaluate", "the", "convergence", "time", "of", "two", "gradient-descent", "techniques", ":", "the", "Broyden-Fletcher-Goldfarb-Shanno", "(", "BFGS", ")", "algorithm", ",", "which", "numerically", "computes", "gradients", "and", "higher-order", "derivative", "approximations", ",", "and", "the", "adaptive", "moment", "estimation", "(", "ADAM", ")", ",", "an", "instance", "of", "the", "stochastic-gradient-descent", "(", "SGD", ")", "method", ".", "While", "BFGS", "is", "part", "of", "the", "open-source", "SciPy", "Python", "library", "and", "operates", "on", "the", "CPU", ",", "ADAM", "is", "integrated", "within", "the", "JAX", "library", "and", "runs", "in", "both", "CPU", "and", "GPU", ".", "For", "the", "evaluation", ",", "we", "simulate", "a", "Gaussian", "beam", "interacting", "with", "a", "phase", "mask", ".", "The", "objective", "function", "is", "the", "mean", "squared", "error", "between", "the", "detected", "light", "and", "the", "ground", "truth", ",", "characterized", "by", "a", "Gaussian", "beam", "with", "a", "spiral", "phase", "imprinted", "on", "its", "wavefront", ".", "Initializing", "with", "an", "arbitrary", "phase", "mask", "configuration", ",", "we", "run", "both", "BFGS", "and", "ADAM", "optimizers", "over", "different", "computational", "windows", "and", "devices", ",", "as", "depicted", "in", "Fig", ".", "2b", ".", "On", "the", "CPU", ",", "BFGS", "exhibits", "exponential", "scaling", "in", "convergence", "time", ",", "reaching", "about", "6500", "seconds", "for", "250", "\u00d7", "250", "pixel", "window", ".", "In", "contrast", ",", "ADAM", "demonstrates", "superior", "efficiency", ",", "reducing", "it", "to", "roughly", "2600", "seconds", ".", "This", "makes", "the", "GPU-accelerated", "ADAM", "approach", "more", "appropriate", "for", "efficient", "experimentation", ".", "Overall", ",", "the", "computational", "performance", "of", "XLUMINA", "highlights", "its", "suitability", "for", "running", "complex", "simulations", "and", "optimizations", "with", "a", "high", "level", "of", "efficiency", ".", "In", "this", "section", ",", "we", "showcase", "the", "virtual", "optical", "designs", "generated", "by", "XLUMINA", ".", "This", "arrangement", "performs", "optical", "Fourier", "transformations", "of", "input", "light", "with", "magnifications", "determined", "by", "the", "ratio", "f", "2", "/", "f", "1", ".", "To", "revisit", "this", "design", "with", "a", "magnification", "of", "2x", ",", "we", "encoded", "the", "virtual", "setup", "depicted", "in", "Fig", ".", "3a", ",", "in", "which", "traditional", "lenses", "are", "replaced", "by", "spatial", "light", "modulators", "(", "SLMs", ")", ".", "The", "parameter", "space", "includes", "the", "distances", ",", "z", "1", ",", "z", "2", "and", "z", "3", "(", "measured", "in", "millimeters", ")", "and", "the", "phase", "masks", "(", "measured", "in", "radians", ")", "of", "the", "two", "SLMs", "with", "a", "resolution", "of", "1024", "\u00d7", "1024", "pixels", ".", "Each", "sample", "consists", "of", "a", "Gaussian", "beam", "shaped", "by", "amplitude", "masks", "in", "various", "forms", "(", "circles", ",", "rectangles", ",", "squares", "and", "rings", ")", ",", "with", "varying", "sizes", "and", "orientations", ".", "The", "cost", "function", "is", "the", "mean", "squared", "error", "between", "the", "dataset's", "output", "and", "the", "detected", "intensity", "pattern", "from", "the", "virtual", "setup", ".", "The", "solution", "depicts", "lens-like", "quadratic", "phases", "in", "both", "SLMs", ".", "This", "suggests", "that", "phase", "mask", "of", "SLM", "#1", "might", "be", "compensating", "for", "this", "deviation", ".", "On", "the", "other", "hand", ",", "we", "believe", "that", "the", "more", "precise", "solution", "for", "SLM", "#2", "highlights", "its", "critical", "role", "in", "imaging", ".", "STED", "microscopy", "STED", "microscopy", "[", "10", "]", "is", "based", "on", "excitation", "and", "spatially", "targeted", "depletion", "of", "fluorophores", ".", "In", "order", "to", "achieve", "this", ",", "a", "Gaussian-shaped", "excitation", "beam", "and", "a", "doughnut-shaped", "depletion", "beam", "are", "concentrically", "overlapped", ".", "This", "effectively", "reduces", "the", "area", "of", "normal", "fluorescence", ",", "which", "leads", "to", "super-resolution", "imaging", ".", "In", "order", "to", "generate", "a", "doughnut-shaped", "beam", "a", "spiral", "phase", "is", "imprinted", "into", "the", "wavefront", "of", "a", "Gaussian", "beam", ".", "To", "revisit", "this", "principle", ",", "we", "virtually", "construct", "a", "simplified", "version", "of", "a", "STED-type", "setup", "as", "depicted", "in", "Fig", ".", "4a", ".", "It", "consists", "of", "two", "light", "sources", "generating", "Gaussian", "beams", "corresponding", "to", "the", "depletion", "and", "excitation", "beams", "with", "wavelengths", "of", "650", "nm", "and", "532", "nm", ",", "respectively", ".", "Within", "the", "depletion", "beam's", "optical", "path", ",", "we", "place", "an", "SLM", "of", "2048", "\u00d7", "2048", "resolution", "and", "a", "computational", "pixel", "size", "of", "1.95\u00b5m", ".", "In", "this", "instance", ",", "the", "parameter", "space", "is", "defined", "by", "the", "SLM", ".", "For", "this", "particular", "instance", ",", "the", "detected", "intensity", "corresponds", "to", "the", "radial", "component", ",", "In", "Fig", ".", "4b", ",", "we", "present", "the", "STED", "spiral", "phase", "mask", "[", "10", "]", "and", "the", "identified", "solution", "for", "\u03b5", "=", "0.7", ".", "From", "a", "random", "initial", "phase", "mask", "in", "the", "SLM", ",", "the", "system", "converged", "into", "a", "pattern", "alike", "to", "the", "spiral", "phase", ".", "Other", "solutions", "presented", "noisy", "phase", "patterns", "which", "failed", "to", "achieve", "the", "essential", "doughnut-shaped", "depletion", "beam", ".", "Real-world", "STED", "setups", "demand", "almost", "perfect", "phase", "patterns", ";", "even", "the", "minor", "misalignment", "can", "compromise", "the", "super-resolution", "STED", "phenomena", ".", "|", "E", "x", "|", "2", "+", "|", "E", "y", "|", "2", ",", "Sharper", "focus", "for", "a", "radially", "polarized", "light", "beam", "The", "final", "benchmark", "focuses", "on", "the", "generation", "of", "an", "ultra-sharp", "focus", "for", "a", "radially", "polarized", "beam", ",", "a", "feature", "that", "breaks", "the", "diffraction", "limit", "in", "the", "longitudinal", "direction", "as", "demonstrated", "by", "R", ".", "The", "light", "source", "emits", "a", "635", "nm", "wavelength", "Gaussian", "beam", "that", "is", "linearly", "polarized", ".", "The", "original", "optical", "elements", "are", "replaced", "by", "an", "sSLM", ",", "each", "component", "of", "which", "has", "a", "resolution", "of", "2048", "\u00d7", "2048", "pixels", "and", "a", "computational", "pixel", "size", "of", "1.46\u00b5m", ".", "Additionally", ",", "we", "place", "an", "LCD", "with", "variable", "phase", "retardance", "\u03b7", "and", "orientation", "angle", "\u03b8", ".", "The", "beam", "then", "passes", "through", "a", "high", "NA", "objective", "lens", "before", "reaching", "the", "detector", "screen", ".", "Relevant", "data", "on", "the", "sSLM's", "phase", "masks", ",", "optical", "parameters", ",", "and", "the", "simulated", "spot", "size", "are", "showcased", "in", "Fig", ".", "5b", "and", "Table", "1", ".", "With", "regards", "to", "Solution", "#2", ",", "the", "SLM", "phase", "pattern", "also", "shows", "a", "tilted", "forked", "grating", "of", "topological", "charge", "p", "=", "1", ".", "For", "comparison", ",", "we", "also", "feature", "the", "radial", "intensity", "profile", "of", "the", "diffraction-limited", "linearly", "polarized", "beam", "(", "dotted", "orange", "line", "in", "Fig", ".", "5e", ")", ".", "This", "was", "crucial", "for", "our", "purpose", "to", "demonstrate", "how", "XLUMINA", "can", "compute", "and", "efficiently", "rediscover", "known", "techniques", "in", "advanced", "microscopy", ".", "We", "aim", "to", "use", "XLUMINA", "to", "discover", "new", "microscopy", "concepts", ".", "From", "here", ",", "XLUMINA", "should", "be", "able", "to", "extract", "much", "more", "complex", "solutions", "which", "humans", "might", "not", "have", "thought", "about", "yet", "[", "2", "]", ".", "In", "this", "work", ",", "we", "present", "an", "efficient", "and", "reliable", "simulator", "for", "advanced", "optical", "microscopy", ".", "The", "simulator", "is", "developed", "in", "a", "modular", "way", ",", "and", "we", "plan", "to", "significantly", "expand", "it", "by", "adding", "more", "physical", "properties", "and", "features", "exploited", "in", "microscopy", ",", "for", "example", ",", "detailed", "coverage", "of", "frequency", "and", "time", "information", ",", "which", "might", "enable", "systems", "such", "as", "iSCAT", "[", "56", "]", ",", "structured", "illumination", "microscopy", "[", "57", "]", ",", "and", "localization", "microscopy", "[", "58", "]", ".", "Looking", "further", "into", "the", "future", ",", "one", "can", "expect", "that", "matter-wave", "beams", "(", "governed", "by", "Schr\u00f6dinger's", "equation", ",", "which", "is", "closely", "related", "to", "the", "paraxial", "wave", "equation", ",", "a", "special", "case", "of", "the", "electromagnetic", "field", ")", "can", "be", "simulated", "in", "the", "same", "framework", ".", "This", "might", "allow", "for", "the", "AI-based", "design", "of", "hybrid", "microscopy", "techniques", "using", "light", "and", "complex", "electron-beams", "[", "61", "]", "or", "coherent", "beams", "of", "high-mass", "particles", "[", "62", "]", "."], "sentences": [["XLUMINA", ":", "An", "Auto-differentiating", "Discovery", "Framework", "for", "Super-Resolution", "Microscopy", "In", "this", "work", "we", "introduce", "XLUMINA", ",", "an", "original", "computational", "framework", "designed", "for", "the", "discovery", "of", "novel", "optical", "hardware", "in", "super-resolution", "microscopy", "."], ["Our", "framework", "offers", "auto-differentiation", "capabilities", ",", "allowing", "for", "the", "fast", "and", "efficient", "simulation", "and", "automated", "design", "of", "entirely", "new", "optical", "setups", "from", "scratch", "."], ["We", "showcase", "its", "potential", "by", "rediscovering", "three", "foundational", "experiments", ",", "each", "one", "covering", "different", "areas", "in", "optics", ":", "an", "optical", "telescope", ",", "STED", "microscopy", "and", "the", "focusing", "beyond", "the", "diffraction", "limit", "of", "a", "radially", "polarized", "light", "beam", "."], ["With", "XLUMINA", ",", "can", "we", "go", "beyond", "simple", "optimization", "and", "calibration", "of", "known", "experimental", "setups", ",", "opening", "the", "door", "to", "potentially", "uncovering", "new", "microscopy", "concepts", "within", "the", "vast", "landscape", "of", "experimental", "possibilities", "."], ["FINAL", "SET-UP", "AI-based", "exploration", "tool", "Objective", "function", "e.g", ".", "spot", "size", ",", "\u03d5", "=", "\u03c0", "FWHMxFWHMy", "4", "Enormously", "large", "search", "space", "OPTICS", "SIMULATOR", "FINAL", "SET-UP", "The", "space", "of", "all", "possible", "experimental", "optical", "configurations", "is", "enormous", "."], ["This", "is", "where", "AI-based", "exploration", "techniques", "could", "provide", "enormous", "benefit", ",", "by", "exploring", "the", "space", "in", "a", "fast", ",", "unbiased", "way", "[", "1", ",", "2", "]", "."], ["Among", "them", ",", "the", "discovery", "of", "super-resolution", "(", "SR", ")", "methods", ",", "which", "circumvent", "the", "classical", "diffraction", "limit", "of", "light", ",", "stand", "out", "in", "particular", "."], ["Examples", "for", "versatile", "and", "powerful", "SR", "techniques", "are", "STED", "[", "10", "]", ",", "PALM", "/", "F-PALM", "[", "11", ",", "12", "]", ",", "(", "d", ")", "STORM", "[", "13", ",", "14", "]", ",", "SIM", "[", "15", "]", ",", "and", "MINFLUX", "[", "16", "]", ",", "with", "considerable", "impact", "in", "biology", "[", "17", "]", "[", "18", "]", "[", "19", "]", ",", "chemistry", "[", "20", "]", "and", "material", "sciences", "[", "21", "]", "for", "example", "."], ["Rather", ",", "this", "work", "sets", "out", "to", "discover", "novel", ",", "experimentally", "viable", "concepts", "for", "advanced", "optical", "microscopy", "that", "are", "at-present", "entirely", "untapped", "."], ["The", "simulator", "can", "either", "be", "called", "directly", "by", "gradient-based", "optimization", "techniques", ",", "or", "it", "can", "be", "used", "for", "generating", "the", "training", "data", "for", "deep-learning-based", "surrogate", "models", "."], ["We", "introduce", "XLUMINA", ",", "an", "efficient", "framework", "with", "auto-differentiation", "capabilities", "[", "23", "]", "for", "the", "ultimate", "goal", "of", "discovering", "new", "optical", "design", "principles", "."], ["We", "demonstrate", "our", "approach", "on", "three", "foundational", "optical", "layouts", ":", "a", "telescope", "version", ",", "the", "polarization-based", "beam", "shaping", "as", "used", "in", "STED", "(", "stimulated", "emission", "depletion", ")", "microscopy", "[", "10", "]", "and", "the", "sharp", "focus", "of", "a", "radially", "polarized", "light", "beam", "[", "24", "]", "."], ["Rather", ",", "the", "future", "application", "of", "XLUMINA", "is", "the", "AI-driven", "discovery", "of", "completely", "novel", "physical", "concepts", "for", "advanced", "optical", "microscopy", "."], ["Optimization", "in", "microscopy", "Our", "approach", "is", "radically", "different", "from", "previous", "strategies", "that", "employ", "AI", "for", "data-driven", "design", "of", "single", "optical", "elements", "[", "25", ",", "26", "]", "or", "data", "analysis", "in", "microscopy", ",", "e.g", ".", "denoising", ",", "contrast", "enhancement", "or", "point-spread-function", "(", "PSF", ")", "engineering", "[", "27", "]", "."], ["In", "contrast", ",", "XLUMINA", "is", "equipped", "with", "tools", "for", "simulate", ",", "optimize", "and", "automatically", "design", "new", "optical", "setups", "and", "concepts", "from", "scratch", "."], ["The", "main", "approach", "is", "the", "development", "of", "efficient", "PDE-solvers", "for", "Maxwell's", "equations", ",", "including", "efficient", "ways", "to", "compute", "the", "gradients", "of", "the", "vast", "amount", "of", "parameters", ",", "usually", "by", "a", "physics-inspired", "technique", "called", "the", "adjoint", "method", "[", "38", ",", "39", "]", "."], ["Interestingly", ",", "the", "adjoint", "method", "can", "be", "seen", "as", "a", "special", "case", "of", "auto-differentiation", "(", "which", "we", "use", ")", "[", "39", "]", "."], ["Several", "open-source", "software", "tools", ",", "like", "Diffractio", "for", "light", "diffraction", "and", "interference", "simulations", "[", "41", "]", ",", "Finesse", "for", "simulating", "gravitational", "wave", "detectors", "[", "42", "]", ",", "and", "POPPY", ",", "developed", "as", "a", "part", "of", "the", "simulation", "package", "of", "the", "James", "Webb", "Telescope", "[", "43", "]", ",", "facilitate", "classical", "optics", "phenomena", "simulations", "."], ["There", "are", "also", "specialized", "resources", "like", "those", "focusing", "on", "the", "design", "of", "Laguerre-Gaussian", "mode", "sorters", "utilizing", "multi-plane", "light", "conversion", "(", "MPLC", ")", "methods", "[", "44", "]", "."], ["While", "these", "software", "offer", "optics", "simulation", "capabilities", ",", "XLUMINA", "uniquely", "integrates", "simulation", "with", "AI-driven", "automated", "design", "powered", "with", "JAX's", "autodiff", "and", "just-in-time", "(", "jit", ")", "compilation", "capabilities", ".", "2", "Software", "workflow", "and", "performance", "XLUMINA", "allows", "for", "the", "simulation", "of", "classical", "optics", "hardware", "configurations", "and", "enables", "the", "optimization", "and", "automated", "discovery", "of", "new", "setup", "designs", "."], ["The", "software", "is", "developed", "using", "JAX", "[", "45", "]", ",", "which", "provides", "an", "advantage", "of", "heightened", "computational", "speed", "while", "seamlessly", "integrating", "the", "auto-differentiation", "framework", "[", "23", "]", "."], ["The", "first", "benchmark", "is", "to", "rediscover", "highly", "impactful", "microscopy", "strategies", ",", "such", "as", "STED", "microscopy", "[", "10", "]", "or", "the", "sharp", "focus", "of", "a", "radially", "polarized", "light", "beam", "[", "24", "]", ",", "as", "each", "of", "these", "incorporate", "different", "ideas", "or", "physical", "properties", "of", "light", "."], ["To", "that", "end", ",", "the", "algorithm", "is", "equipped", "with", "an", "optics", "simulator", ",", "which", "contains", "a", "diverse", "set", "of", "optical", "manipulation", ",", "interaction", ",", "and", "measurement", "technologies", "."], ["The", "simulator", "enables", ",", "among", "many", "other", "features", ",", "to", "define", "light", "sources", "(", "of", "any", "wavelength", "and", "power", ")", ",", "phase", "masks", "(", "i.e", ".", ",", "spatial", "light", "modulators", ",", "SLMs", ")", ",", "polarizers", ",", "variable", "retarders", "(", "e.g", ".", ",", "liquid", "crystal", "displays", ",", "LCDs", ")", ",", "diffraction", "gratings", ",", "and", "high", "NA", "lenses", "to", "replicate", "strong", "focusing", "conditions", "."], ["Light", "propagation", "and", "diffraction", "is", "simulated", "by", "two", "methods", ",", "each", "available", "for", "both", "scalar", "and", "vectorial", "regimes", ":", "the", "fast-Fourier-transform", "(", "FFT", ")", "based", "numerical", "integration", "of", "the", "Rayleigh-Sommerfeld", "(", "RS", ")", "diffraction", "integral", "[", "46", ",", "47", "]", "and", "the", "Chirped", "z-transform", "(", "CZT", ")", "[", "48", "]", "."], ["The", "CZT", "is", "an", "accelerated", "version", "of", "the", "RS", "algorithm", ",", "which", "allows", "for", "arbitrary", "selection", "and", "sampling", "of", "the", "region", "of", "interest", "."], ["Some", "functionalities", "of", "XLUMINA's", "optics", "simulator", "(", "e.g", ".", ",", "optical", "propagation", "algorithms", ",", "planar", "lens", "or", "amplitude", "masks", ")", "are", "inspired", "in", "an", "open-source", "NumPy-based", "Python", "module", "for", "diffraction", "and", "interferometry", "simulation", ",", "Diffractio", "[", "41", "]", ",", "although", "we", "have", "rewritten", "and", "modified", "these", "approaches", "to", "combine", "them", "with", "JAX's", "just-in-time", "(", "jit", ")", "functionality", "."], ["On", "top", "of", "that", ",", "we", "developed", "completely", "new", "functions", "(", "e.g", ".", ",", "LCDs", "or", "propagation", "through", "high", "NA", "objective", "lens", "with", "CZT", "methods", ",", "to", "name", "a", "few", ")", "which", "significantly", "expand", "the", "software", "capabilities", "."], ["The", "most", "important", "hardware", "addition", "on", "the", "optical", "simulator", "are", "the", "SLMs", ",", "each", "pixel", "of", "which", "possesses", "an", "independent", "(", "and", "variable", ")", "phase", "value", "."], ["They", "serve", "as", "a", "universal", "approximation", "for", "phase", "masks", "(", "including", "lenses", ")", "and", "offer", "a", "computational", "advantage", ":", "given", "a", "specific", "pixel", "resolution", ",", "they", "allow", "for", "unrestricted", "phase", "design", "selection", "."], ["In", "addition", ",", "we", "defined", "under", "the", "name", "of", "super-SLM", "(", "sSLM", ")", "a", "hardware-box-type", "which", "consists", "of", "two", "SLMs", ",", "each", "one", "independently", "imprinting", "a", "phase", "mask", "on", "the", "horizontal", "and", "vertical", "orthogonal", "polarization", "components", "of", "the", "field", "."], ["To", "include", "the", "automated", "discovery", "feature", ",", "XLUMINA's", "optical", "simulator", "and", "optimizer", "are", "tied", "together", "by", "the", "loss", "function", "."], ["Thus", ",", "it", "is", "essential", "to", "reduce", "the", "computation", "time", "by", "maximizing", "the", "speed", "of", "optical", "simulation", "functions", "."], ["Thus", ",", "we", "evaluate", "the", "performance", "of", "our", "optimized", "functions", "against", "their", "counterparts", "in", "Diffractio", "by", "propagating", "a", "Gaussian", "beam", "within", "a", "computational", "window", "sized", "at", "2048", "\u00d7", "2048", "."], ["The", "average", "run-time", "for", "both", "Diffractio", "and", "our", "approach", "is", "shown", "in", "Figure", "2a", "."], ["Generally", ",", "our", "methods", "significantly", "enhance", "computational", "speeds", "for", "simulating", "light", "diffraction", "and", "propagation", "."], ["For", "instance", ",", "we", "observe", "a", "speedup", "of", "roughly", "a", "factor", "of", "2", "for", "RS", "and", "VCZT", "and", "about", "2.5", "for", "VRS", "using", "the", "CPU", "."], ["CZT", "has", "less", "significant", "speedup", ",", "but", "there", "is", "still", "a", "0.5", "-", "second", "improvement", "."], ["When", "it", "comes", "to", "the", "nature", "of", "the", "optimizer", ",", "it", "can", "be", "either", "direct", "(", "gradient-based", ")", "or", "deep", "learningbased", "(", "surrogate", "models", "or", "deep", "generative", "models", ",", "e.g", ".", ",", "variational", "autoencoders", "[", "49", "]", ")", "."], ["In", "this", "work", ",", "we", "adopt", "a", "gradient-based", "strategy", ",", "where", "the", "experimental", "setup's", "parameters", "are", "adjusted", "iteratively", "in", "the", "steepest", "descent", "direction", "."], ["To", "chose", "the", "optimizer", ",", "we", "evaluate", "the", "convergence", "time", "of", "two", "gradient-descent", "techniques", ":", "the", "Broyden-Fletcher-Goldfarb-Shanno", "(", "BFGS", ")", "algorithm", ",", "which", "numerically", "computes", "gradients", "and", "higher-order", "derivative", "approximations", ",", "and", "the", "adaptive", "moment", "estimation", "(", "ADAM", ")", ",", "an", "instance", "of", "the", "stochastic-gradient-descent", "(", "SGD", ")", "method", "."], ["While", "BFGS", "is", "part", "of", "the", "open-source", "SciPy", "Python", "library", "and", "operates", "on", "the", "CPU", ",", "ADAM", "is", "integrated", "within", "the", "JAX", "library", "and", "runs", "in", "both", "CPU", "and", "GPU", "."], ["For", "the", "evaluation", ",", "we", "simulate", "a", "Gaussian", "beam", "interacting", "with", "a", "phase", "mask", "."], ["The", "objective", "function", "is", "the", "mean", "squared", "error", "between", "the", "detected", "light", "and", "the", "ground", "truth", ",", "characterized", "by", "a", "Gaussian", "beam", "with", "a", "spiral", "phase", "imprinted", "on", "its", "wavefront", "."], ["Initializing", "with", "an", "arbitrary", "phase", "mask", "configuration", ",", "we", "run", "both", "BFGS", "and", "ADAM", "optimizers", "over", "different", "computational", "windows", "and", "devices", ",", "as", "depicted", "in", "Fig", ".", "2b", "."], ["On", "the", "CPU", ",", "BFGS", "exhibits", "exponential", "scaling", "in", "convergence", "time", ",", "reaching", "about", "6500", "seconds", "for", "250", "\u00d7", "250", "pixel", "window", "."], ["In", "contrast", ",", "ADAM", "demonstrates", "superior", "efficiency", ",", "reducing", "it", "to", "roughly", "2600", "seconds", "."], ["This", "makes", "the", "GPU-accelerated", "ADAM", "approach", "more", "appropriate", "for", "efficient", "experimentation", "."], ["Overall", ",", "the", "computational", "performance", "of", "XLUMINA", "highlights", "its", "suitability", "for", "running", "complex", "simulations", "and", "optimizations", "with", "a", "high", "level", "of", "efficiency", "."], ["In", "this", "section", ",", "we", "showcase", "the", "virtual", "optical", "designs", "generated", "by", "XLUMINA", "."], ["This", "arrangement", "performs", "optical", "Fourier", "transformations", "of", "input", "light", "with", "magnifications", "determined", "by", "the", "ratio", "f", "2", "/", "f", "1", "."], ["To", "revisit", "this", "design", "with", "a", "magnification", "of", "2x", ",", "we", "encoded", "the", "virtual", "setup", "depicted", "in", "Fig", ".", "3a", ",", "in", "which", "traditional", "lenses", "are", "replaced", "by", "spatial", "light", "modulators", "(", "SLMs", ")", "."], ["The", "parameter", "space", "includes", "the", "distances", ",", "z", "1", ",", "z", "2", "and", "z", "3", "(", "measured", "in", "millimeters", ")", "and", "the", "phase", "masks", "(", "measured", "in", "radians", ")", "of", "the", "two", "SLMs", "with", "a", "resolution", "of", "1024", "\u00d7", "1024", "pixels", "."], ["Each", "sample", "consists", "of", "a", "Gaussian", "beam", "shaped", "by", "amplitude", "masks", "in", "various", "forms", "(", "circles", ",", "rectangles", ",", "squares", "and", "rings", ")", ",", "with", "varying", "sizes", "and", "orientations", "."], ["The", "cost", "function", "is", "the", "mean", "squared", "error", "between", "the", "dataset's", "output", "and", "the", "detected", "intensity", "pattern", "from", "the", "virtual", "setup", "."], ["The", "solution", "depicts", "lens-like", "quadratic", "phases", "in", "both", "SLMs", "."], ["This", "suggests", "that", "phase", "mask", "of", "SLM", "#1", "might", "be", "compensating", "for", "this", "deviation", "."], ["On", "the", "other", "hand", ",", "we", "believe", "that", "the", "more", "precise", "solution", "for", "SLM", "#2", "highlights", "its", "critical", "role", "in", "imaging", "."], ["STED", "microscopy", "STED", "microscopy", "[", "10", "]", "is", "based", "on", "excitation", "and", "spatially", "targeted", "depletion", "of", "fluorophores", "."], ["In", "order", "to", "achieve", "this", ",", "a", "Gaussian-shaped", "excitation", "beam", "and", "a", "doughnut-shaped", "depletion", "beam", "are", "concentrically", "overlapped", "."], ["This", "effectively", "reduces", "the", "area", "of", "normal", "fluorescence", ",", "which", "leads", "to", "super-resolution", "imaging", "."], ["In", "order", "to", "generate", "a", "doughnut-shaped", "beam", "a", "spiral", "phase", "is", "imprinted", "into", "the", "wavefront", "of", "a", "Gaussian", "beam", "."], ["To", "revisit", "this", "principle", ",", "we", "virtually", "construct", "a", "simplified", "version", "of", "a", "STED-type", "setup", "as", "depicted", "in", "Fig", ".", "4a", "."], ["It", "consists", "of", "two", "light", "sources", "generating", "Gaussian", "beams", "corresponding", "to", "the", "depletion", "and", "excitation", "beams", "with", "wavelengths", "of", "650", "nm", "and", "532", "nm", ",", "respectively", "."], ["Within", "the", "depletion", "beam's", "optical", "path", ",", "we", "place", "an", "SLM", "of", "2048", "\u00d7", "2048", "resolution", "and", "a", "computational", "pixel", "size", "of", "1.95\u00b5m", "."], ["In", "this", "instance", ",", "the", "parameter", "space", "is", "defined", "by", "the", "SLM", "."], ["For", "this", "particular", "instance", ",", "the", "detected", "intensity", "corresponds", "to", "the", "radial", "component", ",", "In", "Fig", ".", "4b", ",", "we", "present", "the", "STED", "spiral", "phase", "mask", "[", "10", "]", "and", "the", "identified", "solution", "for", "\u03b5", "=", "0.7", "."], ["From", "a", "random", "initial", "phase", "mask", "in", "the", "SLM", ",", "the", "system", "converged", "into", "a", "pattern", "alike", "to", "the", "spiral", "phase", "."], ["Other", "solutions", "presented", "noisy", "phase", "patterns", "which", "failed", "to", "achieve", "the", "essential", "doughnut-shaped", "depletion", "beam", "."], ["Real-world", "STED", "setups", "demand", "almost", "perfect", "phase", "patterns", ";", "even", "the", "minor", "misalignment", "can", "compromise", "the", "super-resolution", "STED", "phenomena", "."], ["|", "E", "x", "|", "2", "+", "|", "E", "y", "|", "2", ",", "Sharper", "focus", "for", "a", "radially", "polarized", "light", "beam", "The", "final", "benchmark", "focuses", "on", "the", "generation", "of", "an", "ultra-sharp", "focus", "for", "a", "radially", "polarized", "beam", ",", "a", "feature", "that", "breaks", "the", "diffraction", "limit", "in", "the", "longitudinal", "direction", "as", "demonstrated", "by", "R", "."], ["The", "light", "source", "emits", "a", "635", "nm", "wavelength", "Gaussian", "beam", "that", "is", "linearly", "polarized", "."], ["The", "original", "optical", "elements", "are", "replaced", "by", "an", "sSLM", ",", "each", "component", "of", "which", "has", "a", "resolution", "of", "2048", "\u00d7", "2048", "pixels", "and", "a", "computational", "pixel", "size", "of", "1.46\u00b5m", "."], ["Additionally", ",", "we", "place", "an", "LCD", "with", "variable", "phase", "retardance", "\u03b7", "and", "orientation", "angle", "\u03b8", "."], ["The", "beam", "then", "passes", "through", "a", "high", "NA", "objective", "lens", "before", "reaching", "the", "detector", "screen", "."], ["Relevant", "data", "on", "the", "sSLM's", "phase", "masks", ",", "optical", "parameters", ",", "and", "the", "simulated", "spot", "size", "are", "showcased", "in", "Fig", ".", "5b", "and", "Table", "1", "."], ["With", "regards", "to", "Solution", "#2", ",", "the", "SLM", "phase", "pattern", "also", "shows", "a", "tilted", "forked", "grating", "of", "topological", "charge", "p", "=", "1", "."], ["For", "comparison", ",", "we", "also", "feature", "the", "radial", "intensity", "profile", "of", "the", "diffraction-limited", "linearly", "polarized", "beam", "(", "dotted", "orange", "line", "in", "Fig", ".", "5e", ")", "."], ["This", "was", "crucial", "for", "our", "purpose", "to", "demonstrate", "how", "XLUMINA", "can", "compute", "and", "efficiently", "rediscover", "known", "techniques", "in", "advanced", "microscopy", "."], ["We", "aim", "to", "use", "XLUMINA", "to", "discover", "new", "microscopy", "concepts", "."], ["From", "here", ",", "XLUMINA", "should", "be", "able", "to", "extract", "much", "more", "complex", "solutions", "which", "humans", "might", "not", "have", "thought", "about", "yet", "[", "2", "]", "."], ["In", "this", "work", ",", "we", "present", "an", "efficient", "and", "reliable", "simulator", "for", "advanced", "optical", "microscopy", "."], ["The", "simulator", "is", "developed", "in", "a", "modular", "way", ",", "and", "we", "plan", "to", "significantly", "expand", "it", "by", "adding", "more", "physical", "properties", "and", "features", "exploited", "in", "microscopy", ",", "for", "example", ",", "detailed", "coverage", "of", "frequency", "and", "time", "information", ",", "which", "might", "enable", "systems", "such", "as", "iSCAT", "[", "56", "]", ",", "structured", "illumination", "microscopy", "[", "57", "]", ",", "and", "localization", "microscopy", "[", "58", "]", "."], ["Looking", "further", "into", "the", "future", ",", "one", "can", "expect", "that", "matter-wave", "beams", "(", "governed", "by", "Schr\u00f6dinger's", "equation", ",", "which", "is", "closely", "related", "to", "the", "paraxial", "wave", "equation", ",", "a", "special", "case", "of", "the", "electromagnetic", "field", ")", "can", "be", "simulated", "in", "the", "same", "framework", "."], ["This", "might", "allow", "for", "the", "AI-based", "design", "of", "hybrid", "microscopy", "techniques", "using", "light", "and", "complex", "electron-beams", "[", "61", "]", "or", "coherent", "beams", "of", "high-mass", "particles", "[", "62", "]", "."]], "ner": [[[0, 0, "Method"], [3, 5, "Method"], [7, 8, "Task"], [14, 14, "Method"], [29, 30, "Task"]], [[35, 35, "Method"]], [[78, 78, "Method"], [90, 92, "Method"]], [[95, 95, "Method"]], [[129, 131, "Method"]], [[166, 168, "Method"]], [[196, 196, "Method"], [198, 198, "Method"]], [[221, 221, "Method"], [224, 224, "Method"], [229, 231, "Method"], [241, 241, "Method"], [248, 248, "Method"], [254, 254, "Method"]], [[302, 303, "Task"]], [[318, 320, "Method"], [333, 335, "Method"]], [[339, 339, "Method"], [345, 345, "Method"]], [[376, 378, "Method"], [382, 382, "Method"], [384, 386, "Method"], [398, 401, "Method"]], [[412, 412, "Method"], [424, 425, "Task"]], [[461, 461, "Method"], [463, 464, "Method"], [466, 466, "Method"], [468, 468, "Method"]], [[478, 478, "Method"]], [[506, 506, "Method"]], [[553, 553, "Method"]], [[569, 569, "Method"], [571, 572, "Task"], [574, 575, "Task"], [580, 580, "Method"], [582, 585, "Task"], [591, 591, "Method"], [612, 614, "Task"]], [[628, 628, "Method"], [632, 634, "Method"], [636, 636, "Method"]], [[651, 651, "Method"], [656, 658, "Method"], [676, 676, "Method"]], [[720, 720, "Method"]], [[734, 735, "Method"], [739, 739, "Method"], [751, 753, "Method"]], [[781, 782, "Method"]], [[820, 821, "Method"], [826, 828, "Method"], [830, 830, "Method"], [833, 833, "Method"], [835, 836, "Method"], [841, 843, "Method"], [845, 845, "Method"], [848, 849, "Method"], [853, 854, "Method"]], [[881, 881, "Method"], [883, 883, "Method"], [890, 890, "Method"], [892, 892, "Method"], [903, 904, "Method"], [906, 906, "Method"]], [[913, 913, "Method"], [920, 920, "Method"]], [[939, 941, "Method"], [946, 948, "Method"], [950, 951, "Method"], [953, 954, "Method"], [965, 965, "Task"], [967, 968, "Task"], [970, 970, "Method"]], [[1008, 1008, "Method"], [1013, 1015, "Method"], [1017, 1017, "Method"]], [[1039, 1040, "Method"], [1043, 1043, "Method"]], [[1066, 1067, "Method"]], [[1101, 1101, "Method"], [1103, 1103, "Method"], [1111, 1111, "Method"], [1118, 1119, "Method"]], [[1139, 1141, "Method"], [1143, 1143, "Method"]], [[1167, 1169, "Method"]], [[1185, 1185, "Method"], [1189, 1190, "Method"]], [[1206, 1206, "Method"]], [[1226, 1227, "Task"]], [[1245, 1245, "Method"], [1247, 1247, "Method"], [1252, 1252, "Method"]], [[1257, 1257, "Method"]], [[1289, 1289, "Method"], [1292, 1293, "Method"], [1295, 1296, "Method"], [1298, 1300, "Method"], [1305, 1306, "Method"]], [[1319, 1320, "Method"]], [[1348, 1349, "Method"], [1352, 1352, "Method"], [1354, 1354, "Method"], [1369, 1371, "Method"], [1373, 1373, "Method"], [1380, 1380, "Method"], [1382, 1382, "Method"]], [[1387, 1387, "Method"], [1402, 1402, "Method"]], [[1424, 1425, "Method"], [1429, 1430, "Method"]], [[1437, 1439, "Method"], [1452, 1453, "Method"]], [[1467, 1468, "Method"], [1474, 1474, "Method"], [1476, 1476, "Method"]], [[1496, 1496, "Method"]], [[1518, 1518, "Method"]], [[1534, 1534, "Method"]], [[1548, 1548, "Method"]], [[1577, 1577, "Method"]], [[1582, 1584, "Method"]], [[1628, 1630, "Method"], [1632, 1632, "Method"]], [[1657, 1658, "Method"], [1667, 1667, "Method"]], [[1682, 1683, "Method"]], [[1712, 1714, "Method"]], [[1732, 1733, "Method"], [1737, 1737, "Method"]], [[1742, 1743, "Method"], [1745, 1745, "Method"]], [[1767, 1767, "Method"]], [[1776, 1776, "Method"], [1778, 1778, "Method"]], [[1801, 1803, "Method"], [1806, 1808, "Method"]], [[1825, 1826, "Task"]], [[1833, 1834, "Method"], [1845, 1846, "Method"]], [[1861, 1861, "Method"]], [[1877, 1878, "Method"]], [[1907, 1907, "Method"]], [[1932, 1932, "Method"]], [[1956, 1956, "Method"], [1958, 1959, "Method"]], [[1974, 1977, "Method"], [1980, 1980, "Method"]], [[2006, 2008, "Method"]], [[2010, 2011, "Method"], [2026, 2027, "Method"]], [[2047, 2049, "Method"], [2064, 2065, "Method"]], [[2091, 2092, "Method"]], [[2106, 2106, "Method"]], [[2133, 2133, "Method"]], [[2151, 2153, "Method"]], [[2164, 2164, "Method"], [2165, 2166, "Method"]], [[2193, 2193, "Method"]], [[2221, 2224, "Method"]], [[2244, 2244, "Method"]], [[2260, 2260, "Method"]], [[2270, 2270, "Method"]], [[2302, 2302, "Method"], [2305, 2306, "Task"]], [[2352, 2352, "Method"], [2357, 2359, "Method"], [2365, 2366, "Method"]], [[2381, 2382, "Method"]], [[2423, 2425, "Method"], [2429, 2430, "Method"], [2435, 2439, "Method"]]], "relations": [[[0, 0, 3, 5, "SubClass-Of"], [3, 5, 7, 8, "Used-For"], [0, 0, 7, 8, "Used-For"], [14, 14, 29, 30, "Used-For"]], [], [], [], [], [], [[198, 198, 196, 196, "Synonym-Of"]], [[224, 224, 221, 221, "SubClass-Of"], [229, 231, 221, 221, "SubClass-Of"], [241, 241, 221, 221, "SubClass-Of"], [248, 248, 221, 221, "SubClass-Of"], [254, 254, 221, 221, "SubClass-Of"]], [], [], [[345, 345, 339, 339, "Part-Of"]], [[376, 378, 382, 382, "Part-Of"], [384, 386, 382, 382, "Synonym-Of"]], [[412, 412, 424, 425, "Used-For"]], [[468, 468, 466, 466, "Synonym-Of"]], [], [], [], [[569, 569, 571, 572, "Used-For"], [569, 569, 574, 575, "Used-For"], [580, 580, 582, 585, "Used-For"], [591, 591, 612, 614, "Used-For"]], [[632, 634, 628, 628, "Part-Of"], [636, 636, 632, 634, "Synonym-Of"]], [[656, 658, 651, 651, "Part-Of"]], [], [[739, 739, 734, 735, "SubClass-Of"], [751, 753, 734, 735, "SubClass-Of"]], [], [[826, 828, 820, 821, "SubClass-Of"], [830, 830, 826, 828, "Synonym-Of"], [841, 843, 835, 836, "SubClass-Of"], [845, 845, 841, 843, "Synonym-Of"]], [[883, 883, 881, 881, "Synonym-Of"], [892, 892, 890, 890, "Synonym-Of"], [906, 906, 903, 904, "Synonym-Of"]], [[913, 913, 920, 920, "SubClass-Of"]], [[946, 948, 939, 941, "SubClass-Of"], [950, 951, 939, 941, "SubClass-Of"], [953, 954, 939, 941, "SubClass-Of"], [939, 941, 965, 965, "Used-For"], [953, 954, 965, 965, "Used-For"], [950, 951, 965, 965, "Used-For"], [946, 948, 965, 965, "Used-For"], [939, 941, 967, 968, "Used-For"]], [[1017, 1017, 1013, 1015, "Part-Of"]], [[1043, 1043, 1039, 1040, "Part-Of"]], [], [[1103, 1103, 1101, 1101, "Synonym-Of"], [1111, 1111, 1101, 1101, "Part-Of"]], [], [], [[1189, 1190, 1185, 1185, "Part-Of"]], [], [], [], [], [[1295, 1296, 1292, 1293, "SubClass-Of"], [1298, 1300, 1292, 1293, "SubClass-Of"], [1305, 1306, 1298, 1300, "SubClass-Of"]], [], [[1352, 1352, 1348, 1349, "SubClass-Of"], [1369, 1371, 1348, 1349, "SubClass-Of"], [1354, 1354, 1352, 1352, "Synonym-Of"], [1373, 1373, 1369, 1371, "Synonym-Of"], [1369, 1371, 1380, 1380, "SubClass-Of"], [1382, 1382, 1380, 1380, "Synonym-Of"]], [[1387, 1387, 1402, 1402, "Compare-With"]], [[1429, 1430, 1424, 1425, "Part-Of"]], [], [], [], [], [], [], [], [], [[1632, 1632, 1628, 1630, "SubClass-Of"]], [[1657, 1658, 1667, 1667, "Part-Of"]], [], [], [[1732, 1733, 1737, 1737, "Part-Of"]], [[1742, 1743, 1745, 1745, "Part-Of"]], [], [], [], [], [], [], [], [], [], [], [[1974, 1977, 1980, 1980, "Part-Of"]], [], [], [], [], [], [], [], [[2165, 2166, 2164, 2164, "Part-Of"]], [], [], [], [], [], [[2302, 2302, 2305, 2306, "Used-For"]], [], [], [[2429, 2430, 2423, 2425, "Part-Of"], [2435, 2439, 2423, 2425, "Part-Of"]]]}
{"doc_id": "EMNLP2023 (7)", "doc_tokens": ["Label", "Words", "are", "Anchors", ":", "An", "Information", "Flow", "Perspective", "for", "Understanding", "In-Context", "Learning", "In-context", "learning", "(", "ICL", ")", "emerges", "as", "a", "promising", "capability", "of", "large", "language", "models", "(", "LLMs", ")", "by", "providing", "them", "with", "demonstration", "examples", "to", "perform", "diverse", "tasks", ".", "However", ",", "the", "underlying", "mechanism", "of", "how", "LLMs", "learn", "from", "the", "provided", "context", "remains", "under-explored", ".", "In", "this", "paper", ",", "we", "investigate", "the", "working", "mechanism", "of", "ICL", "through", "an", "information", "flow", "lens", ".", "Our", "findings", "reveal", "that", "label", "words", "in", "the", "demonstration", "examples", "function", "as", "anchors", ":", "In-context", "Learning", "(", "ICL", ")", "has", "emerged", "as", "a", "powerful", "capability", "alongside", "the", "development", "of", "scaledup", "large", "language", "models", "(", "LLMs", ")", "(", "Brown", "et", "al", ".", ",", "2020", ")", ".", "By", "instructing", "LLMs", "using", "few-shot", "demonstration", "examples", ",", "ICL", "enables", "them", "to", "perform", "a", "wide", "range", "of", "tasks", ",", "such", "as", "text", "classification", "(", "Min", "et", "al", ".", ",", "2022a", ")", "and", "mathematical", "reasoning", "(", "Wei", "et", "al", ".", ",", "2022", ")", ".", "Despite", "its", "significance", ",", "the", "inner", "working", "mechanism", "of", "ICL", "remains", "an", "open", "question", ",", "garnering", "considerable", "interest", "from", "research", "communities", "(", "Xie", "et", "al", ".", ",", "2022", ";", "Dai", "et", "al", ".", ",", "2022", ";", "Aky\u00fcrek", "et", "al", ".", ",", "2022", ";", "Li", "et", "al", ".", ",", "2023b", ")", ".", "In", "this", "paper", ",", "we", "find", "that", "the", "label", "words", "serve", "as", "anchors", "that", "aggregate", "and", "distribute", "information", "in", "ICL", ".", "We", "first", "visualize", "the", "attention", "interactive", "pattern", "between", "tokens", "with", "a", "GPT", "model", "(", "Brown", "et", "al", ".", ",", "2020", ")", "on", "sentiment", "analysis", "(", "Figure", "1", ")", ".", "H", "2", ":", "In", "deep", "layers", ",", "the", "model", "extracts", "the", "information", "from", "label", "words", "to", "form", "the", "final", "prediction", ".", "Two", "experiments", "are", "designed", "to", "validate", "the", "hypothesis", "using", "GPT2", "-", "XL", "(", "Radford", "et", "al", ".", ",", "2019", ")", "and", "GPT-J", "(", "Wang", "and", "Komatsuzaki", ",", "2021", ")", "across", "several", "text", "classification", "benchmarks", ".", "(", "1", ")", "By", "blocking", "the", "information", "aggregation", "path", "to", "label", "words", "in", "certain", "layers", ",", "we", "find", "that", "such", "isolation", "in", "shallow", "layers", "significantly", "impairs", "model", "performance", ".", "This", "indicates", "that", "label", "words", "collect", "useful", "information", "during", "forward", "propagation", "in", "shallow", "layers", ".", "(", "2", ")", "We", "investigate", "the", "relationship", "between", "the", "attention", "distributions", "on", "the", "label", "words", "of", "the", "target", "position", "and", "the", "model's", "final", "prediction", ".", "In", "summary", ",", "these", "experimental", "findings", "suggest", "that", "our", "hypothesis", "holds", "well", "with", "large", "language", "models", "on", "real-world", "datasets", ".", "Drawing", "on", "insights", "from", "the", "information", "flow", "perspective", ",", "we", "explore", "three", "approaches", "to", "enhance", "ICL's", "effectiveness", ",", "efficiency", ",", "and", "interpretability", ".", "(", "1", ")", "An", "anchor", "re-weighting", "method", "is", "introduced", ",", "which", "employs", "a", "learnable", "vector", "to", "adjust", "the", "significance", "of", "different", "label", "words", "in", "demonstrations", ",", "leading", "to", "a", "16.7%", "average", "accuracy", "boost", "compared", "to", "standard", "ICL", "baselines", ".", "(", "2", ")", "For", "quicker", "ICL", "inference", ",", "inputs", "are", "compressed", "into", "pre-calculated", "anchor", "representations", "since", "model", "predictions", "primarily", "rely", "on", "label", "word", "activations", ".", "Testing", "shows", "a", "1.8", "\u00d7", "speedup", "in", "inference", "with", "only", "a", "minimal", "performance", "trade-off", ".", "(", "3", ")", "An", "error", "analysis", "of", "ICL", "on", "GPT2", "-", "XL", "demonstrates", "that", "the", "label", "confusion", "matrix", "aligns", "closely", "with", "the", "distance", "distribution", "of", "anchor", "key", "vectors", ",", "implying", "that", "errors", "might", "result", "from", "similar", "anchor", "representations", ".", "These", "promising", "applications", "further", "validate", "our", "hypothesis", "and", "shed", "light", "on", "future", "ICL", "studies", "for", "better", "transparency", "of", "LLMs", ".", "H", "2", ":", "In", "deep", "layers", ",", "the", "model", "makes", "predictions", "by", "extracting", "information", "from", "label", "words", ".", "This", "section", "aims", "to", "discover", "the", "inherent", "patterns", "in", "the", "attention", "interaction", "between", "tokens", "for", "a", "GPT", "model", ".", "Following", "common", "practice", ",", "we", "use", "the", "Taylor", "expansion", "(", "Michel", "et", "al", ".", ",", "2019", ")", "to", "calculate", "the", "saliency", "score", "for", "each", "element", "of", "the", "attention", "matrix", ":", "EQUATION", "Here", ",", "A", "h", ",", "l", "is", "the", "value", "of", "the", "attention", "matrix", "of", "the", "h-th", "attention", "head", "in", "the", "l-th", "layer", ",", "x", "is", "the", "input", ",", "and", "L", "(", "x", ")", "is", "the", "loss", "function", "of", "the", "task", ",", "e.g", ".", ",", "the", "cross-entropy", "objective", "for", "a", "classification", "problem", ".", "We", "average", "all", "attention", "heads", "to", "obtain", "the", "saliency", "matrix", "I", "l", "for", "the", "l-th", "layer", ".", "I", "l", "(", "i", ",", "j", ")", "represents", "the", "significance", "of", "the", "information", "flow", "from", "the", "j-th", "word", "to", "the", "i-th", "word", "for", "ICL", ".", "By", "observing", "I", "l", ",", "we", "can", "get", "an", "intuitive", "impression", "that", "as", "the", "layer", "goes", "deeper", ",", "demonstration", "label", "words", "will", "become", "more", "dominant", "for", "the", "prediction", ",", "as", "depicted", "in", "Figure", "1", ".", "A", "high", "S", "pq", "demonstrates", "a", "strong", "information", "extraction", "from", "label", "words", "for", "final", "decision-making", ".", "Experimental", "Settings", "We", "choose", "GPT2", "-", "XL", "from", "the", "GPT", "series", "(", "Radford", "et", "al", ".", ",", "2019", ")", "as", "our", "primary", "model", "for", "investigation", ",", "due", "to", "its", "moderate", "model", "size", "(", "of", "1.5B", "parameters", ")", "that", "is", "suitable", "for", "our", "hardware", "resource", "and", "its", "decent", "ICL", "performance", "(", "Dai", "et", "al", ".", ",", "2022", ")", ".", "For", "datasets", ",", "we", "use", "Stanford", "Sentiment", "Treebank", "Binary", "(", "SST", "-", "2", ")", "(", "Socher", "et", "al", ".", ",", "2013", ")", "for", "sentiment", "analysis", ",", "Text", "REtrieval", "Conference", "Question", "Classification", "(", "TREC", ")", "(", "Li", "and", "Roth", ",", "2002", ";", "Hovy", "et", "al", ".", ",", "2001", ")", "for", "question", "type", "classification", ",", "AG's", "news", "topic", "classification", "dataset", "(", "AGNews", ")", "(", "Zhang", "et", "al", ".", ",", "2015", ")", "for", "topic", "classification", ",", "and", "EmoContext", "(", "EmoC", ")", "(", "Chatterjee", "et", "al", ".", ",", "2019", ")", "Results", "and", "Analysis", "Figure", "3", "reveals", "that", ":", "(", "1", ")", "in", "shallow", "layers", ",", "S", "pq", ",", "the", "significance", "of", "the", "information", "flow", "from", "label", "words", "to", "targeted", "positions", ",", "is", "low", ",", "while", "S", "wp", ",", "the", "information", "flow", "from", "the", "text", "part", "to", "label", "words", "is", "high", ";", "(", "2", ")", "in", "deep", "layers", ",", "S", "pq", ",", "the", "importance", "of", "information", "flow", "from", "label", "words", "to", "the", "targeted", "position", "becomes", "the", "dominant", "one", ".", "Proposed", "Hypothesis", "Based", "on", "this", ",", "we", "propose", "the", "hypothesis", "that", "label", "words", "function", "as", "anchors", "in", "the", "ICL", "information", "flow", ".", "In", "shallow", "layers", ",", "label", "words", "gather", "information", "from", "demonstration", "examples", "to", "form", "semantic", "representations", "for", "deeper", "layers", ",", "while", "in", "deep", "layers", ",", "the", "model", "extracts", "the", "information", "from", "label", "words", "to", "form", "the", "final", "prediction", ".", "We", "assume", "that", "the", "information", "aggregation", "in", "ICL", "relies", "on", "the", "information", "flow", "from", "the", "text", "part", "to", "label", "tokens", ",", "which", "is", "facilitated", "by", "the", "transformer's", "attention", "mechanism", ".", "By", "manipulating", "the", "attention", "layer", "in", "the", "model", "to", "block", "this", "flow", "and", "examining", "the", "model", "behavior", "change", ",", "we", "validate", "the", "existence", "of", "the", "information", "aggregation", "process", "and", "its", "contribution", "to", "the", "final", "prediction", ".", "To", "further", "validate", "our", "findings", "on", "larger", "models", ",", "we", "incorporate", "GPT-J", "(", "6B", ")", "(", "Wang", "and", "Komatsuzaki", ",", "2021", ")", "in", "experiments", ",", "which", "exceeds", "GPT2", "-", "XL", "in", "model", "size", "and", "capacity", ".", "Metrics", "We", "use", "the", "following", "metrics", "to", "assess", "the", "impact", "of", "blocking", "information", "flow", "from", "the", "text", "part", "to", "label", "tokens", ":", "(", "1", ")", "Label", "Loyalty", ":", "measures", "the", "consistency", "of", "output", "labels", "with", "and", "without", "isolation", ".", "(", "2", ")", "Word", "Loyalty", ":", "employs", "the", "Jaccard", "similarity", "to", "compare", "the", "top", "-", "5", "predicted", "words", "with", "and", "without", "isolation", ",", "capturing", "more", "subtle", "model", "output", "alterations", "(", "See", "Appendix", "C", "for", "details", ")", ".", "Low", "loyalty", "indicates", "a", "profound", "impact", "of", "isolation", "on", "model", "predictions", ".", "Moreover", ",", "similar", "results", "were", "obtained", "when", "testing", "ICL", "with", "semantically", "unrelated", "labels", "(", "refer", "to", "Appendix", "F", ".2", ")", ".", "Figures", "5a", "and", "5b", "delineate", "correlation", "metrics", "for", "GPT2", "-", "XL", "and", "GPT-J", ",", "averaged", "across", "four", "datasets", ".", "The", "AUCROC", "l", "for", "deep", "layers", "approaches", "0.8", ",", "illustrating", "a", "strong", "correlation", "between", "the", "attention", "distributions", "on", "label", "words", "of", "the", "target", "position", "and", "the", "model's", "final", "prediction", ".", "Moreover", ",", "shallow", "layers", "show", "negligible", "cumulative", "contributions", "(", "R", "l", ")", ",", "with", "a", "significant", "increase", "in", "middle", "and", "deep", "layers", ".", "These", "results", "signify", "the", "crucial", "role", "of", "deep", "layers", "for", "final", "prediction", ",", "validating", "that", "the", "model", "extracts", "information", "from", "label", "words", "in", "deep", "layers", "to", "form", "the", "final", "prediction", ".", "In", "\u00a7", "2.3", ",", "we", "verify", "that", "the", "aforementioned", "aggregated", "information", "on", "label", "words", "is", "then", "extracted", "to", "form", "the", "final", "prediction", "in", "the", "deep", "layers", ".", "Given", "the", "considerable", "role", "these", "\"", "anchors", "\"", "fulfill", ",", "we", "find", "it", "intuitive", "to", "design", "ICL", "improvements", "based", "on", "them", ",", "as", "elaborated", "in", "\u00a7", "3", ".", "With", "insights", "from", "the", "validated", "hypothesis", ",", "we", "propose", "strategies", "to", "boost", "ICL's", "accuracy", "and", "inference", "speed", ".", "We", "propose", "an", "anchor", "re-weighting", "method", "in", "\u00a7", "3.1", "to", "adjust", "the", "demonstrations", "'", "contributions", "and", "improve", "accuracy", ".", "In", "\u00a7", "3.2", ",", "we", "explore", "a", "context", "compression", "technique", "that", "reduces", "original", "demonstrations", "to", "anchor", "hidden", "states", "to", "speed", "up", "ICL", "inference", ".", "Besides", ",", "in", "\u00a7", "3.3", ",", "we", "utilize", "anchor", "distances", "to", "perform", "an", "analysis", "to", "understand", "the", "errors", "ICL", "made", "in", "real-world", "scenarios", ".", "These", "approaches", "corroborate", "our", "hypothesis", ",", "pointing", "to", "potential", "paths", "for", "future", "ICL", "enhancements", ".", "Based", "on", "our", "analysis", "in", "\u00a7", "2", ",", "we", "draw", "parallels", "between", "ICL", "and", "logistic", "regression", "and", "propose", "an", "approach", "to", "improve", "ICL's", "accuracy", "by", "reweighting", "label", "anchors", ".", "3.1.1", "Method", "\u00a7", "2.3", "illustrates", "a", "strong", "correlation", "between", "the", "model's", "output", "category", "and", "the", "attention", "distribution", "(", "A", "(", "q", ",", "p", "1", ")", ",", ".", ".", ".", ",", "A", "(", "q", ",", "p", "C", ")", ")", "on", "label", "words", "p", "1", ",", ".", ".", ".", ",", "p", "C", "of", "the", "target", "position", "q", "in", "deep", "layers", ".", "Inspired", "by", "the", "similarity", "between", "ICL", "and", "logistic", "regression", ",", "we've", "incorporated", "a", "learnable", "\u03b2", "i", "0", "into", "Eq", ".", "(", "7", ")", ",", "which", "is", "equivalent", "to", "adjusting", "the", "attention", "weights", "A", "(", "q", ",", "p", "i", ")", ":", "EQUATION", "Each", "\u03b2", "i", "0", "is", "a", "learnable", "parameter", ",", "set", "uniquely", "for", "different", "attention", "heads", "and", "layers", ".", "Owing", "to", "computational", "constraints", ",", "we", "employ", "GPT2", "-", "XL", "for", "evaluation", ",", "excluding", "GPT-J", ".", "We", "compare", "Anchoring", "Re-weighting", "with", "two", "baselines", ":", "(", "1", ")", "Vanilla", "ICL", "with", "the", "same", "demonstration", "(", "1", "-", "shot", "per", "class", ")", "(", "2", ")", "Vanilla", "ICL", ",", "where", "the", "auxiliary", "training", "set", "of", "\u03b2", "is", "included", "as", "demonstrations", "(", "5", "-", "shot", "per", "class", ")", "for", "a", "fair", "comparison", ".", "As", "Table", "1", "shows", ",", "the", "proposed", "anchor", "reweighting", "significantly", "enhances", "ICL", "performance", ",", "particularly", "on", "the", "SST", "-", "2", "and", "EmoC", "datasets", ".", "Besides", ",", "adding", "more", "demonstrations", "for", "vanilla", "ICL", "may", "not", "bring", "a", "stable", "accuracy", "boost", "due", "to", "the", "potential", "noise", "introduced", ",", "as", "discussed", "in", "Zhao", "et", "al", ".", "(", "2021", ")", ".", "Different", "from", "vanilla", "ICL", "which", "utilizes", "the", "extra", "examples", "to", "form", "a", "demonstration", ",", "we", "train", "a", "re-weighting", "vector", "\u03b2", "to", "modulate", "label", "anchor", "contributions", ".", "The", "consistent", "improvements", "of", "our", "method", "suggest", "that", "the", "re-weighting", "mechanism", "could", "be", "a", "better", "alternative", "to", "utilize", "demonstration", "examples", ".", "Furthermore", ",", "it", "reiterates", "the", "crucial", "role", "that", "anchors", "play", "in", "ICL", ".", "We", "further", "explore", "a", "context", "compression", "technique", "that", "reduces", "the", "full", "demonstration", "to", "anchor", "hidden", "states", "for", "accelerating", "ICL", "inference", ".", "For", "AGNews", ",", "due", "to", "the", "length", "limit", ",", "we", "only", "use", "three", "demonstrations", "per", "class", ".", "Our", "Anchor", "Re-weighting", "method", "achieves", "the", "best", "performance", "overall", "tasks", ".", "from", "the", "demonstrations", ".", "Given", "the", "auto-regressive", "nature", "of", "GPT-like", "models", ",", "where", "hidden", "states", "of", "tokens", "depend", "solely", "on", "preceding", "ones", ",", "label", "words", "'", "information", "aggregation", "process", "is", "independent", "of", "subsequent", "words", ".", "In", "our", "preliminary", "experiments", ",", "concatenating", "hidden", "states", "of", "label", "words", "alone", "was", "inadequate", "for", "completing", "the", "ICL", "task", ".", "5", "This", "might", "be", "due", "to", "the", "critical", "role", "of", "formatting", "information", "in", "helping", "the", "model", "to", "determine", "the", "output", "space", "at", "the", "target", "position", ",", "6", "as", "highlighted", "in", "Min", "et", "al", ".", "(", "2022b", ")", ".", "As", "a", "solution", ",", "we", "amalgamate", "the", "hidden", "states", "of", "both", "the", "formatting", "and", "the", "label", "words", ",", "a", "method", "we've", "termed", "Hidden", "anchor", ".", "We", "compare", "our", "Hidden", "anchor", "input", "compression", "method", "with", "two", "equally", "efficient", "baselines", ".", "Text", "anchor", ":", "This", "method", "concatenates", "the", "formatting", "and", "label", "text", "with", "the", "input", ",", "as", "opposed", "to", "concatenating", "the", "hidden", "states", "at", "each", "layer", ".", "Hidden", "random", ":", "This", "approach", "concatenates", "the", "hidden", "states", "of", "formatting", "and", "randomly", "selected", "nonlabel", "words", "(", "equal", "in", "number", "to", "Hidden", "anchor", ")", ".", "Hidden", "random-top", ":", "To", "establish", "a", "stronger", "baseline", ",", "we", "randomly", "select", "20", "sets", "of", "non-label", "words", "in", "Hidden", "random", "and", "report", "the", "one", "with", "the", "highest", "label", "loyalty", ".", "The", "Text", "anchor", "method", "is", "included", "to", "demonstrate", "that", "the", "effectiveness", "of", "Hidden", "anchor", "is", "attributed", "to", "the", "aggregation", "of", "information", "in", "label", "words", ",", "rather", "than", "the", "mere", "text", "of", "label", "words", ".", "If", "we", "find", "that", "Hidden", "anchor", "surpasses", "Text", "anchor", "in", "performance", ",", "it", "solidifies", "the", "notion", "that", "the", "aggregated", "information", "within", "label", "words", "carries", "significant", "importance", ".", "The", "Hidden", "random", "method", "is", "introduced", "to", "illustrate", "that", "anchor", "hidden", "states", "encapsulate", "most", "of", "the", "demonstration", "information", "among", "all", "hidden", "states", ".", "We", "can", "see", "from", "Table", "2", "that", "the", "proposed", "compression", "method", "Hidden", "anchor", "achieves", "the", "best", "results", "among", "all", "three", "compression", "methods", "on", "all", "metrics", "and", "for", "both", "models", ".", "For", "example", ",", "with", "the", "GPT-J", "model", ",", "the", "compression", "method", "with", "anchor", "states", "only", "leads", "to", "a", "1.5", "accuracy", "drop", "compared", "to", "the", "uncompressed", "situation", ",", "indicating", "that", "the", "compression", "introduces", "negligible", "information", "loss", ".", "Further", ",", "we", "estimate", "the", "efficiency", "improvements", "over", "the", "original", "ICL", ".", "Besides", ",", "we", "observe", "that", "the", "acceleration", "effect", "is", "more", "pronounced", "in", "the", "GPT-J", "model", "compared", "to", "GPT2", "-", "XL", ",", "demonstrating", "its", "great", "potential", "to", "apply", "to", "larger", "language", "models", ".", "Lastly", ",", "we", "perform", "an", "error", "analysis", "for", "ICL", "by", "examining", "the", "distances", "between", "the", "key", "vectors", "in", "the", "attention", "module", "that", "correspond", "to", "the", "label", "words", ".", "Furthermore", ",", "considering", "the", "distribution", "of", "query", "vectors", "q", "q", ",", "we", "employ", "a", "PCA-like", "method", "to", "extract", "the", "components", "of", "the", "key", "vectors", "along", "the", "directions", "with", "significant", "variations", "in", "q", "q", ",", "denoted", "as", "k", "(", "see", "Appendix", "J", "for", "details", ")", ".", "We", "anticipate", "that", "the", "distances", "between", "these", "ks", "can", "correspond", "to", "the", "category", "confusion", "of", "the", "model", ",", "thus", "revealing", "one", "possible", "origin", "of", "ICL", "errors", ".", "Here", ",", "we", "normalize", "the", "distances", "to", "a", "scale", "of", "0", "-", "1", ",", "with", "0", "indicating", "the", "highest", "degree", "of", "category", "confusion", ":", "EQUATION", "We", "utilize", "the", "GPT2", "-", "XL", "model", "and", "TREC", "dataset", ",", "as", "the", "model", "displays", "varying", "confusion", "levels", "between", "categories", "on", "this", "dataset", ".", "We", "use", "all", "500", "samples", "of", "the", "TREC", "test", "set", "and", "use", "1", "demonstration", "per", "class", "for", "convenience", "of", "analysis", ".", "The", "heatmaps", "display", "similarity", "in", "confusing", "category", "pairs", ",", "particularly", "in", "lighter-colored", "blocks", ".", "This", "high", "correlation", "indicates", "that", "ICL", "makes", "errors", "in", "categories", "with", "similar", "label", "anchors", ".", "The", "existing", "literature", "on", "in-context", "learning", "analysis", "can", "be", "broadly", "divided", "into", "two", "streams", ",", "each", "focusing", "on", "different", "aspects", ".", "The", "first", "stream", "explores", "the", "influencing", "factors", "of", "ICL", "based", "on", "input", "perturbation", ",", "such", "as", "the", "order", "(", "Min", "et", "al", ".", ",", "2022b", ")", ",", "the", "formatting", "(", "Yoo", "et", "al", ".", ",", "2022", ";", "Wei", "et", "al", ".", ",", "2022", ")", ",", "and", "the", "selection", "of", "the", "demonstration", "(", "Liu", "et", "al", ".", ",", "2022", ")", ".", "Designing", "proper", "demonstration", "construc-tion", "strategies", "(", "Ye", "et", "al", ".", ",", "2023", ";", "Li", "et", "al", ".", ",", "2023a", ")", "and", "calibration", "techniques", "(", "Zhao", "et", "al", ".", ",", "2021", ";", "Min", "et", "al", ".", ",", "2022a", ")", "could", "bring", "clear", "boosts", "to", "the", "ICL", "performance", ".", "The", "second", "stream", "investigates", "the", "inner", "working", "mechanism", "of", "ICL", "through", "different", "conceptual", "lenses", ",", "such", "as", "making", "an", "analogy", "of", "ICL", "to", "gradient", "descent", "(", "von", "Oswald", "et", "al", ".", ",", "2022", ";", "Dai", "et", "al", ".", ",", "2022", ")", "and", "viewing", "the", "process", "of", "ICL", "as", "a", "Bayesian", "inference", "(", "Xie", "et", "al", ".", ",", "2022", ")", ".", "In", "this", "paper", ",", "we", "provide", "a", "novel", "perspective", "by", "examining", "the", "information", "flow", "in", "language", "models", "to", "gain", "an", "understanding", "of", "ICL", ".", "Our", "approach", "offers", "new", "insights", "and", "demonstrates", "the", "potential", "for", "leveraging", "this", "understanding", "to", "improve", "the", "effectiveness", ",", "efficiency", ",", "and", "interpretability", "of", "ICL", ".", "In", "this", "paper", ",", "we", "propose", "a", "hypothesis", "that", "label", "words", "serve", "as", "anchors", "in", "in-context", "learning", "for", "aggregating", "and", "distributing", "the", "task-relevant", "information", "flow", ".", "Experimental", "results", "with", "attention", "manipulation", "and", "analysis", "of", "predictions", "correlation", "consolidate", "the", "hypothesis", "holds", "well", "in", "GPT2", "-", "XL", "and", "GPT-J", "models", ".", "First", ",", "an", "anchor", "re-weighting", "method", "is", "proposed", "to", "improve", "ICL", "accuracy", ".", "Second", ",", "we", "explore", "a", "demonstration", "compression", "technique", "to", "accelerate", "ICL", "inference", ".", "Lastly", ",", "we", "showcase", "an", "analysis", "framework", "to", "diagnose", "ICL", "errors", "on", "a", "real-world", "dataset", ".", "These", "promising", "applications", "again", "verify", "the", "hypothesis", "and", "open", "up", "new", "directions", "for", "future", "investigations", "on", "ICL", ".", "Our", "study", ",", "while", "providing", "valuable", "insights", "into", "in-context", "learning", "(", "ICL", ")", ",", "has", "several", "limitations", ".", "Additionally", ",", "our", "hypothesis", "was", "only", "examined", "within", "conventional", "ICL", "paradigms", ",", "leaving", "other", "ICL", "paradigms", "such", "as", "the", "chain", "of", "thought", "prompting", "(", "CoT", ")", "(", "Wei", "et", "al", ".", ",", "2022", ")", "unexplored", ".", "For", "models", ",", "we", "use", "GPT2", "-", "XL", "(", "1.5B", ")", "(", "Radford", "et", "al", ".", ",", "2019", ")", "and", "GPT-J", "(", "6B", ")", "(", "Wang", "and", "Komatsuzaki", ",", "2021", ")", "in", "this", "paper", ".", "For", "datasets", ",", "we", "use", "a", "sentiment", "analysis", "task", ",", "Stanford", "Sentiment", "Treebank", "Binary", "(", "SST", "-", "2", ")", "(", "Socher", "et", "al", ".", ",", "2013", ")", ",", "a", "question", "type", "classification", "task", ",", "Text", "REtrieval", "Conference", "Question", "Classification", "(", "TREC", ")", "(", "Li", "and", "Roth", ",", "2002", ";", "Hovy", "et", "al", ".", ",", "2001", ")", ",", "a", "topic", "classification", "task", ",", "AG's", "news", "topic", "classification", "dataset", "(", "AGNews", ")", "(", "Zhang", "et", "al", ".", ",", "2015", ")", ",", "and", "an", "emotion", "classification", "task", ",", "Emo-Context", "(", "EmoC", ")", "(", "Chatterjee", "et", "al", ".", ",", "2019", ")", "."], "sentences": [["Label", "Words", "are", "Anchors", ":", "An", "Information", "Flow", "Perspective", "for", "Understanding", "In-Context", "Learning", "In-context", "learning", "(", "ICL", ")", "emerges", "as", "a", "promising", "capability", "of", "large", "language", "models", "(", "LLMs", ")", "by", "providing", "them", "with", "demonstration", "examples", "to", "perform", "diverse", "tasks", "."], ["However", ",", "the", "underlying", "mechanism", "of", "how", "LLMs", "learn", "from", "the", "provided", "context", "remains", "under-explored", "."], ["In", "this", "paper", ",", "we", "investigate", "the", "working", "mechanism", "of", "ICL", "through", "an", "information", "flow", "lens", "."], ["Our", "findings", "reveal", "that", "label", "words", "in", "the", "demonstration", "examples", "function", "as", "anchors", ":", "In-context", "Learning", "(", "ICL", ")", "has", "emerged", "as", "a", "powerful", "capability", "alongside", "the", "development", "of", "scaledup", "large", "language", "models", "(", "LLMs", ")", "(", "Brown", "et", "al", ".", ",", "2020", ")", "."], ["By", "instructing", "LLMs", "using", "few-shot", "demonstration", "examples", ",", "ICL", "enables", "them", "to", "perform", "a", "wide", "range", "of", "tasks", ",", "such", "as", "text", "classification", "(", "Min", "et", "al", ".", ",", "2022a", ")", "and", "mathematical", "reasoning", "(", "Wei", "et", "al", ".", ",", "2022", ")", "."], ["Despite", "its", "significance", ",", "the", "inner", "working", "mechanism", "of", "ICL", "remains", "an", "open", "question", ",", "garnering", "considerable", "interest", "from", "research", "communities", "(", "Xie", "et", "al", ".", ",", "2022", ";", "Dai", "et", "al", ".", ",", "2022", ";", "Aky\u00fcrek", "et", "al", ".", ",", "2022", ";", "Li", "et", "al", ".", ",", "2023b", ")", "."], ["In", "this", "paper", ",", "we", "find", "that", "the", "label", "words", "serve", "as", "anchors", "that", "aggregate", "and", "distribute", "information", "in", "ICL", "."], ["We", "first", "visualize", "the", "attention", "interactive", "pattern", "between", "tokens", "with", "a", "GPT", "model", "(", "Brown", "et", "al", ".", ",", "2020", ")", "on", "sentiment", "analysis", "(", "Figure", "1", ")", "."], ["H", "2", ":", "In", "deep", "layers", ",", "the", "model", "extracts", "the", "information", "from", "label", "words", "to", "form", "the", "final", "prediction", "."], ["Two", "experiments", "are", "designed", "to", "validate", "the", "hypothesis", "using", "GPT2", "-", "XL", "(", "Radford", "et", "al", ".", ",", "2019", ")", "and", "GPT-J", "(", "Wang", "and", "Komatsuzaki", ",", "2021", ")", "across", "several", "text", "classification", "benchmarks", ".", "(", "1", ")", "By", "blocking", "the", "information", "aggregation", "path", "to", "label", "words", "in", "certain", "layers", ",", "we", "find", "that", "such", "isolation", "in", "shallow", "layers", "significantly", "impairs", "model", "performance", "."], ["This", "indicates", "that", "label", "words", "collect", "useful", "information", "during", "forward", "propagation", "in", "shallow", "layers", ".", "(", "2", ")", "We", "investigate", "the", "relationship", "between", "the", "attention", "distributions", "on", "the", "label", "words", "of", "the", "target", "position", "and", "the", "model's", "final", "prediction", "."], ["In", "summary", ",", "these", "experimental", "findings", "suggest", "that", "our", "hypothesis", "holds", "well", "with", "large", "language", "models", "on", "real-world", "datasets", "."], ["Drawing", "on", "insights", "from", "the", "information", "flow", "perspective", ",", "we", "explore", "three", "approaches", "to", "enhance", "ICL's", "effectiveness", ",", "efficiency", ",", "and", "interpretability", ".", "(", "1", ")", "An", "anchor", "re-weighting", "method", "is", "introduced", ",", "which", "employs", "a", "learnable", "vector", "to", "adjust", "the", "significance", "of", "different", "label", "words", "in", "demonstrations", ",", "leading", "to", "a", "16.7%", "average", "accuracy", "boost", "compared", "to", "standard", "ICL", "baselines", ".", "(", "2", ")", "For", "quicker", "ICL", "inference", ",", "inputs", "are", "compressed", "into", "pre-calculated", "anchor", "representations", "since", "model", "predictions", "primarily", "rely", "on", "label", "word", "activations", "."], ["Testing", "shows", "a", "1.8", "\u00d7", "speedup", "in", "inference", "with", "only", "a", "minimal", "performance", "trade-off", ".", "(", "3", ")", "An", "error", "analysis", "of", "ICL", "on", "GPT2", "-", "XL", "demonstrates", "that", "the", "label", "confusion", "matrix", "aligns", "closely", "with", "the", "distance", "distribution", "of", "anchor", "key", "vectors", ",", "implying", "that", "errors", "might", "result", "from", "similar", "anchor", "representations", "."], ["These", "promising", "applications", "further", "validate", "our", "hypothesis", "and", "shed", "light", "on", "future", "ICL", "studies", "for", "better", "transparency", "of", "LLMs", "."], ["H", "2", ":", "In", "deep", "layers", ",", "the", "model", "makes", "predictions", "by", "extracting", "information", "from", "label", "words", "."], ["This", "section", "aims", "to", "discover", "the", "inherent", "patterns", "in", "the", "attention", "interaction", "between", "tokens", "for", "a", "GPT", "model", "."], ["Following", "common", "practice", ",", "we", "use", "the", "Taylor", "expansion", "(", "Michel", "et", "al", ".", ",", "2019", ")", "to", "calculate", "the", "saliency", "score", "for", "each", "element", "of", "the", "attention", "matrix", ":", "EQUATION", "Here", ",", "A", "h", ",", "l", "is", "the", "value", "of", "the", "attention", "matrix", "of", "the", "h-th", "attention", "head", "in", "the", "l-th", "layer", ",", "x", "is", "the", "input", ",", "and", "L", "(", "x", ")", "is", "the", "loss", "function", "of", "the", "task", ",", "e.g", ".", ",", "the", "cross-entropy", "objective", "for", "a", "classification", "problem", "."], ["We", "average", "all", "attention", "heads", "to", "obtain", "the", "saliency", "matrix", "I", "l", "for", "the", "l-th", "layer", "."], ["I", "l", "(", "i", ",", "j", ")", "represents", "the", "significance", "of", "the", "information", "flow", "from", "the", "j-th", "word", "to", "the", "i-th", "word", "for", "ICL", "."], ["By", "observing", "I", "l", ",", "we", "can", "get", "an", "intuitive", "impression", "that", "as", "the", "layer", "goes", "deeper", ",", "demonstration", "label", "words", "will", "become", "more", "dominant", "for", "the", "prediction", ",", "as", "depicted", "in", "Figure", "1", "."], ["A", "high", "S", "pq", "demonstrates", "a", "strong", "information", "extraction", "from", "label", "words", "for", "final", "decision-making", "."], ["Experimental", "Settings", "We", "choose", "GPT2", "-", "XL", "from", "the", "GPT", "series", "(", "Radford", "et", "al", ".", ",", "2019", ")", "as", "our", "primary", "model", "for", "investigation", ",", "due", "to", "its", "moderate", "model", "size", "(", "of", "1.5B", "parameters", ")", "that", "is", "suitable", "for", "our", "hardware", "resource", "and", "its", "decent", "ICL", "performance", "(", "Dai", "et", "al", ".", ",", "2022", ")", "."], ["For", "datasets", ",", "we", "use", "Stanford", "Sentiment", "Treebank", "Binary", "(", "SST", "-", "2", ")", "(", "Socher", "et", "al", ".", ",", "2013", ")", "for", "sentiment", "analysis", ",", "Text", "REtrieval", "Conference", "Question", "Classification", "(", "TREC", ")", "(", "Li", "and", "Roth", ",", "2002", ";", "Hovy", "et", "al", ".", ",", "2001", ")", "for", "question", "type", "classification", ",", "AG's", "news", "topic", "classification", "dataset", "(", "AGNews", ")", "(", "Zhang", "et", "al", ".", ",", "2015", ")", "for", "topic", "classification", ",", "and", "EmoContext", "(", "EmoC", ")", "(", "Chatterjee", "et", "al", ".", ",", "2019", ")", "Results", "and", "Analysis", "Figure", "3", "reveals", "that", ":", "(", "1", ")", "in", "shallow", "layers", ",", "S", "pq", ",", "the", "significance", "of", "the", "information", "flow", "from", "label", "words", "to", "targeted", "positions", ",", "is", "low", ",", "while", "S", "wp", ",", "the", "information", "flow", "from", "the", "text", "part", "to", "label", "words", "is", "high", ";", "(", "2", ")", "in", "deep", "layers", ",", "S", "pq", ",", "the", "importance", "of", "information", "flow", "from", "label", "words", "to", "the", "targeted", "position", "becomes", "the", "dominant", "one", "."], ["Proposed", "Hypothesis", "Based", "on", "this", ",", "we", "propose", "the", "hypothesis", "that", "label", "words", "function", "as", "anchors", "in", "the", "ICL", "information", "flow", "."], ["In", "shallow", "layers", ",", "label", "words", "gather", "information", "from", "demonstration", "examples", "to", "form", "semantic", "representations", "for", "deeper", "layers", ",", "while", "in", "deep", "layers", ",", "the", "model", "extracts", "the", "information", "from", "label", "words", "to", "form", "the", "final", "prediction", "."], ["We", "assume", "that", "the", "information", "aggregation", "in", "ICL", "relies", "on", "the", "information", "flow", "from", "the", "text", "part", "to", "label", "tokens", ",", "which", "is", "facilitated", "by", "the", "transformer's", "attention", "mechanism", "."], ["By", "manipulating", "the", "attention", "layer", "in", "the", "model", "to", "block", "this", "flow", "and", "examining", "the", "model", "behavior", "change", ",", "we", "validate", "the", "existence", "of", "the", "information", "aggregation", "process", "and", "its", "contribution", "to", "the", "final", "prediction", "."], ["To", "further", "validate", "our", "findings", "on", "larger", "models", ",", "we", "incorporate", "GPT-J", "(", "6B", ")", "(", "Wang", "and", "Komatsuzaki", ",", "2021", ")", "in", "experiments", ",", "which", "exceeds", "GPT2", "-", "XL", "in", "model", "size", "and", "capacity", "."], ["Metrics", "We", "use", "the", "following", "metrics", "to", "assess", "the", "impact", "of", "blocking", "information", "flow", "from", "the", "text", "part", "to", "label", "tokens", ":", "(", "1", ")", "Label", "Loyalty", ":", "measures", "the", "consistency", "of", "output", "labels", "with", "and", "without", "isolation", ".", "(", "2", ")", "Word", "Loyalty", ":", "employs", "the", "Jaccard", "similarity", "to", "compare", "the", "top", "-", "5", "predicted", "words", "with", "and", "without", "isolation", ",", "capturing", "more", "subtle", "model", "output", "alterations", "(", "See", "Appendix", "C", "for", "details", ")", "."], ["Low", "loyalty", "indicates", "a", "profound", "impact", "of", "isolation", "on", "model", "predictions", "."], ["Moreover", ",", "similar", "results", "were", "obtained", "when", "testing", "ICL", "with", "semantically", "unrelated", "labels", "(", "refer", "to", "Appendix", "F", ".2", ")", "."], ["Figures", "5a", "and", "5b", "delineate", "correlation", "metrics", "for", "GPT2", "-", "XL", "and", "GPT-J", ",", "averaged", "across", "four", "datasets", "."], ["The", "AUCROC", "l", "for", "deep", "layers", "approaches", "0.8", ",", "illustrating", "a", "strong", "correlation", "between", "the", "attention", "distributions", "on", "label", "words", "of", "the", "target", "position", "and", "the", "model's", "final", "prediction", "."], ["Moreover", ",", "shallow", "layers", "show", "negligible", "cumulative", "contributions", "(", "R", "l", ")", ",", "with", "a", "significant", "increase", "in", "middle", "and", "deep", "layers", "."], ["These", "results", "signify", "the", "crucial", "role", "of", "deep", "layers", "for", "final", "prediction", ",", "validating", "that", "the", "model", "extracts", "information", "from", "label", "words", "in", "deep", "layers", "to", "form", "the", "final", "prediction", "."], ["In", "\u00a7", "2.3", ",", "we", "verify", "that", "the", "aforementioned", "aggregated", "information", "on", "label", "words", "is", "then", "extracted", "to", "form", "the", "final", "prediction", "in", "the", "deep", "layers", "."], ["Given", "the", "considerable", "role", "these", "\"", "anchors", "\"", "fulfill", ",", "we", "find", "it", "intuitive", "to", "design", "ICL", "improvements", "based", "on", "them", ",", "as", "elaborated", "in", "\u00a7", "3", "."], ["With", "insights", "from", "the", "validated", "hypothesis", ",", "we", "propose", "strategies", "to", "boost", "ICL's", "accuracy", "and", "inference", "speed", "."], ["We", "propose", "an", "anchor", "re-weighting", "method", "in", "\u00a7", "3.1", "to", "adjust", "the", "demonstrations", "'", "contributions", "and", "improve", "accuracy", "."], ["In", "\u00a7", "3.2", ",", "we", "explore", "a", "context", "compression", "technique", "that", "reduces", "original", "demonstrations", "to", "anchor", "hidden", "states", "to", "speed", "up", "ICL", "inference", "."], ["Besides", ",", "in", "\u00a7", "3.3", ",", "we", "utilize", "anchor", "distances", "to", "perform", "an", "analysis", "to", "understand", "the", "errors", "ICL", "made", "in", "real-world", "scenarios", "."], ["These", "approaches", "corroborate", "our", "hypothesis", ",", "pointing", "to", "potential", "paths", "for", "future", "ICL", "enhancements", "."], ["Based", "on", "our", "analysis", "in", "\u00a7", "2", ",", "we", "draw", "parallels", "between", "ICL", "and", "logistic", "regression", "and", "propose", "an", "approach", "to", "improve", "ICL's", "accuracy", "by", "reweighting", "label", "anchors", ".", "3.1.1", "Method", "\u00a7", "2.3", "illustrates", "a", "strong", "correlation", "between", "the", "model's", "output", "category", "and", "the", "attention", "distribution", "(", "A", "(", "q", ",", "p", "1", ")", ",", ".", ".", ".", ",", "A", "(", "q", ",", "p", "C", ")", ")", "on", "label", "words", "p", "1", ",", ".", ".", ".", ",", "p", "C", "of", "the", "target", "position", "q", "in", "deep", "layers", "."], ["Inspired", "by", "the", "similarity", "between", "ICL", "and", "logistic", "regression", ",", "we've", "incorporated", "a", "learnable", "\u03b2", "i", "0", "into", "Eq", ".", "(", "7", ")", ",", "which", "is", "equivalent", "to", "adjusting", "the", "attention", "weights", "A", "(", "q", ",", "p", "i", ")", ":", "EQUATION", "Each", "\u03b2", "i", "0", "is", "a", "learnable", "parameter", ",", "set", "uniquely", "for", "different", "attention", "heads", "and", "layers", "."], ["Owing", "to", "computational", "constraints", ",", "we", "employ", "GPT2", "-", "XL", "for", "evaluation", ",", "excluding", "GPT-J", "."], ["We", "compare", "Anchoring", "Re-weighting", "with", "two", "baselines", ":", "(", "1", ")", "Vanilla", "ICL", "with", "the", "same", "demonstration", "(", "1", "-", "shot", "per", "class", ")", "(", "2", ")", "Vanilla", "ICL", ",", "where", "the", "auxiliary", "training", "set", "of", "\u03b2", "is", "included", "as", "demonstrations", "(", "5", "-", "shot", "per", "class", ")", "for", "a", "fair", "comparison", "."], ["As", "Table", "1", "shows", ",", "the", "proposed", "anchor", "reweighting", "significantly", "enhances", "ICL", "performance", ",", "particularly", "on", "the", "SST", "-", "2", "and", "EmoC", "datasets", "."], ["Besides", ",", "adding", "more", "demonstrations", "for", "vanilla", "ICL", "may", "not", "bring", "a", "stable", "accuracy", "boost", "due", "to", "the", "potential", "noise", "introduced", ",", "as", "discussed", "in", "Zhao", "et", "al", ".", "(", "2021", ")", "."], ["Different", "from", "vanilla", "ICL", "which", "utilizes", "the", "extra", "examples", "to", "form", "a", "demonstration", ",", "we", "train", "a", "re-weighting", "vector", "\u03b2", "to", "modulate", "label", "anchor", "contributions", "."], ["The", "consistent", "improvements", "of", "our", "method", "suggest", "that", "the", "re-weighting", "mechanism", "could", "be", "a", "better", "alternative", "to", "utilize", "demonstration", "examples", "."], ["Furthermore", ",", "it", "reiterates", "the", "crucial", "role", "that", "anchors", "play", "in", "ICL", "."], ["We", "further", "explore", "a", "context", "compression", "technique", "that", "reduces", "the", "full", "demonstration", "to", "anchor", "hidden", "states", "for", "accelerating", "ICL", "inference", "."], ["For", "AGNews", ",", "due", "to", "the", "length", "limit", ",", "we", "only", "use", "three", "demonstrations", "per", "class", "."], ["Our", "Anchor", "Re-weighting", "method", "achieves", "the", "best", "performance", "overall", "tasks", ".", "from", "the", "demonstrations", "."], ["Given", "the", "auto-regressive", "nature", "of", "GPT-like", "models", ",", "where", "hidden", "states", "of", "tokens", "depend", "solely", "on", "preceding", "ones", ",", "label", "words", "'", "information", "aggregation", "process", "is", "independent", "of", "subsequent", "words", "."], ["In", "our", "preliminary", "experiments", ",", "concatenating", "hidden", "states", "of", "label", "words", "alone", "was", "inadequate", "for", "completing", "the", "ICL", "task", ".", "5", "This", "might", "be", "due", "to", "the", "critical", "role", "of", "formatting", "information", "in", "helping", "the", "model", "to", "determine", "the", "output", "space", "at", "the", "target", "position", ",", "6", "as", "highlighted", "in", "Min", "et", "al", ".", "(", "2022b", ")", "."], ["As", "a", "solution", ",", "we", "amalgamate", "the", "hidden", "states", "of", "both", "the", "formatting", "and", "the", "label", "words", ",", "a", "method", "we've", "termed", "Hidden", "anchor", "."], ["We", "compare", "our", "Hidden", "anchor", "input", "compression", "method", "with", "two", "equally", "efficient", "baselines", "."], ["Text", "anchor", ":", "This", "method", "concatenates", "the", "formatting", "and", "label", "text", "with", "the", "input", ",", "as", "opposed", "to", "concatenating", "the", "hidden", "states", "at", "each", "layer", "."], ["Hidden", "random", ":", "This", "approach", "concatenates", "the", "hidden", "states", "of", "formatting", "and", "randomly", "selected", "nonlabel", "words", "(", "equal", "in", "number", "to", "Hidden", "anchor", ")", "."], ["Hidden", "random-top", ":", "To", "establish", "a", "stronger", "baseline", ",", "we", "randomly", "select", "20", "sets", "of", "non-label", "words", "in", "Hidden", "random", "and", "report", "the", "one", "with", "the", "highest", "label", "loyalty", "."], ["The", "Text", "anchor", "method", "is", "included", "to", "demonstrate", "that", "the", "effectiveness", "of", "Hidden", "anchor", "is", "attributed", "to", "the", "aggregation", "of", "information", "in", "label", "words", ",", "rather", "than", "the", "mere", "text", "of", "label", "words", "."], ["If", "we", "find", "that", "Hidden", "anchor", "surpasses", "Text", "anchor", "in", "performance", ",", "it", "solidifies", "the", "notion", "that", "the", "aggregated", "information", "within", "label", "words", "carries", "significant", "importance", "."], ["The", "Hidden", "random", "method", "is", "introduced", "to", "illustrate", "that", "anchor", "hidden", "states", "encapsulate", "most", "of", "the", "demonstration", "information", "among", "all", "hidden", "states", "."], ["We", "can", "see", "from", "Table", "2", "that", "the", "proposed", "compression", "method", "Hidden", "anchor", "achieves", "the", "best", "results", "among", "all", "three", "compression", "methods", "on", "all", "metrics", "and", "for", "both", "models", "."], ["For", "example", ",", "with", "the", "GPT-J", "model", ",", "the", "compression", "method", "with", "anchor", "states", "only", "leads", "to", "a", "1.5", "accuracy", "drop", "compared", "to", "the", "uncompressed", "situation", ",", "indicating", "that", "the", "compression", "introduces", "negligible", "information", "loss", "."], ["Further", ",", "we", "estimate", "the", "efficiency", "improvements", "over", "the", "original", "ICL", "."], ["Besides", ",", "we", "observe", "that", "the", "acceleration", "effect", "is", "more", "pronounced", "in", "the", "GPT-J", "model", "compared", "to", "GPT2", "-", "XL", ",", "demonstrating", "its", "great", "potential", "to", "apply", "to", "larger", "language", "models", "."], ["Lastly", ",", "we", "perform", "an", "error", "analysis", "for", "ICL", "by", "examining", "the", "distances", "between", "the", "key", "vectors", "in", "the", "attention", "module", "that", "correspond", "to", "the", "label", "words", "."], ["Furthermore", ",", "considering", "the", "distribution", "of", "query", "vectors", "q", "q", ",", "we", "employ", "a", "PCA-like", "method", "to", "extract", "the", "components", "of", "the", "key", "vectors", "along", "the", "directions", "with", "significant", "variations", "in", "q", "q", ",", "denoted", "as", "k", "(", "see", "Appendix", "J", "for", "details", ")", "."], ["We", "anticipate", "that", "the", "distances", "between", "these", "ks", "can", "correspond", "to", "the", "category", "confusion", "of", "the", "model", ",", "thus", "revealing", "one", "possible", "origin", "of", "ICL", "errors", "."], ["Here", ",", "we", "normalize", "the", "distances", "to", "a", "scale", "of", "0", "-", "1", ",", "with", "0", "indicating", "the", "highest", "degree", "of", "category", "confusion", ":", "EQUATION", "We", "utilize", "the", "GPT2", "-", "XL", "model", "and", "TREC", "dataset", ",", "as", "the", "model", "displays", "varying", "confusion", "levels", "between", "categories", "on", "this", "dataset", "."], ["We", "use", "all", "500", "samples", "of", "the", "TREC", "test", "set", "and", "use", "1", "demonstration", "per", "class", "for", "convenience", "of", "analysis", "."], ["The", "heatmaps", "display", "similarity", "in", "confusing", "category", "pairs", ",", "particularly", "in", "lighter-colored", "blocks", "."], ["This", "high", "correlation", "indicates", "that", "ICL", "makes", "errors", "in", "categories", "with", "similar", "label", "anchors", "."], ["The", "existing", "literature", "on", "in-context", "learning", "analysis", "can", "be", "broadly", "divided", "into", "two", "streams", ",", "each", "focusing", "on", "different", "aspects", "."], ["The", "first", "stream", "explores", "the", "influencing", "factors", "of", "ICL", "based", "on", "input", "perturbation", ",", "such", "as", "the", "order", "(", "Min", "et", "al", ".", ",", "2022b", ")", ",", "the", "formatting", "(", "Yoo", "et", "al", ".", ",", "2022", ";", "Wei", "et", "al", ".", ",", "2022", ")", ",", "and", "the", "selection", "of", "the", "demonstration", "(", "Liu", "et", "al", ".", ",", "2022", ")", "."], ["Designing", "proper", "demonstration", "construc-tion", "strategies", "(", "Ye", "et", "al", ".", ",", "2023", ";", "Li", "et", "al", ".", ",", "2023a", ")", "and", "calibration", "techniques", "(", "Zhao", "et", "al", ".", ",", "2021", ";", "Min", "et", "al", ".", ",", "2022a", ")", "could", "bring", "clear", "boosts", "to", "the", "ICL", "performance", "."], ["The", "second", "stream", "investigates", "the", "inner", "working", "mechanism", "of", "ICL", "through", "different", "conceptual", "lenses", ",", "such", "as", "making", "an", "analogy", "of", "ICL", "to", "gradient", "descent", "(", "von", "Oswald", "et", "al", ".", ",", "2022", ";", "Dai", "et", "al", ".", ",", "2022", ")", "and", "viewing", "the", "process", "of", "ICL", "as", "a", "Bayesian", "inference", "(", "Xie", "et", "al", ".", ",", "2022", ")", "."], ["In", "this", "paper", ",", "we", "provide", "a", "novel", "perspective", "by", "examining", "the", "information", "flow", "in", "language", "models", "to", "gain", "an", "understanding", "of", "ICL", "."], ["Our", "approach", "offers", "new", "insights", "and", "demonstrates", "the", "potential", "for", "leveraging", "this", "understanding", "to", "improve", "the", "effectiveness", ",", "efficiency", ",", "and", "interpretability", "of", "ICL", "."], ["In", "this", "paper", ",", "we", "propose", "a", "hypothesis", "that", "label", "words", "serve", "as", "anchors", "in", "in-context", "learning", "for", "aggregating", "and", "distributing", "the", "task-relevant", "information", "flow", "."], ["Experimental", "results", "with", "attention", "manipulation", "and", "analysis", "of", "predictions", "correlation", "consolidate", "the", "hypothesis", "holds", "well", "in", "GPT2", "-", "XL", "and", "GPT-J", "models", "."], ["First", ",", "an", "anchor", "re-weighting", "method", "is", "proposed", "to", "improve", "ICL", "accuracy", "."], ["Second", ",", "we", "explore", "a", "demonstration", "compression", "technique", "to", "accelerate", "ICL", "inference", "."], ["Lastly", ",", "we", "showcase", "an", "analysis", "framework", "to", "diagnose", "ICL", "errors", "on", "a", "real-world", "dataset", "."], ["These", "promising", "applications", "again", "verify", "the", "hypothesis", "and", "open", "up", "new", "directions", "for", "future", "investigations", "on", "ICL", "."], ["Our", "study", ",", "while", "providing", "valuable", "insights", "into", "in-context", "learning", "(", "ICL", ")", ",", "has", "several", "limitations", "."], ["Additionally", ",", "our", "hypothesis", "was", "only", "examined", "within", "conventional", "ICL", "paradigms", ",", "leaving", "other", "ICL", "paradigms", "such", "as", "the", "chain", "of", "thought", "prompting", "(", "CoT", ")", "(", "Wei", "et", "al", ".", ",", "2022", ")", "unexplored", "."], ["For", "models", ",", "we", "use", "GPT2", "-", "XL", "(", "1.5B", ")", "(", "Radford", "et", "al", ".", ",", "2019", ")", "and", "GPT-J", "(", "6B", ")", "(", "Wang", "and", "Komatsuzaki", ",", "2021", ")", "in", "this", "paper", "."], ["For", "datasets", ",", "we", "use", "a", "sentiment", "analysis", "task", ",", "Stanford", "Sentiment", "Treebank", "Binary", "(", "SST", "-", "2", ")", "(", "Socher", "et", "al", ".", ",", "2013", ")", ",", "a", "question", "type", "classification", "task", ",", "Text", "REtrieval", "Conference", "Question", "Classification", "(", "TREC", ")", "(", "Li", "and", "Roth", ",", "2002", ";", "Hovy", "et", "al", ".", ",", "2001", ")", ",", "a", "topic", "classification", "task", ",", "AG's", "news", "topic", "classification", "dataset", "(", "AGNews", ")", "(", "Zhang", "et", "al", ".", ",", "2015", ")", ",", "and", "an", "emotion", "classification", "task", ",", "Emo-Context", "(", "EmoC", ")", "(", "Chatterjee", "et", "al", ".", ",", "2019", ")", "."]], "ner": [[[11, 12, "Method"], [13, 14, "Method"], [16, 16, "Method"], [24, 26, "Method"], [28, 28, "Method"]], [[48, 48, "Method"]], [[67, 67, "Method"]], [[88, 89, "Method"], [91, 91, "Method"], [104, 106, "Method"], [108, 108, "Method"]], [[121, 121, "Method"], [127, 127, "Method"], [140, 141, "Task"], [151, 152, "Task"]], [[171, 171, "Method"]], [[232, 232, "Method"]], [[238, 239, "Method"], [245, 245, "Method"], [256, 257, "Task"]], [[267, 268, "Method"], [282, 282, "Task"]], [[293, 295, "Method"], [305, 305, "Method"], [315, 316, "Task"], [341, 342, "Method"]], [[357, 358, "Method"], [360, 361, "Method"]], [[401, 403, "Method"]], [[423, 423, "Method"], [435, 437, "Method"], [467, 467, "Method"], [475, 475, "Method"]], [[517, 517, "Method"], [519, 521, "Method"]], [[561, 561, "Method"], [567, 567, "Method"]], [[573, 574, "Method"], [579, 579, "Task"]], [[597, 598, "Method"], [603, 603, "Method"]], [[613, 614, "Method"], [672, 673, "Method"], [682, 683, "Method"], [686, 686, "Task"]], [[692, 693, "Method"]], [[729, 729, "Method"]], [[758, 758, "Task"]], [[773, 774, "Task"], [780, 780, "Task"]], [[786, 788, "Method"], [791, 791, "Method"], [829, 829, "Method"]], [[845, 848, "Dataset"], [850, 852, "Dataset"], [863, 864, "Task"], [866, 870, "Dataset"], [872, 872, "Dataset"], [889, 891, "Task"], [893, 897, "Dataset"], [899, 899, "Dataset"], [910, 911, "Task"], [914, 914, "Dataset"], [916, 916, "Dataset"], [938, 939, "Method"], [981, 982, "Method"]], [[1022, 1022, "Method"]], [[1027, 1028, "Method"], [1042, 1043, "Method"], [1047, 1048, "Method"], [1062, 1062, "Task"]], [[1071, 1071, "Method"], [1090, 1090, "Method"], [1091, 1092, "Method"]], [[1097, 1098, "Method"]], [[1141, 1141, "Method"], [1157, 1159, "Method"]], [[1213, 1214, "Method"]], [[1252, 1252, "Task"]], [[1262, 1262, "Method"]], [[1283, 1285, "Method"], [1287, 1287, "Method"]], [[1298, 1299, "Method"]], [[1326, 1327, "Method"], [1344, 1345, "Method"]], [[1354, 1355, "Method"], [1370, 1371, "Method"]], [[1402, 1403, "Method"]], [[1421, 1421, "Method"]], [[1445, 1445, "Method"]], [[1454, 1456, "Method"]], [[1491, 1491, "Method"]], [[1512, 1512, "Method"]], [[1530, 1530, "Method"]], [[1545, 1545, "Method"], [1547, 1548, "Method"], [1555, 1555, "Method"], [1558, 1560, "Method"], [1577, 1578, "Method"], [1618, 1619, "Method"]], [[1626, 1626, "Method"], [1628, 1629, "Method"], [1675, 1676, "Method"]], [[1687, 1689, "Method"], [1694, 1694, "Method"]], [[1698, 1699, "Method"], [1708, 1708, "Method"], [1724, 1724, "Method"]], [[1760, 1760, "Method"], [1766, 1768, "Dataset"], [1770, 1770, "Dataset"]], [[1780, 1780, "Method"]], [[1809, 1809, "Method"]], [[1841, 1842, "Method"]], [[1864, 1864, "Method"]], [[1884, 1884, "Method"]], [[1888, 1888, "Dataset"]], [[1905, 1906, "Method"]], [[1921, 1921, "Method"], [1924, 1925, "Method"]], [[1967, 1967, "Method"]], [[2030, 2031, "Method"]], [[2036, 2037, "Method"]], [[2047, 2048, "Method"]], [[2073, 2074, "Method"], [2094, 2095, "Method"]], [[2098, 2099, "Method"], [2116, 2117, "Method"]], [[2129, 2130, "Method"], [2140, 2141, "Method"]], [[2166, 2167, "Method"], [2169, 2170, "Method"]], [[2190, 2191, "Method"]], [[2223, 2224, "Method"]], [[2247, 2247, "Method"]], [[2288, 2288, "Method"]], [[2303, 2303, "Method"], [2307, 2309, "Method"], [2318, 2320, "Method"]], [[2330, 2330, "Method"], [2341, 2342, "Method"]], [[2364, 2364, "Method"]], [[2419, 2419, "Method"]], [[2450, 2452, "Method"], [2455, 2455, "Dataset"]], [[2478, 2478, "Dataset"]], [[2503, 2504, "Method"]], [[2511, 2511, "Method"], [2518, 2519, "Method"]], [[2525, 2526, "Method"]], [[2550, 2550, "Method"]], [[2604, 2606, "Method"], [2623, 2623, "Method"], [2646, 2646, "Method"]], [[2658, 2658, "Method"], [2670, 2670, "Method"], [2672, 2673, "Method"], [2695, 2695, "Method"], [2698, 2699, "Method"]], [[2724, 2725, "Method"], [2731, 2731, "Method"]], [[2756, 2756, "Method"]], [[2773, 2774, "Method"]], [[2787, 2788, "Method"], [2792, 2793, "Method"], [2800, 2802, "Method"], [2804, 2804, "Method"]], [[2810, 2812, "Method"], [2817, 2817, "Method"]], [[2830, 2830, "Method"]], [[2842, 2842, "Method"]], [[2865, 2865, "Method"]], [[2875, 2876, "Method"], [2878, 2878, "Method"]], [[2894, 2894, "Method"], [2899, 2899, "Method"], [2904, 2907, "Method"], [2909, 2909, "Method"]], [[2926, 2928, "Method"], [2941, 2941, "Method"]], [[2962, 2963, "Task"], [2966, 2969, "Dataset"], [2971, 2973, "Dataset"], [2985, 2987, "Task"], [2990, 2994, "Dataset"], [2996, 2996, "Dataset"], [3014, 3015, "Task"], [3018, 3022, "Dataset"], [3024, 3024, "Dataset"], [3037, 3038, "Task"], [3041, 3041, "Dataset"], [3043, 3043, "Dataset"]]], "relations": [[[16, 16, 13, 14, "Synonym-Of"], [28, 28, 24, 26, "Synonym-Of"], [13, 14, 24, 26, "Used-For"]], [], [], [[91, 91, 88, 89, "Synonym-Of"], [108, 108, 104, 106, "Synonym-Of"], [88, 89, 104, 106, "Used-For"]], [[127, 127, 140, 141, "Used-For"], [127, 127, 151, 152, "Used-For"]], [], [], [[245, 245, 256, 257, "Used-For"]], [[267, 268, 282, 282, "Used-For"]], [[293, 295, 315, 316, "Used-For"], [305, 305, 315, 316, "Used-For"]], [[357, 358, 360, 361, "Part-Of"]], [], [[435, 437, 467, 467, "Compare-With"]], [[517, 517, 519, 521, "Used-For"]], [[561, 561, 567, 567, "Used-For"]], [[573, 574, 579, 579, "Used-For"]], [[597, 598, 603, 603, "Part-Of"]], [[682, 683, 672, 673, "SubClass-Of"], [682, 683, 686, 686, "Used-For"]], [], [], [], [[773, 774, 780, 780, "Used-For"]], [[786, 788, 791, 791, "SubClass-Of"]], [[850, 852, 845, 848, "Synonym-Of"], [845, 848, 863, 864, "Benchmark-For"], [872, 872, 866, 870, "Synonym-Of"], [866, 870, 889, 891, "Benchmark-For"], [899, 899, 893, 897, "Synonym-Of"], [893, 897, 910, 911, "Benchmark-For"], [916, 916, 914, 914, "Synonym-Of"]], [], [[1027, 1028, 1047, 1048, "Compare-With"], [1047, 1048, 1062, 1062, "Used-For"]], [[1091, 1092, 1090, 1090, "Part-Of"]], [], [[1141, 1141, 1157, 1159, "Compare-With"]], [], [], [], [], [], [[1326, 1327, 1344, 1345, "Compare-With"]], [], [], [], [], [], [], [], [], [[1545, 1545, 1547, 1548, "Compare-With"], [1558, 1560, 1555, 1555, "Part-Of"]], [[1626, 1626, 1628, 1629, "Compare-With"]], [], [[1698, 1699, 1708, 1708, "Compare-With"], [1698, 1699, 1724, 1724, "Compare-With"]], [[1760, 1760, 1766, 1768, "Evaluated-With"], [1760, 1760, 1770, 1770, "Evaluated-With"]], [], [], [], [], [], [], [], [[1921, 1921, 1924, 1925, "Part-Of"]], [], [], [], [], [], [], [[2129, 2130, 2140, 2141, "Compare-With"]], [[2166, 2167, 2169, 2170, "Compare-With"]], [], [], [], [], [[2303, 2303, 2307, 2309, "Compare-With"], [2307, 2309, 2318, 2320, "SubClass-Of"], [2303, 2303, 2318, 2320, "SubClass-Of"]], [], [], [], [[2450, 2452, 2455, 2455, "Evaluated-With"]], [], [], [], [], [], [[2604, 2606, 2646, 2646, "Used-For"], [2623, 2623, 2646, 2646, "Used-For"]], [[2670, 2670, 2672, 2673, "Compare-With"], [2695, 2695, 2698, 2699, "Compare-With"]], [[2731, 2731, 2724, 2725, "Used-For"]], [], [], [], [[2810, 2812, 2817, 2817, "Part-Of"]], [], [], [], [[2878, 2878, 2875, 2876, "Synonym-Of"]], [[2904, 2907, 2899, 2899, "Part-Of"], [2909, 2909, 2904, 2907, "Synonym-Of"]], [], [[2966, 2969, 2962, 2963, "Benchmark-For"], [2971, 2973, 2966, 2969, "Synonym-Of"], [2990, 2994, 2985, 2987, "Benchmark-For"], [2996, 2996, 2990, 2994, "Synonym-Of"], [3018, 3022, 3014, 3015, "Benchmark-For"], [3024, 3024, 3018, 3022, "Synonym-Of"], [3041, 3041, 3037, 3038, "Benchmark-For"], [3043, 3043, 3041, 3041, "Synonym-Of"]]]}
{"doc_id": "ICLR2024-AI4Science-Protein", "doc_tokens": ["A", "Multi-Grained", "Symmetric", "Differential", "Equation", "Model", "for", "Learning", "Protein-Ligand", "Binding", "Dynamics", "In", "drug", "discovery", ",", "molecular", "dynamics", "(", "MD", ")", "simulation", "for", "protein-ligand", "binding", "provides", "a", "powerful", "tool", "for", "predicting", "binding", "affinities", ",", "estimating", "transport", "properties", ",", "and", "exploring", "pocket", "sites", ".", "There", "has", "been", "a", "long", "history", "of", "improving", "the", "efficiency", "of", "MD", "simulations", "through", "better", "numerical", "methods", "and", ",", "more", "recently", ",", "by", "utilizing", "machine", "learning", "(", "ML", ")", "methods", ".", "To", "address", "this", "issue", ",", "we", "propose", "NeuralMD", ",", "the", "first", "ML", "surrogate", "that", "can", "facilitate", "numerical", "MD", "and", "provide", "accurate", "simulations", "in", "protein-ligand", "binding", ".", "Specifically", ",", "we", "propose", "(", "1", ")", "a", "BindingNet", "model", "that", "satisfies", "group", "symmetry", "using", "vector", "frames", "and", "captures", "the", "multi-level", "protein-ligand", "interactions", ",", "and", "(", "2", ")", "an", "augmented", "neural", "differential", "equation", "solver", "that", "learns", "the", "trajectory", "under", "Newtonian", "mechanics", ".", "For", "the", "experiment", ",", "we", "design", "ten", "single-trajectory", "and", "three", "multi-trajectory", "binding", "simulation", "tasks", ".", "We", "show", "the", "efficiency", "and", "effectiveness", "of", "NeuralMD", ",", "with", "a", "2000", "\u00d7", "speedup", "over", "standard", "numerical", "MD", "simulation", "and", "outperforming", "all", "other", "ML", "approaches", "by", "up", "to", "~", "80%", "under", "the", "stability", "metric", ".", "We", "further", "qualitatively", "show", "that", "NeuralMD", "reaches", "more", "stable", "binding", "predictions", "compared", "to", "other", "machine", "learning", "methods", ".", "The", "molecular", "dynamics", "(", "MD", ")", "simulation", "for", "protein-ligand", "binding", "is", "one", "of", "the", "fundamental", "tasks", "in", "drug", "discovery", "[", "1", ",", "2", ",", "3", ",", "4", "]", ".", "To", "simulate", "the", "protein-ligand", "dynamics", ",", "numerical", "MD", "methods", "have", "been", "extensively", "developed", "[", "5", ",", "6", "]", ".", "To", "alleviate", "this", "issue", ",", "machine", "learning", "(", "ML", ")", "surrogates", "have", "been", "proposed", "to", "either", "augment", "or", "replace", "numerical", "MD", "methods", "to", "estimate", "the", "MD", "trajectories", ".", "However", ",", "all", "prior", "ML", "approaches", "for", "MD", "simulation", "are", "limited", "to", "single-system", "(", "e.g", ".", ",", "either", "small", "molecules", "or", "proteins", ")", "and", "not", "protein-ligand", "complex", "[", "7", ",", "8", ",", "9", "]", ".", "A", "primary", "reason", "is", "the", "lack", "of", "large-scale", "datasets", "for", "protein-ligand", "binding", ".", "Another", "critical", "aspect", "that", "needs", "to", "be", "considered", "in", "ML-based", "modeling", "is", "the", "group", "symmetry", "present", "in", "the", "proteinligand", "geometry", ".", "Specifically", ",", "the", "geometric", "function", "over", "molecular", "systems", "should", "be", "equivariant", "to", "rotation", "and", "translation", ",", "i.e", ".", ",", "SE", "(", "3", ")", "-", "equivariance", ".", "DenoisingLD", ",", "exhibiting", "a", "lower", "degree", "of", "torsion", "with", "the", "natural", "conformations", ".", "Other", "methods", "collapse", "heavily", ",", "including", "GNN-MD", "and", "VerletMD", ",", "where", "atoms", "extend", "beyond", "the", "frame", "for", "the", "latter", ".", "Our", "Approach", ":", "NeuralMD", ".", "Further", ",", "our", "ML", "approach", "NeuralMD", "preserves", "the", "Newtonian", "mechanics", ".", "In", "MD", ",", "the", "movement", "of", "atoms", "is", "determined", "by", "Newton's", "second", "law", ",", "F", "=", "m", "\u2022", "a", ",", "where", "F", "is", "the", "force", ",", "m", "is", "the", "mass", ",", "and", "a", "is", "the", "acceleration", "of", "each", "atom", ".", "Thus", "in", "NeuralMD", ",", "we", "formulate", "the", "trajectory", "simulation", "as", "a", "second-order", "ordinary", "differential", "equation", "(", "ODE", ")", "or", "second-order", "stochastic", "differential", "equation", "(", "SDE", ")", "problem", ".", "To", "verify", "the", "effectiveness", "and", "efficiency", "of", "NeuralMD", ",", "we", "design", "ten", "single-trajectory", "and", "three", "multitrajectory", "binding", "simulation", "tasks", ".", "We", "observe", "that", "NeuralMD", "outperforms", "all", "other", "ML", "methods", "[", "9", ",", "23", ",", "24", ",", "25", ",", "26", "]", "on", "12", "tasks", "using", "recovery", "metric", ",", "and", "NeuralMD", "is", "consistently", "better", "by", "a", "large", "gap", "using", "the", "stability", "metric", "(", "up", "to", "~", "80%", ")", ".", "They", "are", "three", "protein-ligand", "binding", "complexes", "from", "Protein", "Data", "Bank", "(", "PDB", ")", ",", "as", "shown", "in", "Figure", "1", ".", "In", "addition", "to", "the", "backbone", "level", ",", "as", "a", "coarser-grained", "view", ",", "we", "further", "consider", "residue-level", "information", "for", "modeling", "binding", "interactions", ",", "{", "f", "(", "p", ")", ",", "x", "x", "x", "(", "p", ")", "}", ",", "where", "the", "coordinate", "of", "C", "\u03b1", "is", "taken", "as", "the", "residue-level", "coordinate", ",", "i.e", ".", ",", "x", "x", "x", "(", "p", ")", "\u225c", "x", "x", "x", "(", "p", ")", "C", "\u03b1", ".", "Molecular", "Dynamics", "Simulations", ".", "Generally", ",", "molecular", "dynamics", "(", "MD", ")", "describes", "how", "each", "atom", "in", "a", "molecular", "system", "moves", "over", "time", ",", "following", "Newton's", "second", "law", "of", "motion", ":", "EQUATION", "where", "F", "is", "the", "force", ",", "m", "is", "the", "mass", ",", "a", "is", "the", "acceleration", ",", "x", "x", "x", "is", "the", "position", ",", "and", "t", "is", "the", "time", ".", "The", "numerical", "MD", "methods", "can", "be", "classified", "into", "classical", "MD", "and", "ab-initio", "MD", ",", "where", "the", "difference", "lies", "in", "how", "the", "force", "on", "each", "atom", "is", "calculated", ":", "classical", "MD", "uses", "force", "field", "approaches", "to", "predict", "the", "atomic", "forces", "[", "5", "]", ",", "while", "ab-initio", "MD", "calculates", "the", "forces", "using", "quantum", "mechanical", "methods", ",", "such", "as", "density", "functional", "theory", "(", "DFT", ")", "[", "6", "]", ".", "More", "recently", ",", "ML", "MD", "methods", "have", "opened", "a", "new", "perspective", "by", "utilizing", "the", "group", "symmetric", "tools", "for", "geometric", "representation", "and", "energy", "prediction", "[", "11", ",", "12", ",", "13", ",", "14", ",", "15", ",", "17", ",", "18", ",", "19", ",", "27", "]", ",", "as", "well", "as", "the", "automatic", "differential", "tools", "for", "trajectory", "learning", "[", "28", ",", "29", ",", "30", ",", "31", ",", "32", ",", "33", "]", ".", "Newtonian", "Dynamics", "and", "Langevin", "Dynamics", ".", "Newtonian", "dynamics", "is", "suitable", "for", "idealized", "systems", "with", "negligible", "thermal", "effects", "or", "when", "deterministic", "trajectories", "are", "required", ",", "while", "Langevin", "dynamics", "is", "adopted", "where", "thermal", "effects", "play", "a", "significant", "role", "and", "when", "the", "system", "is", "being", "studied", "at", "a", "finite", "temperature", ".", "In", "this", "work", ",", "we", "propose", "two", "versions", ":", "an", "ordinary", "differential", "equation", "(", "ODE", ")", "solver", "and", "a", "stochastic", "differential", "equation", "(", "SDE", ")", "solver", "concerning", "Newtonian", "dynamics", "and", "Langevin", "dynamics", ",", "respectively", ".", "Noticeably", ",", "our", "experiential", "dataset", ",", "MISATO", "[", "10", "]", ",", "uses", "Newtonian", "dynamics", "with", "Langevin", "thermostats", ",", "and", "the", "information", "on", "solvent", "molecules", "is", "not", "provided", ".", "We", "also", "want", "to", "clarify", "two", "critical", "points", "about", "this", "problem", "setting", ":", "(", "1", ")", "Our", "task", "is", "trajectory", "prediction", ",", "i.e", ".", ",", "positions", "as", "labels", ",", "and", "no", "explicit", "energy", "and", "force", "are", "considered", "as", "labels", ".", "ML", "methods", "for", "energy", "prediction", "followed", "with", "numerical", "ODE", "/", "SDE", "solver", "require", "smaller", "timestep", "(", "e.g", ".", ",", "1e", "-", "15", "seconds", ")", ",", "while", "trajectory", "prediction", ",", "which", "directly", "predicts", "the", "coordinates", "over", "time", ",", "is", "agnostic", "to", "the", "magnitude", "of", "the", "timestep", ".", "It", "has", "two", "main", "phases", ":", "(", "1", ")", "A", "multi-grained", "SE", "(", "3", ")", "-", "equivariant", "geometric", "model", ",", "BindingNet", ".", "It", "models", "the", "protein-ligand", "complex", "from", "three", "granularities", ",", "employing", "three", "levels", "of", "vector", "frame", "basis", ":", "atom", "level", "for", "ligands", ",", "backbone", "level", "for", "proteins", ",", "and", "residue", "level", "for", "protein-ligand", "complexes", ".", "(", "2", ")", "A", "second-order", "ordinary", "differential", "equation", "(", "ODE", ")", "solver", "and", "a", "second-order", "stochastic", "differential", "equation", "(", "SDE", ")", "to", "learn", "the", "Newtonian", "mechanics", ".", "We", "further", "introduce", "two", "attributes", ":", "a", "derivative-space", "augmentation", "method", "for", "the", "efficient", "second-order", "solver", "and", "a", "conditional", "adjoint", "solver", "for", "lower", "memory", "costs", ".", "This", "section", "outlines", "the", "structure", ":", "the", "three", "levels", "of", "vector", "frames", "in", "Section", "3.1", ",", "the", "architecture", "of", "BindingNet", "for", "protein-ligand", "force", "prediction", "in", "Section", "3.2", ",", "the", "design", "of", "NeuralMD", "for", "trajectory", "simulation", "in", "Section", "3.3", ",", "and", "implementation", "details", "in", "Section", "3.4", ".", "To", "address", "this", "issue", ",", "we", "propose", "BindingNet", ",", "a", "multi-grained", "SE", "(", "3", ")", "-", "equivariant", "model", ",", "to", "capture", "the", "interactions", "between", "a", "ligand", "and", "a", "protein", ".", "Such", "a", "group", "symmetric", "property", "is", "called", "SE", "(", "3", ")", "-", "equivariance", ".", "Atom-Level", "Vector", "Frame", "for", "Ligands", ".", "For", "each", "residue", "in", "the", "protein", ",", "the", "coordinates", "are", "x", "x", "x", "N", ",", "x", "x", "x", "C", "\u03b1", ",", "and", "x", "x", "x", "C", ",", "then", "the", "backbone-level", "vector", "frame", "for", "this", "residue", "is", ":", "EQUATION", "This", "is", "built", "for", "each", "residue", ",", "enabling", "the", "message", "passing", "for", "a", "residue-level", "representation", ".", "Residue-Level", "Vector", "Frame", "for", "Protein-Ligand", "Complexes", ".", "In", "this", "section", ",", "we", "introduce", "BindingNet", ",", "a", "multi-grained", "SE", "(", "3", ")", "-", "equivariant", "geometric", "model", "for", "protein-ligand", "binding", ".", "The", "input", "of", "BindingNet", "is", "the", "geometry", "of", "the", "rigid", "protein", "and", "the", "ligand", "at", "time", "t", ",", "while", "the", "output", "is", "the", "force", "on", "each", "atom", "in", "the", "ligand", ".", "Atom-Level", "Ligand", "Modeling", ".", "We", "first", "generate", "the", "atom", "embedding", "using", "one-hot", "encoding", "and", "then", "aggregate", "each", "atom's", "embedding", ",", "z", "z", "z", "(", "l", ")", ",", "by", "aggregating", "all", "its", "neighbor's", "embedding", "within", "the", "cutoff", "distance", "c", ".", "Finally", ",", "it", "is", "passed", "through", "several", "equivariant", "message-passing", "layers", "(", "MPNN", ")", "defined", "as", ":", "EQUATION", "where", "MLP", "(", "\u2022", ")", "and", "Agg", "(", "\u2022", ")", "are", "the", "multi-layer", "perceptron", "and", "mean", "aggregation", "functions", ",", "respectively", ".", "vec", "\u2208", "R", "3", "is", "a", "vector", "assigned", "to", "each", "atom", "and", "is", "initialized", "as", "0", ".", "The", "outputs", "are", "atom", "representation", "and", "vector", "(", "h", "h", "h", "(", "l", ")", "and", "vec", "(", "l", ")", ")", ",", "and", "they", "are", "passed", "to", "the", "complex", "module", "introduced", "below", ".", "Backbone-Level", "Protein", "Modeling", ".", "For", "the", "coarse-grained", "modeling", "of", "proteins", ",", "we", "consider", "three", "backbone", "atoms", "in", "each", "residue", ".", "Then", ",", "we", "obtain", "an", "equivariant", "atom", "representation", "by", "aggregating", "the", "edge", "information", ",", "(", "x", "x", "x", "(", "p", ")", "i", "-", "x", "x", "x", "(", "p", ")", "j", ")", "\u2022", "z", "z", "z", "(", "p", ")", "i", ",", "within", "cutoff", "distance", "c", ".", "Finally", ",", "we", "adopt", "an", "equivariant", "MPNN", "layer", "to", "get", "the", "atom-level", "force", "as", ":", "EQUATION", "The", "ultimate", "force", "predictions", "for", "each", "atom", "include", "two", "parts", ":", "the", "internal", "force", "from", "the", "molecule", "vec", "(", "l", ")", "i", "and", "the", "external", "force", "from", "the", "protein-ligand", "interaction", "vec", "(", "pl", ")", "i", "j", ".", "So", "sum", "them", "up", ",", "we", "have", ":", "EQUATION", "These", "three", "modules", "consist", "BindingNet", ".", "The", "BindingNet", "introduced", "in", "Sections", "3.1", "and", "3.2", "takes", "in", "the", "molecular", "system", "geometry", "at", "time", "t", "and", "outputs", "the", "forces", ".", "Then", "in", "this", "section", ",", "we", "describe", "how", "we", "use", "the", "neural", "differential", "equation", "solver", "to", "predict", "the", "coordinates", "at", "future", "snapshots", ".", "We", "want", "to", "highlight", "that", "one", "ML", "for", "MD", "simulation", "research", "line", "is", "predicting", "the", "energy", "or", "force", "[", "36", ",", "23", ",", "9", "]", ",", "which", "will", "be", "fed", "into", "the", "numerical", "integration", "algorithms", "for", "trajectory", "simulation", ".", "For", "accuracy", ",", "such", "an", "ML-based", "MD", "simulation", "must", "be", "at", "the", "femtosecond", "level", "(", "1e", "-", "15", "second", ")", ".", "However", ",", "as", "shown", "in", "recent", "works", "[", "37", ",", "38", ",", "21", "]", ",", "minor", "errors", "in", "the", "ML", "force", "field", "can", "lead", "to", "catastrophic", "failure", "for", "long-time", "simulations", ".", "In", "this", "paper", ",", "however", ",", "we", "overcome", "this", "issue", "by", "directly", "learning", "the", "extended-timescale", "MD", "trajectories", "(", "nanosecond", "level", ",", "1e", "-", "9", "second", ")", ".", "Newtonian", "dynamics", "and", "Langevin", "dynamics", "for", "MD", "simulation", ".", "For", "modeling", ",", "we", "consider", "using", "the", "BindingNet", "introduced", "above", "for", "force", "prediction", "at", "time", "\u03c4", ",", "as", ":", "EQUATION", "On", "the", "other", "hand", ",", "Langevin", "dynamics", "introduces", "a", "stochastic", "component", "for", "large", "molecular", "systems", "with", "thermal", "fluctuations", ".", "Ultimately", ",", "adopting", "either", "F", "(", "l", ")", "\u03c4", "-", "ODE", "or", "F", "(", "l", ")", "\u03c4", "-", "SDE", "as", "the", "force", "prediction", "F", "(", "l", ")", "\u03c4", "on", "each", "atom", ",", "the", "coordinates", "at", "time", "t", "can", "be", "obtained", "after", "integration", "as", ":", "EQUATION", ")", "The", "training", "objective", "is", "the", "mean", "absolute", "error", "(", "MAE", ")", "between", "the", "predicted", "coordinates", "and", "ground-truth", "coordinates", "along", "the", "whole", "trajectories", ":", "EQUATION", ")", "An", "illustration", "of", "NeuralMD", "pipeline", "is", "in", "Figure", "4", ".", "Adjoint", "method", ".", "Specifically", "for", "protein-ligand", "complexes", "with", "a", "large", "volume", "of", "atoms", ",", "the", "memory", "costs", "have", "become", "a", "main", "challenge", ".", "To", "handle", "this", ",", "we", "consider", "the", "adjoint", "method", "[", "28", "]", ",", "allowing", "small", "step", "sizes", "in", "the", "integration", ".", "Roughly", "speaking", ",", "the", "adjoint", "method", "calculates", "the", "variational", "derivative", "of", "the", "trajectory", "w.r.t", ".", "our", "objective", "function", "directly", ".", "Second-order", "differential", "equation", ".", "The", "key", "module", "of", "the", "neural", "differential", "method", "is", "the", "differential", "function", "[", "28", "]", ",", "which", "returns", "the", "first-order", "derivative", ".", "To", "learn", "the", "MD", "trajectory", "following", "second-order", "ODE", "and", "SDE", ",", "we", "propose", "the", "following", "formulation", "of", "the", "second-order", "equation", "within", "one", "integration", "call", ":", "EQUATION", ")", "We", "mark", "this", "as", "\"", "func", "\"", "in", "Figure", "4", ".", "This", "means", "we", "can", "augment", "ODE", "or", "SDE", "derivative", "space", "by", "concurrently", "calculating", "the", "accelerations", "and", "velocities", ",", "allowing", "simultaneous", "integration", "of", "velocities", "and", "positions", ".", "In", "this", "section", ",", "we", "would", "like", "to", "include", "extra", "details", "of", "NeuralMD", ".", "As", "in", "Equations", "(", "11", ")", "and", "(", "13", ")", ",", "both", "the", "coordinates", "and", "velocities", "are", "required", "inputs", "for", "NeuralMD", ".", "To", "handle", "this", "issue", ",", "we", "propose", "a", "surrogate", "velocity", ",", "which", "is", "a", "summation", "of", "a", "predicted", "velocity", "by", "an", "extra", "equivariant", "model", "and", "a", "coordinate", "momentum", ",", "i.e", ".", ",", "v", "v", "v", "(", "l", ")", "t", "=", "BindingNet-Ligand", "(", "f", "(", "l", ")", ",", "x", "x", "x", "(", "l", ")", "t", ")", "+", "(", "x", "x", "x", "(", "l", ")", "t", "+", "1", "-", "x", "x", "x", "(", "l", ")", "t", ")", ",", "where", "the", "BindingNet-Ligand", "is", "the", "ligand", "model", "described", "in", "Section", "3.2", ".", "Update", "model", "BindingNet", "using", "gradient", "descent", ".", "9", ":", "end", "for", "10", ":", "end", "for", "4", "Experiments", "Datasets", ".", "One", "of", "the", "main", "bottlenecks", "of", "studying", "ML", "for", "molecular", "dynamics", "simulation", "in", "protein-ligand", "binding", "is", "insufficient", "data", ".", "Recently", ",", "the", "community", "has", "put", "more", "effort", "into", "gathering", "the", "datasets", ",", "and", "we", "consider", "MISATO", "in", "our", "work", "[", "10", "]", ".", "It", "is", "built", "on", "16,972", "experimental", "protein-ligand", "complexes", "extracted", "from", "the", "protein", "data", "bank", "(", "PDB", ")", "[", "39", "]", ".", "Such", "data", "is", "obtained", "using", "X-ray", "crystallography", ",", "Nuclear", "Magnetic", "Resonance", "(", "NMR", ")", ",", "or", "Cryo-Electron", "Microscopy", "(", "Cryo-EM", ")", ",", "where", "systematic", "errors", "are", "unavoidable", ".", "For", "each", "protein-ligand", "complex", ",", "the", "trajectory", "comprises", "100", "snapshots", "in", "8", "nanoseconds", "under", "the", "fixed", "temperature", "and", "pressure", ".", "In", "Appendix", "E", ",", "we", "list", "the", "basic", "statistics", "of", "MISATO", ",", "e.g", ".", ",", "the", "number", "of", "atoms", "in", "small", "molecule", "ligands", ",", "and", "the", "number", "of", "residues", "in", "proteins", ".", "Using", "ML", "for", "energy", "and", "force", "prediction", ",", "followed", "by", "trajectory", "prediction", "using", "numerical", "integration", "method", ",", "has", "been", "widely", "explored", "in", "the", "community", ",", "e.g", ".", ",", "HDNNPs", "[", "7", "]", ",", "DeePMD", "[", "9", "]", ",", "TorchMD", "[", "36", "]", ",", "and", "Allegro-LAMMPS", "[", "23", "]", ".", "Here", "we", "extend", "this", "paradigm", "for", "binding", "dynamics", "and", "propose", "VerletMD", ",", "which", "utilizes", "BindingNet", "for", "energy", "prediction", "on", "each", "snapshot", "and", "velocity", "Verlet", "algorithm", "to", "get", "the", "trajectory", ".", "Additionally", ",", "we", "mainly", "focus", "on", "ML", "methods", "for", "trajectory", "prediction", "in", "this", "work", ",", "i.e", ".", ",", "no", "energy", "or", "force", "is", "considered", "as", "labels", ".", "GNN-MD", "is", "to", "apply", "geometric", "graph", "neural", "networks", "(", "GNNs", ")", "to", "predict", "the", "trajectories", "in", "an", "auto-regressive", "manner", "[", "10", ",", "24", "]", ".", "More", "concretely", ",", "GNN-MD", "takes", "the", "coordinates", "and", "other", "molecular", "information", "as", "inputs", "at", "time", "t", "and", "predicts", "the", "coordinates", "at", "time", "t", "+", "1", ".", "DenoisingLD", "(", "denoising", "diffusion", "for", "Langevin", "dynamics", ")", "[", "24", ",", "25", ",", "26", "]", "is", "a", "baseline", "method", "that", "models", "the", "trajectory", "prediction", "as", "denoising", "diffusion", "task", "[", "40", "]", ",", "and", "the", "inference", "for", "binding", "trajectory", "essentially", "becomes", "the", "Langevin", "dynamics", ".", "Here", ",", "to", "make", "the", "comparison", "more", "explicit", ",", "we", "compare", "these", "two", "methods", "(", "GNN-MD", "and", "DenoisingLD", ")", "separately", ".", "We", "want", "to", "highlight", "that", "we", "keep", "the", "same", "backbone", "model", ",", "BindingNet", ",", "for", "energy", "or", "force", "prediction", "for", "all", "the", "baselines", "and", "NeuralMD", ".", "To", "evaluate", "this", ",", "we", "take", "both", "the", "mean", "absolute", "error", "(", "MAE", ")", "and", "mean", "squared", "error", "(", "MSE", ")", "between", "the", "predicted", "coordinates", "and", "ground-truth", "coordinates", "over", "all", "snapshots", ".", "Stability", ",", "as", "highlighted", "in", "[", "21", "]", ",", "is", "an", "important", "metric", "for", "evaluating", "the", "predicted", "MD", "trajectory", ".", "The", "intuition", "is", "that", "the", "prediction", "on", "long-time", "MD", "trajectory", "can", "enter", "a", "pathological", "state", "(", "e.g", ".", ",", "bond", "breaking", ")", ",", "and", "stability", "is", "the", "measure", "to", "quantify", "such", "observation", ".", "Another", "metric", "considered", "is", "frames", "per", "second", "(", "FPS", ")", "[", "21", "]", "on", "a", "single", "Nvidia-V100", "GPU", "card", ",", "and", "it", "measures", "the", "MD", "efficiency", ".", "The", "first", "observation", "is", "that", "the", "baseline", "VertletMD", "has", "a", "clear", "performance", "gap", "compared", "to", "the", "other", "methods", ".", "There", "are", "two", "possible", "reasons", ":", "(", "1", ")", "Using", "ML", "models", "to", "predict", "the", "energy", "(", "or", "force", ")", "at", "each", "snapshot", ",", "and", "then", "using", "a", "numerical", "integration", "algorithm", "can", "fail", "in", "the", "long-time", "simulations", "[", "21", "]", ";", "(", "2", ")", "ML", "for", "energy", "prediction", "methods", "require", "more", "data", "to", "train", "than", "the", "ML", "for", "coordinate", "prediction", "methods", ",", "thus", "they", "can", "perform", "worse", "in", "the", "low-data", "regime", "here", ".", "However", ",", "the", "stability", "(", "%", ")", "can", "be", "a", "distinctive", "factor", "in", "method", "comparisons", ",", "where", "we", "observe", "the", "two", "variants", "of", "NeuralMD", "outperform", "on", "all", "10", "tasks", "up", "to", "~", "80%", ".", "It", "is", "shown", "that", "the", "GNN-MD", "collapses", "occasionally", ",", "while", "DenoisingLD", "stays", "comparatively", "structured", ".", "Meanwhile", ",", "NeuralMD", "is", "the", "most", "stable", "in", "all", "cases", ".", "One", "main", "benefit", "of", "using", "NeuralMD", "for", "binding", "simulation", "is", "its", "efficiency", ".", "We", "further", "approximate", "the", "wall", "time", "of", "the", "numerical", "method", "for", "MD", "simulation", "(", "PDB", "5WIJ", ")", ".", "A", "more", "challenging", "task", "is", "to", "test", "the", "generalization", "ability", "of", "NeuralMD", "among", "different", "trajectories", ".", "The", "MISATO", "dataset", "includes", "13,765", "protein-ligand", "complexes", ",", "and", "we", "first", "create", "two", "small", "datasets", "by", "randomly", "sampling", "100", "and", "1k", "complexes", ",", "respectively", ".", "We", "also", "consider", "the", "whole", "MISATO", "dataset", ",", "where", "the", "data", "split", "has", "already", "been", "provided", ".", "First", ",", "we", "can", "observe", "that", "VerletMD", "has", "worse", "performance", "on", "all", "three", "datasets", ",", "and", "the", "performance", "gap", "with", "other", "methods", "is", "even", "larger", "compared", "to", "the", "single-trajectory", "prediction", ".", "The", "other", "two", "baselines", ",", "GNN-MD", "and", "DenoisingLD", ",", "show", "similar", "performance", ",", "while", "NeuralMD", "outperforms", "in", "all", "datasets", ".", "Notice", "that", "stability", "(", "%", ")", "remains", "more", "distinguishable", "than", "the", "two", "trajectory", "recovery", "metrics", "(", "MAE", "and", "MSE", ")", ".", "To", "sum", "up", ",", "we", "devise", "NeuralMD", ",", "an", "ML", "framework", "that", "incorporates", "a", "novel", "multi-grained", "group", "symmetric", "network", "architecture", "and", "second-order", "Newtonian", "mechanics", ",", "enabling", "accurate", "predictions", "of", "binding", "dynamics", "in", "a", "large", "timescale", ".", "Not", "only", "is", "such", "a", "timescale", "critical", "for", "understanding", "the", "dynamic", "nature", "of", "the", "ligand-protein", "complex", ",", "but", "our", "work", "marks", "the", "first", "approach", "in", "developing", "a", "framework", "to", "predict", "coordinates", "for", "MD", "simulation", "in", "protein-ligand", "binding", ".", "We", "quantitatively", "and", "qualitatively", "verify", "that", "NeuralMD", "achieves", "superior", "performance", "on", "13", "binding", "dynamics", "tasks", ".", "Currently", ",", "we", "are", "using", "the", "MISATO", "dataset", ",", "a", "protein-ligand", "dynamics", "dataset", "with", "a", "large", "timestep", ".", "However", ",", "NeuralMD", "is", "agnostic", "to", "the", "timestep", ",", "and", "it", "can", "also", "be", "applied", "to", "binding", "dynamics", "datasets", "with", "timestep", "as", "a", "femtosecond", "."], "sentences": [["A", "Multi-Grained", "Symmetric", "Differential", "Equation", "Model", "for", "Learning", "Protein-Ligand", "Binding", "Dynamics", "In", "drug", "discovery", ",", "molecular", "dynamics", "(", "MD", ")", "simulation", "for", "protein-ligand", "binding", "provides", "a", "powerful", "tool", "for", "predicting", "binding", "affinities", ",", "estimating", "transport", "properties", ",", "and", "exploring", "pocket", "sites", "."], ["There", "has", "been", "a", "long", "history", "of", "improving", "the", "efficiency", "of", "MD", "simulations", "through", "better", "numerical", "methods", "and", ",", "more", "recently", ",", "by", "utilizing", "machine", "learning", "(", "ML", ")", "methods", "."], ["To", "address", "this", "issue", ",", "we", "propose", "NeuralMD", ",", "the", "first", "ML", "surrogate", "that", "can", "facilitate", "numerical", "MD", "and", "provide", "accurate", "simulations", "in", "protein-ligand", "binding", "."], ["Specifically", ",", "we", "propose", "(", "1", ")", "a", "BindingNet", "model", "that", "satisfies", "group", "symmetry", "using", "vector", "frames", "and", "captures", "the", "multi-level", "protein-ligand", "interactions", ",", "and", "(", "2", ")", "an", "augmented", "neural", "differential", "equation", "solver", "that", "learns", "the", "trajectory", "under", "Newtonian", "mechanics", "."], ["For", "the", "experiment", ",", "we", "design", "ten", "single-trajectory", "and", "three", "multi-trajectory", "binding", "simulation", "tasks", "."], ["We", "show", "the", "efficiency", "and", "effectiveness", "of", "NeuralMD", ",", "with", "a", "2000", "\u00d7", "speedup", "over", "standard", "numerical", "MD", "simulation", "and", "outperforming", "all", "other", "ML", "approaches", "by", "up", "to", "~", "80%", "under", "the", "stability", "metric", "."], ["We", "further", "qualitatively", "show", "that", "NeuralMD", "reaches", "more", "stable", "binding", "predictions", "compared", "to", "other", "machine", "learning", "methods", "."], ["The", "molecular", "dynamics", "(", "MD", ")", "simulation", "for", "protein-ligand", "binding", "is", "one", "of", "the", "fundamental", "tasks", "in", "drug", "discovery", "[", "1", ",", "2", ",", "3", ",", "4", "]", "."], ["To", "simulate", "the", "protein-ligand", "dynamics", ",", "numerical", "MD", "methods", "have", "been", "extensively", "developed", "[", "5", ",", "6", "]", "."], ["To", "alleviate", "this", "issue", ",", "machine", "learning", "(", "ML", ")", "surrogates", "have", "been", "proposed", "to", "either", "augment", "or", "replace", "numerical", "MD", "methods", "to", "estimate", "the", "MD", "trajectories", "."], ["However", ",", "all", "prior", "ML", "approaches", "for", "MD", "simulation", "are", "limited", "to", "single-system", "(", "e.g", ".", ",", "either", "small", "molecules", "or", "proteins", ")", "and", "not", "protein-ligand", "complex", "[", "7", ",", "8", ",", "9", "]", "."], ["A", "primary", "reason", "is", "the", "lack", "of", "large-scale", "datasets", "for", "protein-ligand", "binding", "."], ["Another", "critical", "aspect", "that", "needs", "to", "be", "considered", "in", "ML-based", "modeling", "is", "the", "group", "symmetry", "present", "in", "the", "proteinligand", "geometry", "."], ["Specifically", ",", "the", "geometric", "function", "over", "molecular", "systems", "should", "be", "equivariant", "to", "rotation", "and", "translation", ",", "i.e", ".", ",", "SE", "(", "3", ")", "-", "equivariance", "."], ["DenoisingLD", ",", "exhibiting", "a", "lower", "degree", "of", "torsion", "with", "the", "natural", "conformations", "."], ["Other", "methods", "collapse", "heavily", ",", "including", "GNN-MD", "and", "VerletMD", ",", "where", "atoms", "extend", "beyond", "the", "frame", "for", "the", "latter", "."], ["Our", "Approach", ":", "NeuralMD", "."], ["Further", ",", "our", "ML", "approach", "NeuralMD", "preserves", "the", "Newtonian", "mechanics", "."], ["In", "MD", ",", "the", "movement", "of", "atoms", "is", "determined", "by", "Newton's", "second", "law", ",", "F", "=", "m", "\u2022", "a", ",", "where", "F", "is", "the", "force", ",", "m", "is", "the", "mass", ",", "and", "a", "is", "the", "acceleration", "of", "each", "atom", "."], ["Thus", "in", "NeuralMD", ",", "we", "formulate", "the", "trajectory", "simulation", "as", "a", "second-order", "ordinary", "differential", "equation", "(", "ODE", ")", "or", "second-order", "stochastic", "differential", "equation", "(", "SDE", ")", "problem", "."], ["To", "verify", "the", "effectiveness", "and", "efficiency", "of", "NeuralMD", ",", "we", "design", "ten", "single-trajectory", "and", "three", "multitrajectory", "binding", "simulation", "tasks", "."], ["We", "observe", "that", "NeuralMD", "outperforms", "all", "other", "ML", "methods", "[", "9", ",", "23", ",", "24", ",", "25", ",", "26", "]", "on", "12", "tasks", "using", "recovery", "metric", ",", "and", "NeuralMD", "is", "consistently", "better", "by", "a", "large", "gap", "using", "the", "stability", "metric", "(", "up", "to", "~", "80%", ")", "."], ["They", "are", "three", "protein-ligand", "binding", "complexes", "from", "Protein", "Data", "Bank", "(", "PDB", ")", ",", "as", "shown", "in", "Figure", "1", "."], ["In", "addition", "to", "the", "backbone", "level", ",", "as", "a", "coarser-grained", "view", ",", "we", "further", "consider", "residue-level", "information", "for", "modeling", "binding", "interactions", ",", "{", "f", "(", "p", ")", ",", "x", "x", "x", "(", "p", ")", "}", ",", "where", "the", "coordinate", "of", "C", "\u03b1", "is", "taken", "as", "the", "residue-level", "coordinate", ",", "i.e", ".", ",", "x", "x", "x", "(", "p", ")", "\u225c", "x", "x", "x", "(", "p", ")", "C", "\u03b1", "."], ["Molecular", "Dynamics", "Simulations", "."], ["Generally", ",", "molecular", "dynamics", "(", "MD", ")", "describes", "how", "each", "atom", "in", "a", "molecular", "system", "moves", "over", "time", ",", "following", "Newton's", "second", "law", "of", "motion", ":", "EQUATION", "where", "F", "is", "the", "force", ",", "m", "is", "the", "mass", ",", "a", "is", "the", "acceleration", ",", "x", "x", "x", "is", "the", "position", ",", "and", "t", "is", "the", "time", "."], ["The", "numerical", "MD", "methods", "can", "be", "classified", "into", "classical", "MD", "and", "ab-initio", "MD", ",", "where", "the", "difference", "lies", "in", "how", "the", "force", "on", "each", "atom", "is", "calculated", ":", "classical", "MD", "uses", "force", "field", "approaches", "to", "predict", "the", "atomic", "forces", "[", "5", "]", ",", "while", "ab-initio", "MD", "calculates", "the", "forces", "using", "quantum", "mechanical", "methods", ",", "such", "as", "density", "functional", "theory", "(", "DFT", ")", "[", "6", "]", "."], ["More", "recently", ",", "ML", "MD", "methods", "have", "opened", "a", "new", "perspective", "by", "utilizing", "the", "group", "symmetric", "tools", "for", "geometric", "representation", "and", "energy", "prediction", "[", "11", ",", "12", ",", "13", ",", "14", ",", "15", ",", "17", ",", "18", ",", "19", ",", "27", "]", ",", "as", "well", "as", "the", "automatic", "differential", "tools", "for", "trajectory", "learning", "[", "28", ",", "29", ",", "30", ",", "31", ",", "32", ",", "33", "]", "."], ["Newtonian", "Dynamics", "and", "Langevin", "Dynamics", "."], ["Newtonian", "dynamics", "is", "suitable", "for", "idealized", "systems", "with", "negligible", "thermal", "effects", "or", "when", "deterministic", "trajectories", "are", "required", ",", "while", "Langevin", "dynamics", "is", "adopted", "where", "thermal", "effects", "play", "a", "significant", "role", "and", "when", "the", "system", "is", "being", "studied", "at", "a", "finite", "temperature", "."], ["In", "this", "work", ",", "we", "propose", "two", "versions", ":", "an", "ordinary", "differential", "equation", "(", "ODE", ")", "solver", "and", "a", "stochastic", "differential", "equation", "(", "SDE", ")", "solver", "concerning", "Newtonian", "dynamics", "and", "Langevin", "dynamics", ",", "respectively", "."], ["Noticeably", ",", "our", "experiential", "dataset", ",", "MISATO", "[", "10", "]", ",", "uses", "Newtonian", "dynamics", "with", "Langevin", "thermostats", ",", "and", "the", "information", "on", "solvent", "molecules", "is", "not", "provided", "."], ["We", "also", "want", "to", "clarify", "two", "critical", "points", "about", "this", "problem", "setting", ":", "(", "1", ")", "Our", "task", "is", "trajectory", "prediction", ",", "i.e", ".", ",", "positions", "as", "labels", ",", "and", "no", "explicit", "energy", "and", "force", "are", "considered", "as", "labels", "."], ["ML", "methods", "for", "energy", "prediction", "followed", "with", "numerical", "ODE", "/", "SDE", "solver", "require", "smaller", "timestep", "(", "e.g", ".", ",", "1e", "-", "15", "seconds", ")", ",", "while", "trajectory", "prediction", ",", "which", "directly", "predicts", "the", "coordinates", "over", "time", ",", "is", "agnostic", "to", "the", "magnitude", "of", "the", "timestep", "."], ["It", "has", "two", "main", "phases", ":", "(", "1", ")", "A", "multi-grained", "SE", "(", "3", ")", "-", "equivariant", "geometric", "model", ",", "BindingNet", "."], ["It", "models", "the", "protein-ligand", "complex", "from", "three", "granularities", ",", "employing", "three", "levels", "of", "vector", "frame", "basis", ":", "atom", "level", "for", "ligands", ",", "backbone", "level", "for", "proteins", ",", "and", "residue", "level", "for", "protein-ligand", "complexes", ".", "(", "2", ")", "A", "second-order", "ordinary", "differential", "equation", "(", "ODE", ")", "solver", "and", "a", "second-order", "stochastic", "differential", "equation", "(", "SDE", ")", "to", "learn", "the", "Newtonian", "mechanics", "."], ["We", "further", "introduce", "two", "attributes", ":", "a", "derivative-space", "augmentation", "method", "for", "the", "efficient", "second-order", "solver", "and", "a", "conditional", "adjoint", "solver", "for", "lower", "memory", "costs", "."], ["This", "section", "outlines", "the", "structure", ":", "the", "three", "levels", "of", "vector", "frames", "in", "Section", "3.1", ",", "the", "architecture", "of", "BindingNet", "for", "protein-ligand", "force", "prediction", "in", "Section", "3.2", ",", "the", "design", "of", "NeuralMD", "for", "trajectory", "simulation", "in", "Section", "3.3", ",", "and", "implementation", "details", "in", "Section", "3.4", "."], ["To", "address", "this", "issue", ",", "we", "propose", "BindingNet", ",", "a", "multi-grained", "SE", "(", "3", ")", "-", "equivariant", "model", ",", "to", "capture", "the", "interactions", "between", "a", "ligand", "and", "a", "protein", "."], ["Such", "a", "group", "symmetric", "property", "is", "called", "SE", "(", "3", ")", "-", "equivariance", "."], ["Atom-Level", "Vector", "Frame", "for", "Ligands", "."], ["For", "each", "residue", "in", "the", "protein", ",", "the", "coordinates", "are", "x", "x", "x", "N", ",", "x", "x", "x", "C", "\u03b1", ",", "and", "x", "x", "x", "C", ",", "then", "the", "backbone-level", "vector", "frame", "for", "this", "residue", "is", ":", "EQUATION", "This", "is", "built", "for", "each", "residue", ",", "enabling", "the", "message", "passing", "for", "a", "residue-level", "representation", "."], ["Residue-Level", "Vector", "Frame", "for", "Protein-Ligand", "Complexes", "."], ["In", "this", "section", ",", "we", "introduce", "BindingNet", ",", "a", "multi-grained", "SE", "(", "3", ")", "-", "equivariant", "geometric", "model", "for", "protein-ligand", "binding", "."], ["The", "input", "of", "BindingNet", "is", "the", "geometry", "of", "the", "rigid", "protein", "and", "the", "ligand", "at", "time", "t", ",", "while", "the", "output", "is", "the", "force", "on", "each", "atom", "in", "the", "ligand", "."], ["Atom-Level", "Ligand", "Modeling", "."], ["We", "first", "generate", "the", "atom", "embedding", "using", "one-hot", "encoding", "and", "then", "aggregate", "each", "atom's", "embedding", ",", "z", "z", "z", "(", "l", ")", ",", "by", "aggregating", "all", "its", "neighbor's", "embedding", "within", "the", "cutoff", "distance", "c", "."], ["Finally", ",", "it", "is", "passed", "through", "several", "equivariant", "message-passing", "layers", "(", "MPNN", ")", "defined", "as", ":", "EQUATION", "where", "MLP", "(", "\u2022", ")", "and", "Agg", "(", "\u2022", ")", "are", "the", "multi-layer", "perceptron", "and", "mean", "aggregation", "functions", ",", "respectively", ".", "vec", "\u2208", "R", "3", "is", "a", "vector", "assigned", "to", "each", "atom", "and", "is", "initialized", "as", "0", "."], ["The", "outputs", "are", "atom", "representation", "and", "vector", "(", "h", "h", "h", "(", "l", ")", "and", "vec", "(", "l", ")", ")", ",", "and", "they", "are", "passed", "to", "the", "complex", "module", "introduced", "below", "."], ["Backbone-Level", "Protein", "Modeling", "."], ["For", "the", "coarse-grained", "modeling", "of", "proteins", ",", "we", "consider", "three", "backbone", "atoms", "in", "each", "residue", "."], ["Then", ",", "we", "obtain", "an", "equivariant", "atom", "representation", "by", "aggregating", "the", "edge", "information", ",", "(", "x", "x", "x", "(", "p", ")", "i", "-", "x", "x", "x", "(", "p", ")", "j", ")", "\u2022", "z", "z", "z", "(", "p", ")", "i", ",", "within", "cutoff", "distance", "c", "."], ["Finally", ",", "we", "adopt", "an", "equivariant", "MPNN", "layer", "to", "get", "the", "atom-level", "force", "as", ":", "EQUATION", "The", "ultimate", "force", "predictions", "for", "each", "atom", "include", "two", "parts", ":", "the", "internal", "force", "from", "the", "molecule", "vec", "(", "l", ")", "i", "and", "the", "external", "force", "from", "the", "protein-ligand", "interaction", "vec", "(", "pl", ")", "i", "j", "."], ["So", "sum", "them", "up", ",", "we", "have", ":", "EQUATION", "These", "three", "modules", "consist", "BindingNet", "."], ["The", "BindingNet", "introduced", "in", "Sections", "3.1", "and", "3.2", "takes", "in", "the", "molecular", "system", "geometry", "at", "time", "t", "and", "outputs", "the", "forces", "."], ["Then", "in", "this", "section", ",", "we", "describe", "how", "we", "use", "the", "neural", "differential", "equation", "solver", "to", "predict", "the", "coordinates", "at", "future", "snapshots", "."], ["We", "want", "to", "highlight", "that", "one", "ML", "for", "MD", "simulation", "research", "line", "is", "predicting", "the", "energy", "or", "force", "[", "36", ",", "23", ",", "9", "]", ",", "which", "will", "be", "fed", "into", "the", "numerical", "integration", "algorithms", "for", "trajectory", "simulation", "."], ["For", "accuracy", ",", "such", "an", "ML-based", "MD", "simulation", "must", "be", "at", "the", "femtosecond", "level", "(", "1e", "-", "15", "second", ")", "."], ["However", ",", "as", "shown", "in", "recent", "works", "[", "37", ",", "38", ",", "21", "]", ",", "minor", "errors", "in", "the", "ML", "force", "field", "can", "lead", "to", "catastrophic", "failure", "for", "long-time", "simulations", "."], ["In", "this", "paper", ",", "however", ",", "we", "overcome", "this", "issue", "by", "directly", "learning", "the", "extended-timescale", "MD", "trajectories", "(", "nanosecond", "level", ",", "1e", "-", "9", "second", ")", "."], ["Newtonian", "dynamics", "and", "Langevin", "dynamics", "for", "MD", "simulation", "."], ["For", "modeling", ",", "we", "consider", "using", "the", "BindingNet", "introduced", "above", "for", "force", "prediction", "at", "time", "\u03c4", ",", "as", ":", "EQUATION", "On", "the", "other", "hand", ",", "Langevin", "dynamics", "introduces", "a", "stochastic", "component", "for", "large", "molecular", "systems", "with", "thermal", "fluctuations", "."], ["Ultimately", ",", "adopting", "either", "F", "(", "l", ")", "\u03c4", "-", "ODE", "or", "F", "(", "l", ")", "\u03c4", "-", "SDE", "as", "the", "force", "prediction", "F", "(", "l", ")", "\u03c4", "on", "each", "atom", ",", "the", "coordinates", "at", "time", "t", "can", "be", "obtained", "after", "integration", "as", ":", "EQUATION", ")", "The", "training", "objective", "is", "the", "mean", "absolute", "error", "(", "MAE", ")", "between", "the", "predicted", "coordinates", "and", "ground-truth", "coordinates", "along", "the", "whole", "trajectories", ":", "EQUATION", ")", "An", "illustration", "of", "NeuralMD", "pipeline", "is", "in", "Figure", "4", "."], ["Adjoint", "method", "."], ["Specifically", "for", "protein-ligand", "complexes", "with", "a", "large", "volume", "of", "atoms", ",", "the", "memory", "costs", "have", "become", "a", "main", "challenge", "."], ["To", "handle", "this", ",", "we", "consider", "the", "adjoint", "method", "[", "28", "]", ",", "allowing", "small", "step", "sizes", "in", "the", "integration", "."], ["Roughly", "speaking", ",", "the", "adjoint", "method", "calculates", "the", "variational", "derivative", "of", "the", "trajectory", "w.r.t", ".", "our", "objective", "function", "directly", "."], ["Second-order", "differential", "equation", "."], ["The", "key", "module", "of", "the", "neural", "differential", "method", "is", "the", "differential", "function", "[", "28", "]", ",", "which", "returns", "the", "first-order", "derivative", "."], ["To", "learn", "the", "MD", "trajectory", "following", "second-order", "ODE", "and", "SDE", ",", "we", "propose", "the", "following", "formulation", "of", "the", "second-order", "equation", "within", "one", "integration", "call", ":", "EQUATION", ")", "We", "mark", "this", "as", "\"", "func", "\"", "in", "Figure", "4", "."], ["This", "means", "we", "can", "augment", "ODE", "or", "SDE", "derivative", "space", "by", "concurrently", "calculating", "the", "accelerations", "and", "velocities", ",", "allowing", "simultaneous", "integration", "of", "velocities", "and", "positions", "."], ["In", "this", "section", ",", "we", "would", "like", "to", "include", "extra", "details", "of", "NeuralMD", "."], ["As", "in", "Equations", "(", "11", ")", "and", "(", "13", ")", ",", "both", "the", "coordinates", "and", "velocities", "are", "required", "inputs", "for", "NeuralMD", "."], ["To", "handle", "this", "issue", ",", "we", "propose", "a", "surrogate", "velocity", ",", "which", "is", "a", "summation", "of", "a", "predicted", "velocity", "by", "an", "extra", "equivariant", "model", "and", "a", "coordinate", "momentum", ",", "i.e", ".", ",", "v", "v", "v", "(", "l", ")", "t", "=", "BindingNet-Ligand", "(", "f", "(", "l", ")", ",", "x", "x", "x", "(", "l", ")", "t", ")", "+", "(", "x", "x", "x", "(", "l", ")", "t", "+", "1", "-", "x", "x", "x", "(", "l", ")", "t", ")", ",", "where", "the", "BindingNet-Ligand", "is", "the", "ligand", "model", "described", "in", "Section", "3.2", "."], ["Update", "model", "BindingNet", "using", "gradient", "descent", ".", "9", ":", "end", "for", "10", ":", "end", "for", "4", "Experiments", "Datasets", "."], ["One", "of", "the", "main", "bottlenecks", "of", "studying", "ML", "for", "molecular", "dynamics", "simulation", "in", "protein-ligand", "binding", "is", "insufficient", "data", "."], ["Recently", ",", "the", "community", "has", "put", "more", "effort", "into", "gathering", "the", "datasets", ",", "and", "we", "consider", "MISATO", "in", "our", "work", "[", "10", "]", "."], ["It", "is", "built", "on", "16,972", "experimental", "protein-ligand", "complexes", "extracted", "from", "the", "protein", "data", "bank", "(", "PDB", ")", "[", "39", "]", "."], ["Such", "data", "is", "obtained", "using", "X-ray", "crystallography", ",", "Nuclear", "Magnetic", "Resonance", "(", "NMR", ")", ",", "or", "Cryo-Electron", "Microscopy", "(", "Cryo-EM", ")", ",", "where", "systematic", "errors", "are", "unavoidable", "."], ["For", "each", "protein-ligand", "complex", ",", "the", "trajectory", "comprises", "100", "snapshots", "in", "8", "nanoseconds", "under", "the", "fixed", "temperature", "and", "pressure", "."], ["In", "Appendix", "E", ",", "we", "list", "the", "basic", "statistics", "of", "MISATO", ",", "e.g", ".", ",", "the", "number", "of", "atoms", "in", "small", "molecule", "ligands", ",", "and", "the", "number", "of", "residues", "in", "proteins", "."], ["Using", "ML", "for", "energy", "and", "force", "prediction", ",", "followed", "by", "trajectory", "prediction", "using", "numerical", "integration", "method", ",", "has", "been", "widely", "explored", "in", "the", "community", ",", "e.g", ".", ",", "HDNNPs", "[", "7", "]", ",", "DeePMD", "[", "9", "]", ",", "TorchMD", "[", "36", "]", ",", "and", "Allegro-LAMMPS", "[", "23", "]", "."], ["Here", "we", "extend", "this", "paradigm", "for", "binding", "dynamics", "and", "propose", "VerletMD", ",", "which", "utilizes", "BindingNet", "for", "energy", "prediction", "on", "each", "snapshot", "and", "velocity", "Verlet", "algorithm", "to", "get", "the", "trajectory", "."], ["Additionally", ",", "we", "mainly", "focus", "on", "ML", "methods", "for", "trajectory", "prediction", "in", "this", "work", ",", "i.e", ".", ",", "no", "energy", "or", "force", "is", "considered", "as", "labels", "."], ["GNN-MD", "is", "to", "apply", "geometric", "graph", "neural", "networks", "(", "GNNs", ")", "to", "predict", "the", "trajectories", "in", "an", "auto-regressive", "manner", "[", "10", ",", "24", "]", "."], ["More", "concretely", ",", "GNN-MD", "takes", "the", "coordinates", "and", "other", "molecular", "information", "as", "inputs", "at", "time", "t", "and", "predicts", "the", "coordinates", "at", "time", "t", "+", "1", "."], ["DenoisingLD", "(", "denoising", "diffusion", "for", "Langevin", "dynamics", ")", "[", "24", ",", "25", ",", "26", "]", "is", "a", "baseline", "method", "that", "models", "the", "trajectory", "prediction", "as", "denoising", "diffusion", "task", "[", "40", "]", ",", "and", "the", "inference", "for", "binding", "trajectory", "essentially", "becomes", "the", "Langevin", "dynamics", "."], ["Here", ",", "to", "make", "the", "comparison", "more", "explicit", ",", "we", "compare", "these", "two", "methods", "(", "GNN-MD", "and", "DenoisingLD", ")", "separately", "."], ["We", "want", "to", "highlight", "that", "we", "keep", "the", "same", "backbone", "model", ",", "BindingNet", ",", "for", "energy", "or", "force", "prediction", "for", "all", "the", "baselines", "and", "NeuralMD", "."], ["To", "evaluate", "this", ",", "we", "take", "both", "the", "mean", "absolute", "error", "(", "MAE", ")", "and", "mean", "squared", "error", "(", "MSE", ")", "between", "the", "predicted", "coordinates", "and", "ground-truth", "coordinates", "over", "all", "snapshots", "."], ["Stability", ",", "as", "highlighted", "in", "[", "21", "]", ",", "is", "an", "important", "metric", "for", "evaluating", "the", "predicted", "MD", "trajectory", "."], ["The", "intuition", "is", "that", "the", "prediction", "on", "long-time", "MD", "trajectory", "can", "enter", "a", "pathological", "state", "(", "e.g", ".", ",", "bond", "breaking", ")", ",", "and", "stability", "is", "the", "measure", "to", "quantify", "such", "observation", "."], ["Another", "metric", "considered", "is", "frames", "per", "second", "(", "FPS", ")", "[", "21", "]", "on", "a", "single", "Nvidia-V100", "GPU", "card", ",", "and", "it", "measures", "the", "MD", "efficiency", "."], ["The", "first", "observation", "is", "that", "the", "baseline", "VertletMD", "has", "a", "clear", "performance", "gap", "compared", "to", "the", "other", "methods", "."], ["There", "are", "two", "possible", "reasons", ":", "(", "1", ")", "Using", "ML", "models", "to", "predict", "the", "energy", "(", "or", "force", ")", "at", "each", "snapshot", ",", "and", "then", "using", "a", "numerical", "integration", "algorithm", "can", "fail", "in", "the", "long-time", "simulations", "[", "21", "]", ";", "(", "2", ")", "ML", "for", "energy", "prediction", "methods", "require", "more", "data", "to", "train", "than", "the", "ML", "for", "coordinate", "prediction", "methods", ",", "thus", "they", "can", "perform", "worse", "in", "the", "low-data", "regime", "here", "."], ["However", ",", "the", "stability", "(", "%", ")", "can", "be", "a", "distinctive", "factor", "in", "method", "comparisons", ",", "where", "we", "observe", "the", "two", "variants", "of", "NeuralMD", "outperform", "on", "all", "10", "tasks", "up", "to", "~", "80%", "."], ["It", "is", "shown", "that", "the", "GNN-MD", "collapses", "occasionally", ",", "while", "DenoisingLD", "stays", "comparatively", "structured", "."], ["Meanwhile", ",", "NeuralMD", "is", "the", "most", "stable", "in", "all", "cases", "."], ["One", "main", "benefit", "of", "using", "NeuralMD", "for", "binding", "simulation", "is", "its", "efficiency", "."], ["We", "further", "approximate", "the", "wall", "time", "of", "the", "numerical", "method", "for", "MD", "simulation", "(", "PDB", "5WIJ", ")", "."], ["A", "more", "challenging", "task", "is", "to", "test", "the", "generalization", "ability", "of", "NeuralMD", "among", "different", "trajectories", "."], ["The", "MISATO", "dataset", "includes", "13,765", "protein-ligand", "complexes", ",", "and", "we", "first", "create", "two", "small", "datasets", "by", "randomly", "sampling", "100", "and", "1k", "complexes", ",", "respectively", "."], ["We", "also", "consider", "the", "whole", "MISATO", "dataset", ",", "where", "the", "data", "split", "has", "already", "been", "provided", "."], ["First", ",", "we", "can", "observe", "that", "VerletMD", "has", "worse", "performance", "on", "all", "three", "datasets", ",", "and", "the", "performance", "gap", "with", "other", "methods", "is", "even", "larger", "compared", "to", "the", "single-trajectory", "prediction", "."], ["The", "other", "two", "baselines", ",", "GNN-MD", "and", "DenoisingLD", ",", "show", "similar", "performance", ",", "while", "NeuralMD", "outperforms", "in", "all", "datasets", "."], ["Notice", "that", "stability", "(", "%", ")", "remains", "more", "distinguishable", "than", "the", "two", "trajectory", "recovery", "metrics", "(", "MAE", "and", "MSE", ")", "."], ["To", "sum", "up", ",", "we", "devise", "NeuralMD", ",", "an", "ML", "framework", "that", "incorporates", "a", "novel", "multi-grained", "group", "symmetric", "network", "architecture", "and", "second-order", "Newtonian", "mechanics", ",", "enabling", "accurate", "predictions", "of", "binding", "dynamics", "in", "a", "large", "timescale", "."], ["Not", "only", "is", "such", "a", "timescale", "critical", "for", "understanding", "the", "dynamic", "nature", "of", "the", "ligand-protein", "complex", ",", "but", "our", "work", "marks", "the", "first", "approach", "in", "developing", "a", "framework", "to", "predict", "coordinates", "for", "MD", "simulation", "in", "protein-ligand", "binding", "."], ["We", "quantitatively", "and", "qualitatively", "verify", "that", "NeuralMD", "achieves", "superior", "performance", "on", "13", "binding", "dynamics", "tasks", "."], ["Currently", ",", "we", "are", "using", "the", "MISATO", "dataset", ",", "a", "protein-ligand", "dynamics", "dataset", "with", "a", "large", "timestep", "."], ["However", ",", "NeuralMD", "is", "agnostic", "to", "the", "timestep", ",", "and", "it", "can", "also", "be", "applied", "to", "binding", "dynamics", "datasets", "with", "timestep", "as", "a", "femtosecond", "."]], "ner": [[[1, 4, "Method"], [7, 10, "Task"], [12, 13, "Task"], [15, 16, "Method"], [18, 18, "Method"], [22, 23, "Task"], [29, 31, "Task"], [33, 35, "Task"], [38, 40, "Task"]], [[53, 54, "Task"], [66, 67, "Method"], [69, 69, "Method"]], [[80, 80, "Method"], [84, 84, "Method"], [89, 90, "Method"], [96, 97, "Task"]], [[107, 107, "Method"], [129, 132, "Method"]], [[148, 148, "Task"], [151, 153, "Task"]], [[163, 163, "Method"], [172, 174, "Task"], [179, 179, "Method"]], [[196, 196, "Method"], [205, 206, "Method"]], [[210, 211, "Method"], [213, 213, "Method"], [217, 218, "Task"], [226, 227, "Task"]], [[241, 242, "Task"], [244, 245, "Method"]], [[262, 263, "Method"], [265, 265, "Method"], [276, 277, "Method"], [280, 283, "Task"]], [[289, 289, "Method"], [292, 293, "Task"]], [[330, 331, "Task"]], [[342, 343, "Method"]], [[360, 361, "Method"], [373, 378, "Method"]], [[380, 380, "Method"]], [[399, 399, "Method"], [401, 401, "Method"]], [[416, 416, "Method"]], [[421, 421, "Method"], [423, 423, "Method"]], [[430, 430, "Method"]], [[471, 471, "Method"], [476, 477, "Task"], [480, 483, "Method"], [485, 485, "Method"], [488, 491, "Method"], [493, 493, "Method"]], [[504, 504, "Method"], [509, 509, "Task"], [512, 514, "Task"]], [[520, 520, "Method"], [524, 524, "Method"], [545, 545, "Method"]], [[571, 573, "Dataset"], [575, 575, "Dataset"]], [[603, 604, "Task"]], [[652, 654, "Task"]], [[658, 659, "Method"], [661, 661, "Method"]], [[713, 714, "Method"], [720, 721, "Method"], [723, 724, "Method"], [740, 741, "Method"], [747, 750, "Task"], [756, 757, "Method"], [762, 763, "Method"], [768, 770, "Method"], [772, 772, "Method"]], [[781, 783, "Method"], [796, 797, "Task"], [799, 800, "Task"], [825, 827, "Method"], [829, 830, "Task"]], [[845, 846, "Method"], [848, 850, "Method"]], [[851, 852, "Method"], [870, 871, "Method"]], [[903, 905, "Method"], [907, 907, "Method"], [912, 914, "Method"], [916, 916, "Method"], [920, 921, "Method"], [923, 924, "Method"]], [[934, 934, "Dataset"], [940, 941, "Method"], [943, 944, "Method"]], [[975, 976, "Task"]], [[996, 996, "Method"], [999, 1000, "Task"], [1004, 1004, "Method"], [1006, 1006, "Method"], [1022, 1023, "Task"]], [[1052, 1060, "Method"], [1062, 1062, "Method"]], [[1102, 1105, "Method"], [1107, 1107, "Method"], [1112, 1115, "Method"], [1117, 1117, "Method"]], [[1132, 1133, "Method"]], [[1169, 1169, "Method"], [1171, 1173, "Task"], [1181, 1181, "Method"], [1183, 1184, "Task"]], [[1203, 1203, "Method"], [1206, 1213, "Method"]], [[1233, 1238, "Method"]], [[1240, 1242, "Method"], [1244, 1244, "Task"]], [[1275, 1277, "Method"], [1297, 1298, "Method"]], [[1300, 1302, "Method"], [1304, 1305, "Task"]], [[1313, 1313, "Method"], [1316, 1324, "Method"], [1326, 1327, "Task"]], [[1332, 1332, "Method"]], [[1360, 1362, "Task"]], [[1368, 1369, "Method"], [1371, 1372, "Method"]], [[1406, 1408, "Method"], [1410, 1410, "Method"], [1417, 1417, "Method"], [1422, 1422, "Method"], [1428, 1429, "Method"], [1431, 1433, "Method"]], [[1457, 1458, "Method"]], [[1486, 1488, "Task"]], [[1492, 1495, "Task"]], [[1515, 1518, "Method"]], [[1557, 1557, "Method"], [1595, 1596, "Task"]], [[1617, 1617, "Method"]], [[1620, 1620, "Method"]], [[1652, 1655, "Method"], [1657, 1659, "Task"]], [[1670, 1670, "Method"], [1672, 1673, "Task"], [1696, 1698, "Method"], [1700, 1701, "Task"]], [[1708, 1710, "Task"]], [[1743, 1743, "Method"], [1752, 1753, "Task"]], [[1769, 1771, "Task"]], [[1782, 1783, "Method"], [1785, 1786, "Method"], [1788, 1789, "Task"]], [[1798, 1798, "Method"], [1802, 1803, "Task"], [1816, 1817, "Method"], [1824, 1825, "Method"], [1827, 1828, "Method"]], [[1840, 1840, "Method"], [1848, 1848, "Method"], [1851, 1852, "Task"], [1881, 1883, "Method"], [1885, 1885, "Method"], [1904, 1904, "Method"]], [[1911, 1912, "Method"]], [[1916, 1917, "Task"]], [[1941, 1942, "Method"]], [[1959, 1960, "Method"]], [[1975, 1977, "Method"]], [[1984, 1986, "Method"]], [[2004, 2005, "Task"], [2008, 2008, "Method"], [2010, 2010, "Method"]], [[2044, 2044, "Method"], [2046, 2046, "Method"]], [[2077, 2077, "Method"]], [[2099, 2099, "Method"]], [[2127, 2128, "Method"], [2141, 2141, "Method"], [2179, 2179, "Method"]], [[2191, 2191, "Method"]], [[2215, 2215, "Method"], [2217, 2219, "Task"], [2221, 2222, "Task"]], [[2243, 2243, "Dataset"]], [[2257, 2258, "Task"], [2262, 2264, "Dataset"], [2266, 2266, "Dataset"]], [[2277, 2278, "Method"], [2280, 2282, "Method"], [2284, 2284, "Method"], [2288, 2289, "Method"], [2291, 2291, "Method"]], [[2302, 2303, "Task"]], [[2330, 2330, "Dataset"]], [[2353, 2353, "Method"], [2357, 2358, "Task"], [2362, 2363, "Task"], [2365, 2367, "Method"], [2380, 2380, "Method"], [2385, 2385, "Method"], [2390, 2390, "Method"], [2396, 2396, "Method"]], [[2411, 2411, "Method"], [2415, 2415, "Method"], [2417, 2418, "Task"], [2423, 2425, "Method"]], [[2437, 2437, "Method"], [2440, 2441, "Task"]], [[2458, 2458, "Method"], [2463, 2465, "Method"], [2467, 2467, "Method"], [2470, 2472, "Task"]], [[2486, 2486, "Method"]], [[2509, 2509, "Method"], [2511, 2515, "Method"], [2531, 2532, "Task"], [2534, 2536, "Task"], [2545, 2546, "Task"]], [[2568, 2568, "Method"], [2570, 2570, "Method"]], [[2586, 2586, "Method"], [2591, 2592, "Task"], [2598, 2598, "Method"]], [[2608, 2610, "Method"], [2612, 2612, "Method"], [2615, 2617, "Method"], [2619, 2619, "Method"]], [[2648, 2650, "Task"]], [[2659, 2661, "Task"]], [[2709, 2709, "Method"]], [[2719, 2719, "Method"]], [[2741, 2741, "Method"], [2744, 2746, "Task"], [2759, 2761, "Method"], [2766, 2767, "Task"], [2775, 2775, "Method"], [2777, 2778, "Task"], [2787, 2787, "Method"], [2789, 2790, "Task"]], [[2827, 2827, "Method"]], [[2843, 2843, "Method"], [2848, 2848, "Method"]], [[2855, 2855, "Method"]], [[2869, 2869, "Method"]], [[2885, 2886, "Method"], [2888, 2889, "Task"], [2891, 2892, "Dataset"]], [[2906, 2906, "Method"]], [[2912, 2912, "Dataset"]], [[2941, 2941, "Dataset"]], [[2959, 2959, "Method"], [2981, 2982, "Task"]], [[2989, 2989, "Method"], [2991, 2991, "Method"], [2998, 2998, "Method"]], [[3020, 3020, "Method"], [3022, 3022, "Method"]], [[3031, 3031, "Method"], [3034, 3034, "Method"], [3040, 3043, "Method"], [3054, 3055, "Task"]], [[3093, 3094, "Task"], [3096, 3097, "Task"]], [[3105, 3105, "Method"], [3111, 3112, "Task"]], [[3121, 3121, "Dataset"], [3125, 3126, "Task"]], [[3135, 3135, "Method"], [3149, 3150, "Task"]]], "relations": [[[1, 4, 7, 10, "Used-For"], [7, 10, 12, 13, "SubTask-Of"], [1, 4, 12, 13, "Used-For"], [18, 18, 15, 16, "Synonym-Of"], [15, 16, 22, 23, "Used-For"], [15, 16, 29, 31, "Used-For"], [15, 16, 33, 35, "Used-For"], [15, 16, 38, 40, "Used-For"]], [[66, 67, 53, 54, "Used-For"], [69, 69, 66, 67, "Synonym-Of"]], [[80, 80, 84, 84, "SubClass-Of"], [80, 80, 96, 97, "Used-For"]], [], [], [[163, 163, 179, 179, "Compare-With"]], [[196, 196, 205, 206, "Compare-With"]], [[213, 213, 210, 211, "Synonym-Of"], [210, 211, 217, 218, "Used-For"], [217, 218, 226, 227, "SubTask-Of"], [210, 211, 226, 227, "Used-For"]], [[244, 245, 241, 242, "Used-For"]], [[265, 265, 262, 263, "Synonym-Of"], [262, 263, 280, 283, "Used-For"], [276, 277, 280, 283, "Used-For"]], [[289, 289, 292, 293, "Used-For"]], [], [], [], [], [], [], [[423, 423, 421, 421, "SubClass-Of"]], [], [[488, 491, 471, 471, "Part-Of"], [480, 483, 471, 471, "Part-Of"], [480, 483, 476, 477, "Used-For"], [488, 491, 476, 477, "Used-For"], [485, 485, 480, 483, "Synonym-Of"], [493, 493, 488, 491, "Synonym-Of"]], [[504, 504, 509, 509, "Used-For"], [504, 504, 512, 514, "Used-For"]], [[520, 520, 524, 524, "Compare-With"]], [[575, 575, 571, 573, "Synonym-Of"]], [], [], [[661, 661, 658, 659, "Synonym-Of"]], [[720, 721, 713, 714, "SubClass-Of"], [723, 724, 713, 714, "SubClass-Of"], [740, 741, 747, 750, "Used-For"], [756, 757, 747, 750, "Used-For"], [768, 770, 756, 757, "Part-Of"], [740, 741, 756, 757, "Compare-With"], [762, 763, 756, 757, "Part-Of"], [768, 770, 762, 763, "SubClass-Of"], [772, 772, 768, 770, "Synonym-Of"]], [[781, 783, 796, 797, "Used-For"], [781, 783, 799, 800, "Used-For"], [825, 827, 829, 830, "Used-For"]], [], [[851, 852, 870, 871, "Compare-With"]], [[907, 907, 903, 905, "Synonym-Of"], [916, 916, 912, 914, "Synonym-Of"], [903, 905, 920, 921, "Part-Of"], [912, 914, 923, 924, "Part-Of"]], [[940, 941, 934, 934, "Evaluated-With"], [943, 944, 940, 941, "Part-Of"]], [], [[996, 996, 999, 1000, "Used-For"]], [[1062, 1062, 1052, 1060, "SubClass-Of"]], [[1107, 1107, 1102, 1105, "Synonym-Of"], [1117, 1117, 1112, 1115, "Synonym-Of"]], [], [[1169, 1169, 1171, 1173, "Used-For"], [1181, 1181, 1183, 1184, "Used-For"]], [[1203, 1203, 1206, 1213, "SubClass-Of"]], [], [[1240, 1242, 1244, 1244, "Used-For"]], [], [[1300, 1302, 1304, 1305, "Used-For"]], [[1313, 1313, 1316, 1324, "SubClass-Of"], [1313, 1313, 1326, 1327, "Used-For"]], [], [], [[1371, 1372, 1368, 1369, "Part-Of"]], [[1410, 1410, 1406, 1408, "Synonym-Of"], [1417, 1417, 1406, 1408, "Part-Of"], [1422, 1422, 1406, 1408, "Part-Of"], [1417, 1417, 1428, 1429, "Synonym-Of"], [1422, 1422, 1431, 1433, "Synonym-Of"]], [], [], [], [], [], [], [], [[1652, 1655, 1657, 1659, "Used-For"]], [[1670, 1670, 1672, 1673, "Used-For"], [1696, 1698, 1700, 1701, "Used-For"]], [], [], [], [[1785, 1786, 1788, 1789, "Used-For"], [1782, 1783, 1788, 1789, "Used-For"]], [[1798, 1798, 1802, 1803, "Used-For"], [1827, 1828, 1824, 1825, "Part-Of"]], [[1840, 1840, 1851, 1852, "Used-For"], [1848, 1848, 1851, 1852, "Used-For"], [1885, 1885, 1881, 1883, "Synonym-Of"]], [], [], [], [], [], [], [[2008, 2008, 2004, 2005, "Used-For"], [2010, 2010, 2004, 2005, "Used-For"]], [], [], [], [], [], [[2215, 2215, 2217, 2219, "Used-For"], [2217, 2219, 2221, 2222, "SubTask-Of"]], [], [[2262, 2264, 2257, 2258, "Benchmark-For"], [2266, 2266, 2262, 2264, "Synonym-Of"]], [[2284, 2284, 2280, 2282, "Synonym-Of"], [2291, 2291, 2288, 2289, "Synonym-Of"]], [], [], [[2353, 2353, 2357, 2358, "Used-For"], [2365, 2367, 2362, 2363, "Used-For"], [2380, 2380, 2362, 2363, "Used-For"], [2385, 2385, 2362, 2363, "Used-For"], [2390, 2390, 2362, 2363, "Used-For"], [2396, 2396, 2362, 2363, "Used-For"], [2380, 2380, 2365, 2367, "SubClass-Of"], [2385, 2385, 2365, 2367, "SubClass-Of"], [2390, 2390, 2365, 2367, "SubClass-Of"], [2396, 2396, 2365, 2367, "SubClass-Of"]], [[2415, 2415, 2411, 2411, "Part-Of"], [2423, 2425, 2411, 2411, "Part-Of"], [2415, 2415, 2417, 2418, "Used-For"]], [[2437, 2437, 2440, 2441, "Used-For"]], [[2463, 2465, 2458, 2458, "Part-Of"], [2467, 2467, 2463, 2465, "Synonym-Of"], [2458, 2458, 2470, 2472, "Used-For"]], [], [[2509, 2509, 2511, 2515, "Synonym-Of"], [2509, 2509, 2531, 2532, "Used-For"], [2509, 2509, 2534, 2536, "Used-For"], [2509, 2509, 2545, 2546, "Used-For"]], [[2568, 2568, 2570, 2570, "Compare-With"]], [[2598, 2598, 2591, 2592, "Used-For"], [2586, 2586, 2591, 2592, "Used-For"]], [[2612, 2612, 2608, 2610, "Synonym-Of"], [2619, 2619, 2615, 2617, "Synonym-Of"]], [], [], [], [], [[2741, 2741, 2744, 2746, "Used-For"], [2759, 2761, 2766, 2767, "Used-For"], [2775, 2775, 2777, 2778, "Used-For"], [2787, 2787, 2789, 2790, "Used-For"]], [], [[2843, 2843, 2848, 2848, "Compare-With"]], [], [], [[2885, 2886, 2888, 2889, "Used-For"], [2891, 2892, 2888, 2889, "Benchmark-For"], [2885, 2886, 2891, 2892, "Evaluated-With"]], [], [], [], [[2959, 2959, 2981, 2982, "Used-For"]], [[2998, 2998, 2989, 2989, "Compare-With"], [2998, 2998, 2991, 2991, "Compare-With"]], [], [[3040, 3043, 3031, 3031, "Part-Of"], [3031, 3031, 3034, 3034, "SubClass-Of"], [3031, 3031, 3054, 3055, "Used-For"]], [[3093, 3094, 3096, 3097, "SubTask-Of"]], [[3105, 3105, 3111, 3112, "Used-For"]], [[3121, 3121, 3125, 3126, "Benchmark-For"]], [[3135, 3135, 3149, 3150, "Used-For"]]]}
{"doc_id": "CVPR2023", "doc_tokens": ["3D", "Registration", "with", "Maximal", "Cliques", "As", "a", "fundamental", "problem", "in", "computer", "vision", ",", "3D", "point", "cloud", "registration", "(", "PCR", ")", "aims", "to", "seek", "the", "optimal", "pose", "to", "align", "a", "point", "cloud", "pair", ".", "In", "this", "paper", ",", "we", "present", "a", "3D", "registration", "method", "with", "maximal", "cliques", "(", "MAC", ")", ".", "The", "key", "insight", "is", "to", "loosen", "the", "previous", "maximum", "clique", "constraint", ",", "and", "mine", "more", "local", "consensus", "information", "in", "a", "graph", "for", "accurate", "pose", "hypotheses", "generation", ":", "1", ")", "A", "compatibility", "graph", "is", "constructed", "to", "render", "the", "affinity", "relationship", "between", "initial", "correspondences", ".", "2", ")", "We", "search", "for", "maximal", "cliques", "in", "the", "graph", ",", "each", "of", "which", "represents", "a", "consensus", "set", ".", "We", "perform", "node-guided", "clique", "selection", "then", ",", "where", "each", "node", "corresponds", "to", "the", "maximal", "clique", "with", "the", "greatest", "graph", "weight", ".", "3", ")", "Transformation", "hypotheses", "are", "computed", "for", "the", "selected", "cliques", "by", "the", "SVD", "algorithm", "and", "the", "best", "hypothesis", "is", "used", "to", "perform", "registration", ".", "Extensive", "experiments", "on", "U3M", ",", "3DMatch", ",", "3DLoMatch", "and", "KITTI", "demonstrate", "that", "MAC", "effectively", "increases", "registration", "accuracy", ",", "outperforms", "various", "state-of-the-art", "methods", "and", "boosts", "the", "performance", "of", "deep-learned", "methods", ".", "MAC", "combined", "with", "deep-learned", "methods", "achieves", "stateof-the-art", "registration", "recall", "of", "95.7%", "/", "78.9%", "on", "3DMatch", "/", "3DLoMatch", ".", "Given", "two", "3D", "scans", "of", "the", "same", "object", "(", "or", "scene", ")", ",", "the", "goal", "of", "PCR", "is", "to", "estimate", "a", "six-degree-of-freedom", "(", "6", "-", "DoF", ")", "pose", "transformation", "that", "accurately", "aligns", "the", "two", "input", "point", "clouds", ".", "Using", "pointto-point", "feature", "correspondences", "is", "a", "popular", "and", "robust", "solution", "to", "the", "PCR", "problem", ".", "The", "problem", "of", "3D", "registration", "by", "handling", "correspondences", "with", "outliers", "has", "been", "studied", "for", "decades", ".", "We", "classify", "them", "into", "geometric-only", "and", "deep-learned", "methods", ".", "For", "geometric-only", "methods", "[", "5", ",", "6", ",", "21", ",", "30", ",", "31", ",", "[", "38", "]", "[", "39", "]", "[", "40", "]", "[", "41", "]", ",", "random", "sample", "consensus", "(", "RANSAC", ")", "and", "its", "variants", "perform", "an", "iterative", "sampling", "strategy", "for", "registration", ".", "Although", "RANSAC-based", "methods", "are", "simple", "and", "efficient", ",", "their", "performance", "is", "highly", "vulnerable", "when", "the", "outlier", "rate", "increases", ",", "and", "it", "requires", "a", "large", "number", "of", "iterations", "to", "obtain", "acceptable", "results", ".", "Also", ",", "a", "series", "of", "global", "registration", "methods", "based", "on", "branch-and-bound", "(", "BnB", ")", "are", "proposed", "to", "search", "the", "6D", "parameter", "space", "and", "obtain", "the", "optimal", "global", "solution", ".", "Except", "for", "this", "watermark", ",", "it", "is", "identical", "to", "the", "accepted", "version", ";", "the", "final", "published", "version", "of", "the", "proceedings", "is", "available", "on", "IEEE", "Xplore", ".", "one", "module", "in", "the", "registration", "process", ",", "such", "as", "investigating", "more", "discriminate", "keypoint", "feature", "descriptors", "or", "more", "effective", "correspondence", "selection", "techniques", ",", "while", "the", "others", "[", "22", ",", "29", ",", "43", "]", "focus", "on", "registration", "in", "an", "end-to-end", "manner", ".", "However", ",", "deep-learned", "based", "methods", "require", "a", "large", "amount", "of", "data", "for", "training", "and", "usually", "lack", "generalization", "on", "different", "datasets", ".", "In", "this", "paper", ",", "we", "propose", "a", "geometric-only", "3D", "registration", "method", "based", "on", "maximal", "cliques", "(", "MAC", ")", ".", "The", "key", "insight", "is", "to", "loosen", "the", "previous", "maximum", "clique", "constraint", ",", "and", "mine", "more", "local", "consensus", "information", "in", "a", "graph", "to", "generate", "accurate", "pose", "hypotheses", ".", "Compared", "with", "the", "maximum", "clique", ",", "MAC", "is", "a", "looser", "constraint", "and", "is", "able", "to", "mine", "more", "local", "information", "in", "a", "graph", ".", "Finally", ",", "transformation", "hypotheses", "are", "computed", "for", "the", "selected", "cliques", "by", "the", "SVD", "algorithm", ".", "The", "best", "hypothesis", "is", "selected", "to", "perform", "registration", "using", "popular", "hypothesis", "evaluation", "metrics", "in", "the", "RANSAC", "family", ".", "To", "summarize", ",", "our", "main", "contributions", "are", "as", "follows", ":", "\u2022", "We", "introduce", "a", "hypothesis", "generation", "method", "named", "MAC", ".", "Our", "MAC", "method", "is", "able", "to", "mine", "more", "local", "information", "in", "a", "graph", ",", "compared", "with", "the", "previous", "maximum", "clique", "constraint", ".", "Notably", ",", "our", "geometric-only", "MAC", "method", "outperforms", "several", "state-of-the-art", "deep", "learning", "methods", "[", "3", ",", "9", ",", "19", ",", "27", "]", ".", "MAC", "can", "also", "be", "inserted", "as", "a", "module", "into", "multiple", "deep-learned", "frameworks", "[", "1", ",", "10", ",", "18", ",", "29", ",", "43", "]", "to", "boost", "their", "performance", ".", "MAC", "combined", "with", "GeoTransformer", "achieves", "the", "state-of-the-art", "registration", "recall", "of", "95.7%", "/", "78.9%", "on", "3DMatch", "/", "3DLoMatch", ".", "Various", "geometric-only", "methods", "[", "6", ",", "8", ",", "20", ",", "36", ",", "45", "]", "have", "been", "proposed", "recently", ".", "Typically", ",", "RANSAC", "and", "its", "variants", "[", "5", ",", "13", ",", "30", ",", "31", ",", "[", "38", "]", "[", "39", "]", "[", "40", "]", "remain", "the", "dominant", "approaches", "to", "the", "problem", "of", "estimating", "a", "6", "-", "DoF", "pose", "from", "correspondences", ".", "RANSAC", "iteratively", "samples", "correspondences", "from", "the", "initial", "set", ",", "generating", "and", "evaluating", "geometric", "estimations", "for", "each", "subset", "until", "a", "satisfactory", "solution", "is", "obtained", ".", "Efficient", "and", "robust", "evaluation", "metrics", "are", "extremely", "important", "for", "using", "RANSAC", "to", "achieve", "accurate", "registration", ".", "To", "address", "the", "current", "problems", "of", "timeconsuming", "and", "noise-sensitive", "evaluation", "metrics", ",", "[", "40", "]", "analyzes", "the", "contribution", "of", "inliers", "and", "outliers", "during", "the", "computation", "and", "proposed", "several", "metrics", "that", "can", "effectively", "improve", "the", "registration", "performance", "of", "RANSAC", ".", "For", "example", ",", "Rusu", "et", "al", ".", "[", "31", "]", "presented", "the", "simple", "consensus-based", "initial", "alignment", "(", "SAC-IA", ")", "method", ",", "which", "samples", "correspondences", "spread", "out", "on", "the", "point", "cloud", "and", "leverages", "the", "Huber", "penalty", "for", "evaluation", ".", "Graph", "cut", "RANSAC", "(", "GC-RANSAC", ")", "[", "5", "]", "uses", "the", "graph-cut", "algorithm", "before", "model", "re-fitting", "in", "the", "local", "optimization", "step", ".", "Compatibility-guided", "sample", "consensus", "(", "CG-SAC", ")", "[", "30", "]", "additionally", "considers", "the", "normal", "information", "of", "key", "points", "during", "the", "sampling", "process", ".", "Yang", "et", "al", ".", "[", "39", "]", "proposed", "the", "sample", "consensus", "by", "sampling", "compatibility", "triangles", "(", "SAC-COT", ")", "method", ",", "which", "generates", "estimations", "by", "ranking", "and", "sampling", "ternary", "loops", "from", "the", "compatibility", "graph", ".", "A", "series", "of", "globally", "optimal", "methods", "based", "on", "BnB", "have", "been", "proposed", "recently", ".", "Yang", "et", "al", ".", "[", "41", "]", "proposed", "globally", "optimal", "ICP", "(", "GO-ICP", ")", ",", "which", "rationalizes", "the", "planning", "of", "ICP", "update", "tasks", "at", "different", "stages", ",", "and", "its", "biggest", "advantage", "is", "that", "it", "minimizes", "the", "local", "optimum", ".", "Bustos", "and", "Chin", "[", "6", "]", "presented", "guaranteed", "outlier", "removal", "(", "GORE", ")", ",", "which", "calculates", "the", "tight", "lower", "bound", "and", "tight", "upper", "bound", "for", "each", "correspondence", "and", "reduces", "the", "size", "of", "correspondence", "set", "by", "rejecting", "true", "outliers", ".", "Motivated", "by", "GORE", ",", "Li", "[", "21", "]", "proposed", "a", "polynomial", "time", "outlier", "removal", "method", ",", "which", "seeks", "the", "tight", "lower", "and", "upper", "bound", "by", "calculating", "the", "costs", "of", "correspondence", "matrix", "(", "CM", ")", "and", "augmented", "correspondence", "matrix", "(", "ACM", ")", ".", "However", ",", "BnB", "techniques", "are", "sensitive", "to", "the", "cardinality", "of", "the", "input", "and", "are", "time-consuming", "for", "large-scale", "inputs", ".", "In", "addition", "to", "geometric-only", "methods", ",", "recent", "works", "also", "adopt", "deep", "learning", "techniques", "to", "perform", "PCR", ".", "FCGF", "[", "10", "]", "computes", "the", "features", "in", "a", "single", "pass", "through", "a", "fully", "convolutional", "neural", "network", "without", "keypoint", "detection", ".", "D3Feat", "[", "4", "]", "uses", "a", "fully", "convolutional", "network", "to", "obtain", "local", "information", "of", "point", "clouds", "and", "a", "joint", "learning", "framework", "to", "achieve", "3D", "local", "feature", "detection", "and", "description", ".", "Predator", "[", "18", "]", "applies", "an", "attention", "mechanism", "to", "extract", "salient", "points", "in", "overlapping", "regions", "of", "the", "point", "clouds", ",", "thus", "achieving", "robust", "registration", "in", "the", "presence", "of", "low", "overlap", "rates", ".", "Spinnet", "[", "1", "]", "extracts", "local", "features", "which", "are", "rotationally", "invariant", "and", "sufficiently", "informative", "to", "enable", "accurate", "registration", ".", "Deep", "global", "registration", "(", "DGR", ")", "[", "9", "]", "and", "3DReg-Net", "[", "27", "]", "classify", "a", "given", "correspondence", "by", "training", "endto-end", "neural", "networks", "and", "using", "operators", "such", "as", "sparse", "convolution", "and", "point-by-point", "MLP", ".", "PointDSC", "[", "3", "]", "explicitly", "explores", "spatial", "consistency", "for", "removing", "outlier", "correspondences", "and", "3D", "point", "cloud", "registration", ".", "Fu", "et", "al", ".", "[", "14", "]", "proposed", "a", "registration", "framework", "that", "utilizes", "deep", "graph", "matching", "(", "RGM", ")", "that", "can", "find", "robust", "and", "accurate", "pointto-point", "correspondences", ".", "More", "recently", ",", "several", "methods", "[", "29", ",", "43", "]", "follow", "the", "detection-free", "methods", "and", "estimate", "the", "transformation", "in", "an", "end-to-end", "way", ".", "CoFiNet", "[", "43", "]", "extracts", "correspondences", "from", "coarse", "to", "fine", "without", "keypoint", "detection", ".", "GeoTransformer", "[", "29", "]", "learns", "geometric", "features", "for", "robust", "superpoint", "matching", "and", "is", "robust", "in", "low-overlap", "cases", "and", "invariant", "to", "rigid", "transformation", ".", "MAC", "(", "c1", ")", "=", "(", "c1", ",", "c3", ",", "c4", ",", "c5", ")", "MAC", "(", "c3", ")", "=", "(", "c1", ",", "c3", ",", "c4", ",", "c5", ")", "MAC", "(", "c2", ")", "=", "(", "c2", ",", "c6", ",", "c7", ")", "\u2026", "MAC", "(", "c9", ")", "=", "(", "c1", ",", "c9", ",", "c10", ")", "MAC", "(", "c10", ")", "=", "(", "c1", ",", "c9", ",", "c10", ")", "Node-guided", "maximal", "cliques", "c7", "c7", "c6", "c6", "c2", "c2", "c5", "c5", "c4", "c4", "c3", "c3", "c1", "c1", "R3", ",", "t3", "c10", "c10", "c9", "c9", "c1", "c1", "While", "deep", "learning", "techniques", "have", "demonstrated", "a", "great", "potential", "for", "PCR", ",", "these", "methods", "require", "a", "large", "amount", "of", "training", "data", "and", "their", "generalization", "is", "not", "always", "promising", ".", "By", "contrast", ",", "MAC", "does", "not", "require", "any", "training", "data", "and", "achieves", "more", "advanced", "performance", "than", "several", "deep-learned", "methods", ".", "Moreover", ",", "MAC", "can", "be", "served", "as", "a", "drop-on", "module", "in", "deep", "learning", "frameworks", "to", "boost", "their", "performance", ".", "An", "initial", "correspondence", "set", "C", "initial", "=", "{", "c", "}", "is", "formed", "by", "matching", "feature", "descriptors", ",", "where", "c", "=", "(", "p", "s", ",", "p", "t", ")", ".", "MAC", "estimates", "the", "6", "-", "DoF", "pose", "transformation", "between", "P", "s", "and", "P", "t", "from", "C", "initial", ".", "Here", ",", "we", "consider", "two", "approaches", "to", "construct", "a", "compatibility", "graph", ".", "\u2022", "First", "Order", "Graph", ".", "The", "first", "order", "graph", "(", "FOG", ")", "is", "constructed", "based", "on", "the", "rigid", "distance", "constraint", "between", "the", "correspondence", "pair", "(", "c", "i", ",", "c", "j", ")", ",", "which", "can", "be", "quantitatively", "measured", "as", ":", "EQUATION", "The", "compatibility", "score", "between", "c", "i", "and", "c", "j", "is", "given", "as", ":", "EQUATION", "where", "d", "cmp", "is", "a", "distance", "parameter", ".", "Since", "the", "compatibility", "graph", "is", "undirected", ",", "the", "weight", "matrix", "W", "F", "OG", "is", "symmetric", ".", "\u2022", "Second", "Order", "Graph", ".", "The", "second", "order", "graph", "(", "SOG", ")", "evolves", "from", "FOG", ".", "The", "weight", "matrix", "W", "SOG", "can", "be", "calculated", "as", ":", "EQUATION", "where", "\u2299", "represents", "the", "element-wise", "product", "between", "two", "matrices", ".", "In", "Sec", ".", "4.5", ",", "we", "experimentally", "compare", "FOG", "and", "SOG", "in", "our", "MAC", "framework", ".", "A", "maximal", "clique", "is", "a", "clique", "that", "cannot", "be", "extended", "by", "adding", "any", "nodes", ".", "In", "particular", ",", "the", "maximal", "clique", "with", "the", "most", "nodes", "is", "the", "maximum", "clique", "of", "a", "graph", ".", "Searching", "for", "Maximal", "cliques", ".", "To", "generate", "hypotheses", ",", "RANSAC-based", "methods", "repeatedly", "take", "random", "samples", "from", "the", "correspondence", "set", ".", "Previous", "works", "[", "23", ",", "24", ",", "28", ",", "36", "]", "focus", "on", "searching", "for", "maximum", "cliques", "in", "the", "graph", ",", "however", ",", "the", "maximum", "clique", "is", "a", "very", "tight", "constraint", "that", "only", "focuses", "on", "the", "global", "consensus", "information", "in", "a", "graph", ".", "Instead", ",", "we", "loosen", "the", "constraint", "and", "leverage", "maximal", "cliques", "to", "mine", "more", "local", "graph", "information", ".", "By", "using", "the", "igraph", "maximal", "cliques", "function", "in", "the", "igraph", "1", "C", "+", "+", "library", ",", "which", "makes", "use", "of", "a", "modified", "Bron-Kerbosch", "algorithm", "[", "12", "]", ",", "the", "search", "of", "maximal", "cliques", "can", "be", "very", "efficient", ".", "Node-guided", "Clique", "Selection", ".", "First", ",", "we", "calculate", "the", "weight", "for", "each", "clique", "in", "MAC", "initial", ".", "Given", "a", "clique", "C", "i", "=", "(", "V", "i", ",", "E", "i", ")", ",", "the", "weight", "w", "Ci", "is", "calculated", "as", ":", "EQUATION", "where", "w", "ej", "represents", "the", "weight", "of", "edge", "e", "j", "in", "W", "SOG", ".", "A", "node", "may", "be", "included", "by", "multiple", "maximal", "cliques", "and", "we", "1", "https", ":", "/", "/", "igraph.org", "only", "retain", "the", "one", "with", "the", "greatest", "weight", "for", "that", "node", ".", "Then", ",", "duplicated", "cliques", "are", "removed", "from", "the", "rest", ",", "obtaining", "MAC", "selected", ".", "We", "could", "send", "these", "maximal", "cliques", "directly", "to", "the", "following", "stages", "for", "3D", "registration", ".", "However", ",", "when", "|", "V", "|", "is", "quite", "large", ",", "the", "number", "of", "retained", "maximal", "cliques", "can", "still", "be", "very", "large", ".", "Here", ",", "we", "propose", "several", "techniques", "to", "further", "filter", "the", "maximal", "cliques", ".", "\u2022", "Normal", "consistency", ".", "In", "the", "maximal", "cliques", ",", "we", "find", "that", "the", "normal", "consistency", "is", "satisfied", "between", "each", "correspondence", ".", "The", "following", "inequality", "ought", "to", "hold", "if", "c", "i", "and", "c", "j", "are", "normal", "consistent", ":", "EQUATION", "where", "t", "\u03b1", "is", "a", "threshold", "for", "determining", "whether", "the", "angular", "differences", "are", "similar", ".", "\u2022", "Clique", "ranking", ".", "We", "organize", "MAC", "selected", "in", "a", "descending", "order", "using", "the", "clique's", "weight", "w", "Ci", ".", "Each", "maximal", "clique", "filtered", "from", "the", "previous", "step", "represents", "a", "consistent", "set", "of", "correspondences", ".", "By", "applying", "the", "SVD", "algorithm", "to", "each", "consistency", "set", ",", "we", "can", "obtain", "a", "set", "of", "6", "-", "DoF", "pose", "hypotheses", ".", "\u2022", "Instance-equal", "SVD", ".", "Transformation", "estimation", "of", "correspondences", "is", "often", "implemented", "with", "SVD", ".", "Instance-equal", "means", "that", "the", "weights", "of", "all", "correspondences", "are", "equal", ".", "\u2022", "Weighted", "SVD", ".", "Assigning", "weights", "to", "correspondences", "is", "commonly", "adopted", "by", "recent", "PCR", "methods", "[", "8", ",", "9", ",", "27", ",", "29", "]", ".", "Here", ",", "we", "take", "the", "primary", "eigenvalues", "of", "W", "SOG", "as", "correspondence", "weights", ".", "The", "final", "goal", "of", "MAC", "is", "to", "estimate", "the", "optimal", "6", "-", "DoF", "rigid", "transformation", "(", "composed", "of", "a", "rotation", "pose", "R", "*", "\u2208", "SO", "(", "3", ")", "and", "a", "translation", "pose", "t", "*", "\u2208", "R", "3", ")", "that", "maximizes", "the", "objective", "function", "as", "follow", ":", "EQUATION", "where", "c", "i", "\u2208", "C", "initial", ",", "N", "=", "|", "C", "initial", "|", ",", "and", "s", "(", "c", "i", ")", "represents", "the", "score", "of", "c", "i", ".", "We", "consider", "several", "RANSAC", "hypothesis", "evaluation", "metrics", "here", "[", "40", "]", ",", "including", "mean", "average", "error", "(", "MAE", ")", ",", "mean", "square", "error", "(", "MSE", ")", "and", "inlier", "count", ".", "The", "best", "hypothesis", "is", "taken", "to", "perform", "3D", "registration", "then", ".", "We", "consider", "four", "datasets", ",", "i.e", ",", "the", "objectscale", "dataset", "U3M", "[", "26", "]", ",", "the", "scene-scale", "indoor", "datasets", "3DMatch", "[", "44", "]", "&", "3DLoMatch", "[", "18", "]", ",", "and", "the", "scene-scale", "outdoor", "dataset", "KITTI", "[", "15", "]", ".", "U3M", "has", "496", "point", "cloud", "pairs", ".", "3DLoMatch", "is", "the", "subset", "of", "3DMatch", ",", "where", "the", "overlap", "rate", "of", "the", "point", "cloud", "pairs", "ranges", "from", "10%", "to", "30%", ",", "which", "is", "very", "challenging", ".", "For", "KITTI", ",", "we", "follow", "[", "3", ",", "8", "]", "and", "obtain", "555", "pairs", "of", "point", "clouds", "for", "testing", ".", "In", "addition", ",", "we", "employ", "the", "rotation", "error", "(", "RE", ")", "and", "translation", "error", "(", "TE", ")", "to", "evaluate", "the", "registration", "results", "on", "the", "scene-scale", "dataset", ".", "By", "referring", "to", "the", "settings", "in", "[", "9", "]", ",", "the", "registration", "is", "considered", "successful", "when", "the", "RE", "\u2264", "15", "\u00b0", ",", "TE", "\u2264", "30", "cm", "on", "3DMatch", "&", "3DLoMatch", "datasets", ",", "and", "RE", "\u2264", "5", "\u00b0", ",", "TE", "\u2264", "60", "cm", "on", "KITTI", "dataset", ".", "We", "define", "a", "dataset's", "registration", "accuracy", "as", "the", "ratio", "of", "success", "cases", "to", "the", "number", "of", "point", "cloud", "pairs", "to", "be", "registered", ".", "Our", "method", "is", "implemented", "in", "C", "+", "+", "based", "on", "the", "point", "cloud", "library", "(", "PCL", ")", "[", "32", "]", "and", "igraph", "library", ".", "For", "U3M", ",", "we", "use", "the", "Harris3D", "(", "H3D", ")", "[", "33", "]", "keypoint", "detector", "and", "the", "signatures", "of", "histograms", "of", "orientation", "(", "SHOT", ")", "[", "34", "]", "descriptor", "for", "initial", "correspondence", "generation", "as", "in", "[", "42", "]", ".", "For", "3DMatch", "and", "3DLoMatch", "datasets", ",", "we", "use", "the", "fast", "point", "features", "histograms", "(", "FPFH", ")", "[", "31", "]", "descriptor", "and", "fully", "convolutional", "geometric", "features", "(", "FCGF", ")", "[", "10", "]", "descriptor", "to", "generate", "the", "initial", "correspondence", "set", ".", "Here", ",", "the", "following", "methods", "are", "tested", ",", "including", "SAC-COT", "[", "39", "]", ",", "OSAC", "[", "37", "]", ",", "SAC-IA", "[", "31", "]", ",", "RANSAC", "[", "13", "]", ",", "SC", "2", "-", "PCR", "[", "8", "]", ",", "FGR", "[", "45", "]", ",", "GO-ICP", "[", "41", "]", ",", "and", "PPF", "[", "11", "]", ",", "where", "the", "former", "four", "are", "RANSAC-based", "methods", ".", "The", "results", "indicate", "that", "MAC", "performs", "best", "and", "significantly", "outperforms", "all", "tested", "RANSAC-fashion", "estimators", ",", "such", "as", "SAC-COT", ",", "OSAC", ",", "SAC-IA", ",", "and", "RANSAC", ".", "The", "registration", "performance", "of", "MAC", "based", "on", "the", "MAE", "evaluation", "metric", "is", "the", "best", "on", "U3M", ".", "PCR", "methods", "comparison", ".", "Both", "geometric-only", "and", "deep-learned", "methods", "are", "considered", "for", "comparison", ",", "including", "SM", "[", "20", "]", ",", "FGR", "[", "45", "]", ",", "RANSAC", "[", "13", "]", ",", "TEASER", "+", "+", "[", "36", "]", ",", "CG-SAC", "[", "30", "]", ",", "SC", "2", "-", "PCR", "[", "8", "]", ",", "3DRegNet", "[", "27", "]", ",", "DGR", "[", "9", "]", ",", "DHVR", "[", "19", "]", "and", "PointDSC", "[", "3", "]", ".", "The", "following", "conclusions", "can", "be", "made", ":", "1", ")", "regardless", "of", "which", "descriptor", "is", "used", ",", "MAC", "outperforms", "all", "compared", "methods", "on", "both", "3DMatch", "and", "3DLoMatch", "datasets", ",", "indicating", "its", "strong", "ability", "to", "register", "indoor", "scene", "point", "clouds", ";", "2", ")", "even", "compared", "with", "deep-learned", "methods", ",", "MAC", "still", "achieves", "better", "performance", "without", "any", "data", "training", ";", "3", ")", "in", "addition", "to", "the", "registration", "recall", "(", "RR", ")", "metric", ",", "MAC", "achieves", "the", "best", "RE", "and", "TE", "metrics", ".", "This", "indicates", "that", "registrations", "by", "MAC", "are", "very", "accurate", "and", "MAC", "is", "able", "to", "align", "low", "overlapping", "data", ".", "Boosting", "deep-learned", "methods", "with", "MAC", ".", "Several", "kinds", "of", "state-of-the-art", "deep-learned", "methods", "are", "integrated", "with", "MAC", "for", "evaluation", ".", "The", "considered", "methods", "are", "FCGF", "[", "10", "]", ",", "SpinNet", "[", "1", "]", ",", "Predator", "[", "18", "]", ",", "CoFiNet", "[", "43", "]", "and", "Geo-Transformer", "[", "29", "]", ".", "Remarkably", ",", "MAC", "dramatically", "improves", "the", "registration", "recall", "under", "all", "tested", "methods", "on", "both", "3DMatch", "and", "3DLoMatch", "datasets", ".", "Notably", ",", "the", "performance", "of", "Spin-Net", ",", "Predator", "and", "CoFiNet", "after", "boosting", "by", "MAC", "exceeds", "In", "Table", "4", ",", "the", "results", "of", "DGR", "[", "9", "]", ",", "PointDSC", "[", "3", "]", ",", "TEASER", "+", "+", "[", "36", "]", ",", "RANSAC", "[", "13", "]", ",", "CG-SAC", "[", "30", "]", ",", "SC", "2", "-", "PCR", "[", "8", "]", "and", "MAC", "are", "reported", "for", "comparison", ".", "As", "shown", "by", "the", "table", ",", "in", "terms", "of", "the", "registration", "recall", "performance", ",", "MAC", "presents", "the", "best", "and", "is", "tied", "for", "the", "best", "results", "with", "FPFH", "and", "FCGF", "descriptor", "settings", ",", "respectively", ".", "MAC", "also", "has", "a", "lower", "TE", "than", "the", "state-ofthe-art", "geometric-only", "method", "SC", "2", "-", "PCR", ".", "The", "registration", "experiments", "on", "the", "object", ",", "indoor", "scene", ",", "and", "outdoor", "scene", "datasets", "consistently", "verify", "that", "MAC", "holds", "good", "generalization", "ability", "in", "different", "application", "contexts", ".", "In", "this", "section", ",", "we", "perform", "ablation", "studies", "and", "analysis", "experiments", "on", "both", "3DMatch", "and", "3DLoMatch", "datasets", ".", "Table", "8", "presents", "the", "time", "efficiency", "analysis", "of", "MAC", ".", "Performing", "feature", "matching", "selection", ".", "Before", "3D", "registration", ",", "a", "popular", "way", "is", "to", "perform", "outlier", "rejection", "to", "reduce", "the", "correspondence", "set", ".", "Here", "we", "employ", "geometric", "consistency", "(", "GC", ")", "[", "7", "]", ",", "which", "is", "independent", "of", "the", "feature", "space", "and", "associates", "the", "largest", "consistent", "cluster", "relating", "to", "the", "compatibility", "among", "correspondences", ".", "This", "demonstrates", "that", "MAC", "can", "still", "perform", "well", "even", "if", "the", "initial", "correspondence", "set", "is", "directly", "utilized", "as", "input", "without", "any", "filtering", ".", "We", "test", "the", "performance", "of", "MAC", "by", "using", "different", "graph", "construction", "approaches", ".", "Also", ",", "the", "registration", "recall", "obtained", "by", "using", "SOG", "is", "0.12%", "higher", "than", "using", "FOG", "when", "combined", "with", "FPFH", ",", "and", "0.56%", "higher", "when", "combined", "with", "FCGF", "on", "3DLoMatch", ".", "Therefore", ",", "SOG", "is", "more", "suitable", "for", "MAC", ".", "Maximum", "or", "maximal", "clique", ".", "To", "justify", "the", "advantages", "of", "maximal", "cliques", ",", "we", "change", "the", "search", "strategy", "of", "MAC", "to", "the", "maximum", "cliques", "and", "test", "the", "registration", "performance", ".", "As", "shown", "in", "Row", "1", "and", "9", "in", "Table", "5", ",", "applying", "maximal", "cliques", "surpasses", "maximum", "by", "9.8%", "when", "combined", "with", "FPFH", ",", "and", "5.55%", "higher", "when", "combined", "with", "FCGF", "on", "3DMatch", ".", "Besides", ",", "the", "registration", "recall", "obtained", "by", "using", "maximal", "cliques", "is", "8.03%", "higher", "than", "using", "the", "maximum", "cliques", "when", "combined", "with", "FPFH", "and", "10.45%", "higher", "when", "combined", "with", "FCGF", "on", "3DLoMatch", ".", "There", "are", "several", "reasons", "for", "this", ":", "1", ")", "maximal", "cliques", "include", "the", "maximum", "cliques", "and", "additionally", "consider", "local", "graph", "constraints", ",", "so", "the", "search", "for", "maximal", "cliques", "can", "make", "use", "of", "both", "local", "and", "global", "information", "in", "the", "compatibility", "graph", ";", "2", ")", "the", "maximum", "clique", "is", "a", "very", "tight", "constraint", "which", "requires", "maximizing", "the", "number", "of", "mutually", "compatible", "correspondences", ",", "but", "it", "does", "not", "guarantee", "the", "opti-mal", "result", ".", "Node-guided", "clique", "selection", ".", "We", "compare", "the", "performance", "with", "and", "without", "node-guided", "(", "NG", ")", "clique", "selection", "for", "maximal", "cliques", "search", ".", "Comparing", "Row", "1", "and", "4", "in", "Table", "5", ",", "using", "NG", "achieves", "a", "recall", "improvement", "of", "0.37%", "when", "combined", "with", "FPFH", ",", "and", "0.5%", "improvement", "when", "combined", "with", "FCGF", "on", "3DMatch", ".", "Also", ",", "using", "NG", "achieves", "a", "recall", "improvement", "of", "0.23%", "with", "FPFH", "and", "0.73%", "improvement", "with", "FCGF", "on", "3DLoMatch", ".", "It", "is", "worth", "noting", "that", "while", "NG", "improves", "recall", ",", "the", "mean", "RE", "and", "mean", "TE", "are", "also", "decreasing", ".", "For", "example", ",", "NG", "reduces", "the", "mean", "RE", "by", "0.1", "\u00b0", "and", "the", "mean", "TE", "by", "0.11", "cm", "with", "FPFH", "on", "3DLoMatch", ".", "Different", "approaches", "for", "clique", "filtering", ".", "We", "test", "the", "effectiveness", "of", "the", "two", "filtering", "methods", ",", "normal", "consistency", "and", "clique", "ranking", ".", "1", ")", "Normal", "consistency", ":", "comparing", "Row", "1", "and", "8", "in", "Table", "5", ",", "NC", "slightly", "degrades", "MAC's", "performance", ".", "2", ")", "Clique", "ranking", ":", "Row", "10", "to", "14", "demonstrate", "that", "the", "registration", "recall", "tends", "to", "increase", "as", "K", "increases", ",", "suggesting", "that", "larger", "K", "yields", "a", "subset", "of", "cliques", "that", "generate", "more", "correct", "hypotheses", ".", "Employing", "instance-equal", "or", "weighted", "SVD", ".", "The", "comparisons", "of", "instance-equal", "and", "weighted", "SVD", "are", "shown", "in", "Rows", "1", "and", "5", "of", "Table", "5", "Weighted", "SVD", "is", "slightly", "inferior", "to", "instance-equal", "SVD", ".", "This", "suggests", "that", "samples", "in", "MACs", "are", "already", "very", "consistent", ",", "indicating", "no", "additional", "weighting", "strategies", "are", "required", ".", "Here", "we", "compare", "three", "evaluation", "metrics", ",", "including", "MAE", ",", "MSE", "and", "inlier", "count", ",", "for", "MAC", "hypothesis", "evaluation", ".", "As", "shown", "in", "Row", "1", ",", "6", "and", "7", ",", "MAC", "with", "MAE", "achieves", "the", "best", "performance", ".", "In", "Table", "5", ",", "MAE", "achieves", "a", "recall", "improvement", "of", "0.24%", "when", "combined", "with", "FPFH", ",", "and", "0.31%", "improvement", "when", "combined", "with", "FCGF", "on", "3DMatch", "compared", "with", "the", "commonly", "used", "inlier", "count", "metric", ".", "Also", ",", "MAE", "has", "a", "1.74%", "improvement", "when", "combined", "with", "FPFH", ",", "and", "0.05%", "when", "combined", "with", "FCGF", "on", "3DLoMatch", "compared", "with", "inlier", "count", ".", "MAE", "is", "also", "very", "effective", "in", "reducing", "RE", "and", "TE", ".", "Comparison", "with", "RANSAC", "hypotheses", ".", "We", "evaluate", "the", "quality", "of", "the", "generated", "hypotheses", "by", "comparing", "the", "hypotheses", "from", "RANSAC", "and", "MAC", "with", "the", "ground", "truth", "transformation", ".", "Compared", "to", "RANSAC", ",", "which", "randomly", "selects", "correspondences", "and", "generates", "hypotheses", "from", "the", "correspondence", "set", "without", "geometric", "constraints", ",", "MAC", "effectively", "generates", "more", "convincing", "hypotheses", "from", "maximal", "cliques", "in", "the", "compatibility", "graph", ",", "which", "fully", "exploits", "the", "consensus", "information", "in", "the", "graph", ".", "The", "performance", "upper", "bound", "of", "MAC", ".", "This", "can", "test", "the", "performance", "upper", "bound", "of", "MAC", ".", "We", "vary", "the", "judging", "threshold", "for", "the", "number", "of", "generated", "correct", "hypotheses", "and", "report", "the", "results", "in", "Impressively", ",", "MAC", "-", "1", "achieves", "registration", "recalls", "of", "98.46%", "/", "91.24%", "on", "3DMatch", "/", "3DLoMatch", ".", "This", "indicates", "that", "even", "on", "low", "overlapping", "datasets", ",", "MAC", "is", "able", "to", "produce", "correct", "hypotheses", "for", "most", "point", "cloud", "pairs", ".", "In", "addition", ",", "we", "can", "deduce", "that", "MAC's", "performance", "can", "be", "further", "improved", "with", "better", "hypothesis", "evaluation", "metrics", ".", "Time", "consumption", "of", "MAC", ".", "The", "following", "observations", "can", "be", "made", ".", "1", ")", "In", "general", ",", "MAC", "can", "complete", "3D", "registration", "in", "only", "tens", "of", "milliseconds", "when", "the", "number", "of", "correspondences", "is", "smaller", "than", "1000", ".", "Note", "that", "MAC", "is", "implemented", "on", "the", "CPU", "only", ".", "2", ")", "As", "the", "number", "of", "correspondences", "increases", "from", "250", "to", "2500", ",", "there", "is", "an", "increase", "in", "time", "cost", "for", "graph", "construction", "due", "to", "W", "SOG", "computation", "taking", "more", "time", ".", "3", ")", "When", "the", "number", "of", "correspondences", "reaches", "5000", ",", "there", "is", "a", "large", "rise", "in", "the", "time", "cost", "of", "MAC's", "registration", ".", "The", "significant", "increase", "in", "the", "input", "size", "makes", "the", "search", "for", "maximal", "cliques", "more", "timeconsuming", ".", "However", ",", "MAC", "is", "not", "sensitive", "to", "the", "cardinality", "of", "the", "input", "correspondence", "set", ",", "as", "verified", "in", "Table", "3", ".", "Hence", ",", "using", "sparse", "inputs", "for", "MAC", "can", "produce", "outstanding", "performance", "while", "making", "registration", "efficient", ".", "In", "this", "paper", ",", "we", "presented", "MAC", "to", "solve", "PCR", "by", "using", "the", "maximal", "clique", "constraint", "to", "generate", "precise", "pose", "hypotheses", "from", "correspondences", ".", "Our", "method", "achieves", "state-of-the-art", "performance", "on", "all", "tested", "datasets", "and", "can", "adapt", "to", "deep-learned", "methods", "to", "boost", "their", "performance", ".", "As", "shown", "in", "Table", "7", "and", "Table", "1", ",", "MAC", "produces", "accurate", "hypotheses", "but", "may", "fail", "to", "find", "them", "."], "sentences": [["3D", "Registration", "with", "Maximal", "Cliques", "As", "a", "fundamental", "problem", "in", "computer", "vision", ",", "3D", "point", "cloud", "registration", "(", "PCR", ")", "aims", "to", "seek", "the", "optimal", "pose", "to", "align", "a", "point", "cloud", "pair", "."], ["In", "this", "paper", ",", "we", "present", "a", "3D", "registration", "method", "with", "maximal", "cliques", "(", "MAC", ")", "."], ["The", "key", "insight", "is", "to", "loosen", "the", "previous", "maximum", "clique", "constraint", ",", "and", "mine", "more", "local", "consensus", "information", "in", "a", "graph", "for", "accurate", "pose", "hypotheses", "generation", ":", "1", ")", "A", "compatibility", "graph", "is", "constructed", "to", "render", "the", "affinity", "relationship", "between", "initial", "correspondences", ".", "2", ")", "We", "search", "for", "maximal", "cliques", "in", "the", "graph", ",", "each", "of", "which", "represents", "a", "consensus", "set", "."], ["We", "perform", "node-guided", "clique", "selection", "then", ",", "where", "each", "node", "corresponds", "to", "the", "maximal", "clique", "with", "the", "greatest", "graph", "weight", ".", "3", ")", "Transformation", "hypotheses", "are", "computed", "for", "the", "selected", "cliques", "by", "the", "SVD", "algorithm", "and", "the", "best", "hypothesis", "is", "used", "to", "perform", "registration", "."], ["Extensive", "experiments", "on", "U3M", ",", "3DMatch", ",", "3DLoMatch", "and", "KITTI", "demonstrate", "that", "MAC", "effectively", "increases", "registration", "accuracy", ",", "outperforms", "various", "state-of-the-art", "methods", "and", "boosts", "the", "performance", "of", "deep-learned", "methods", "."], ["MAC", "combined", "with", "deep-learned", "methods", "achieves", "stateof-the-art", "registration", "recall", "of", "95.7%", "/", "78.9%", "on", "3DMatch", "/", "3DLoMatch", "."], ["Given", "two", "3D", "scans", "of", "the", "same", "object", "(", "or", "scene", ")", ",", "the", "goal", "of", "PCR", "is", "to", "estimate", "a", "six-degree-of-freedom", "(", "6", "-", "DoF", ")", "pose", "transformation", "that", "accurately", "aligns", "the", "two", "input", "point", "clouds", "."], ["Using", "pointto-point", "feature", "correspondences", "is", "a", "popular", "and", "robust", "solution", "to", "the", "PCR", "problem", "."], ["The", "problem", "of", "3D", "registration", "by", "handling", "correspondences", "with", "outliers", "has", "been", "studied", "for", "decades", "."], ["We", "classify", "them", "into", "geometric-only", "and", "deep-learned", "methods", "."], ["For", "geometric-only", "methods", "[", "5", ",", "6", ",", "21", ",", "30", ",", "31", ",", "[", "38", "]", "[", "39", "]", "[", "40", "]", "[", "41", "]", ",", "random", "sample", "consensus", "(", "RANSAC", ")", "and", "its", "variants", "perform", "an", "iterative", "sampling", "strategy", "for", "registration", "."], ["Although", "RANSAC-based", "methods", "are", "simple", "and", "efficient", ",", "their", "performance", "is", "highly", "vulnerable", "when", "the", "outlier", "rate", "increases", ",", "and", "it", "requires", "a", "large", "number", "of", "iterations", "to", "obtain", "acceptable", "results", "."], ["Also", ",", "a", "series", "of", "global", "registration", "methods", "based", "on", "branch-and-bound", "(", "BnB", ")", "are", "proposed", "to", "search", "the", "6D", "parameter", "space", "and", "obtain", "the", "optimal", "global", "solution", "."], ["Except", "for", "this", "watermark", ",", "it", "is", "identical", "to", "the", "accepted", "version", ";", "the", "final", "published", "version", "of", "the", "proceedings", "is", "available", "on", "IEEE", "Xplore", ".", "one", "module", "in", "the", "registration", "process", ",", "such", "as", "investigating", "more", "discriminate", "keypoint", "feature", "descriptors", "or", "more", "effective", "correspondence", "selection", "techniques", ",", "while", "the", "others", "[", "22", ",", "29", ",", "43", "]", "focus", "on", "registration", "in", "an", "end-to-end", "manner", "."], ["However", ",", "deep-learned", "based", "methods", "require", "a", "large", "amount", "of", "data", "for", "training", "and", "usually", "lack", "generalization", "on", "different", "datasets", "."], ["In", "this", "paper", ",", "we", "propose", "a", "geometric-only", "3D", "registration", "method", "based", "on", "maximal", "cliques", "(", "MAC", ")", "."], ["The", "key", "insight", "is", "to", "loosen", "the", "previous", "maximum", "clique", "constraint", ",", "and", "mine", "more", "local", "consensus", "information", "in", "a", "graph", "to", "generate", "accurate", "pose", "hypotheses", "."], ["Compared", "with", "the", "maximum", "clique", ",", "MAC", "is", "a", "looser", "constraint", "and", "is", "able", "to", "mine", "more", "local", "information", "in", "a", "graph", "."], ["Finally", ",", "transformation", "hypotheses", "are", "computed", "for", "the", "selected", "cliques", "by", "the", "SVD", "algorithm", "."], ["The", "best", "hypothesis", "is", "selected", "to", "perform", "registration", "using", "popular", "hypothesis", "evaluation", "metrics", "in", "the", "RANSAC", "family", "."], ["To", "summarize", ",", "our", "main", "contributions", "are", "as", "follows", ":", "\u2022", "We", "introduce", "a", "hypothesis", "generation", "method", "named", "MAC", "."], ["Our", "MAC", "method", "is", "able", "to", "mine", "more", "local", "information", "in", "a", "graph", ",", "compared", "with", "the", "previous", "maximum", "clique", "constraint", "."], ["Notably", ",", "our", "geometric-only", "MAC", "method", "outperforms", "several", "state-of-the-art", "deep", "learning", "methods", "[", "3", ",", "9", ",", "19", ",", "27", "]", "."], ["MAC", "can", "also", "be", "inserted", "as", "a", "module", "into", "multiple", "deep-learned", "frameworks", "[", "1", ",", "10", ",", "18", ",", "29", ",", "43", "]", "to", "boost", "their", "performance", "."], ["MAC", "combined", "with", "GeoTransformer", "achieves", "the", "state-of-the-art", "registration", "recall", "of", "95.7%", "/", "78.9%", "on", "3DMatch", "/", "3DLoMatch", "."], ["Various", "geometric-only", "methods", "[", "6", ",", "8", ",", "20", ",", "36", ",", "45", "]", "have", "been", "proposed", "recently", "."], ["Typically", ",", "RANSAC", "and", "its", "variants", "[", "5", ",", "13", ",", "30", ",", "31", ",", "[", "38", "]", "[", "39", "]", "[", "40", "]", "remain", "the", "dominant", "approaches", "to", "the", "problem", "of", "estimating", "a", "6", "-", "DoF", "pose", "from", "correspondences", "."], ["RANSAC", "iteratively", "samples", "correspondences", "from", "the", "initial", "set", ",", "generating", "and", "evaluating", "geometric", "estimations", "for", "each", "subset", "until", "a", "satisfactory", "solution", "is", "obtained", "."], ["Efficient", "and", "robust", "evaluation", "metrics", "are", "extremely", "important", "for", "using", "RANSAC", "to", "achieve", "accurate", "registration", "."], ["To", "address", "the", "current", "problems", "of", "timeconsuming", "and", "noise-sensitive", "evaluation", "metrics", ",", "[", "40", "]", "analyzes", "the", "contribution", "of", "inliers", "and", "outliers", "during", "the", "computation", "and", "proposed", "several", "metrics", "that", "can", "effectively", "improve", "the", "registration", "performance", "of", "RANSAC", "."], ["For", "example", ",", "Rusu", "et", "al", ".", "[", "31", "]", "presented", "the", "simple", "consensus-based", "initial", "alignment", "(", "SAC-IA", ")", "method", ",", "which", "samples", "correspondences", "spread", "out", "on", "the", "point", "cloud", "and", "leverages", "the", "Huber", "penalty", "for", "evaluation", "."], ["Graph", "cut", "RANSAC", "(", "GC-RANSAC", ")", "[", "5", "]", "uses", "the", "graph-cut", "algorithm", "before", "model", "re-fitting", "in", "the", "local", "optimization", "step", "."], ["Compatibility-guided", "sample", "consensus", "(", "CG-SAC", ")", "[", "30", "]", "additionally", "considers", "the", "normal", "information", "of", "key", "points", "during", "the", "sampling", "process", "."], ["Yang", "et", "al", ".", "[", "39", "]", "proposed", "the", "sample", "consensus", "by", "sampling", "compatibility", "triangles", "(", "SAC-COT", ")", "method", ",", "which", "generates", "estimations", "by", "ranking", "and", "sampling", "ternary", "loops", "from", "the", "compatibility", "graph", "."], ["A", "series", "of", "globally", "optimal", "methods", "based", "on", "BnB", "have", "been", "proposed", "recently", "."], ["Yang", "et", "al", ".", "[", "41", "]", "proposed", "globally", "optimal", "ICP", "(", "GO-ICP", ")", ",", "which", "rationalizes", "the", "planning", "of", "ICP", "update", "tasks", "at", "different", "stages", ",", "and", "its", "biggest", "advantage", "is", "that", "it", "minimizes", "the", "local", "optimum", "."], ["Bustos", "and", "Chin", "[", "6", "]", "presented", "guaranteed", "outlier", "removal", "(", "GORE", ")", ",", "which", "calculates", "the", "tight", "lower", "bound", "and", "tight", "upper", "bound", "for", "each", "correspondence", "and", "reduces", "the", "size", "of", "correspondence", "set", "by", "rejecting", "true", "outliers", "."], ["Motivated", "by", "GORE", ",", "Li", "[", "21", "]", "proposed", "a", "polynomial", "time", "outlier", "removal", "method", ",", "which", "seeks", "the", "tight", "lower", "and", "upper", "bound", "by", "calculating", "the", "costs", "of", "correspondence", "matrix", "(", "CM", ")", "and", "augmented", "correspondence", "matrix", "(", "ACM", ")", "."], ["However", ",", "BnB", "techniques", "are", "sensitive", "to", "the", "cardinality", "of", "the", "input", "and", "are", "time-consuming", "for", "large-scale", "inputs", "."], ["In", "addition", "to", "geometric-only", "methods", ",", "recent", "works", "also", "adopt", "deep", "learning", "techniques", "to", "perform", "PCR", "."], ["FCGF", "[", "10", "]", "computes", "the", "features", "in", "a", "single", "pass", "through", "a", "fully", "convolutional", "neural", "network", "without", "keypoint", "detection", "."], ["D3Feat", "[", "4", "]", "uses", "a", "fully", "convolutional", "network", "to", "obtain", "local", "information", "of", "point", "clouds", "and", "a", "joint", "learning", "framework", "to", "achieve", "3D", "local", "feature", "detection", "and", "description", "."], ["Predator", "[", "18", "]", "applies", "an", "attention", "mechanism", "to", "extract", "salient", "points", "in", "overlapping", "regions", "of", "the", "point", "clouds", ",", "thus", "achieving", "robust", "registration", "in", "the", "presence", "of", "low", "overlap", "rates", "."], ["Spinnet", "[", "1", "]", "extracts", "local", "features", "which", "are", "rotationally", "invariant", "and", "sufficiently", "informative", "to", "enable", "accurate", "registration", "."], ["Deep", "global", "registration", "(", "DGR", ")", "[", "9", "]", "and", "3DReg-Net", "[", "27", "]", "classify", "a", "given", "correspondence", "by", "training", "endto-end", "neural", "networks", "and", "using", "operators", "such", "as", "sparse", "convolution", "and", "point-by-point", "MLP", "."], ["PointDSC", "[", "3", "]", "explicitly", "explores", "spatial", "consistency", "for", "removing", "outlier", "correspondences", "and", "3D", "point", "cloud", "registration", "."], ["Fu", "et", "al", ".", "[", "14", "]", "proposed", "a", "registration", "framework", "that", "utilizes", "deep", "graph", "matching", "(", "RGM", ")", "that", "can", "find", "robust", "and", "accurate", "pointto-point", "correspondences", "."], ["More", "recently", ",", "several", "methods", "[", "29", ",", "43", "]", "follow", "the", "detection-free", "methods", "and", "estimate", "the", "transformation", "in", "an", "end-to-end", "way", "."], ["CoFiNet", "[", "43", "]", "extracts", "correspondences", "from", "coarse", "to", "fine", "without", "keypoint", "detection", "."], ["GeoTransformer", "[", "29", "]", "learns", "geometric", "features", "for", "robust", "superpoint", "matching", "and", "is", "robust", "in", "low-overlap", "cases", "and", "invariant", "to", "rigid", "transformation", "."], ["MAC", "(", "c1", ")", "=", "(", "c1", ",", "c3", ",", "c4", ",", "c5", ")", "MAC", "(", "c3", ")", "=", "(", "c1", ",", "c3", ",", "c4", ",", "c5", ")", "MAC", "(", "c2", ")", "=", "(", "c2", ",", "c6", ",", "c7", ")", "\u2026", "MAC", "(", "c9", ")", "=", "(", "c1", ",", "c9", ",", "c10", ")", "MAC", "(", "c10", ")", "=", "(", "c1", ",", "c9", ",", "c10", ")", "Node-guided", "maximal", "cliques", "c7", "c7", "c6", "c6", "c2", "c2", "c5", "c5", "c4", "c4", "c3", "c3", "c1", "c1", "R3", ",", "t3", "c10", "c10", "c9", "c9", "c1", "c1", "While", "deep", "learning", "techniques", "have", "demonstrated", "a", "great", "potential", "for", "PCR", ",", "these", "methods", "require", "a", "large", "amount", "of", "training", "data", "and", "their", "generalization", "is", "not", "always", "promising", "."], ["By", "contrast", ",", "MAC", "does", "not", "require", "any", "training", "data", "and", "achieves", "more", "advanced", "performance", "than", "several", "deep-learned", "methods", "."], ["Moreover", ",", "MAC", "can", "be", "served", "as", "a", "drop-on", "module", "in", "deep", "learning", "frameworks", "to", "boost", "their", "performance", "."], ["An", "initial", "correspondence", "set", "C", "initial", "=", "{", "c", "}", "is", "formed", "by", "matching", "feature", "descriptors", ",", "where", "c", "=", "(", "p", "s", ",", "p", "t", ")", "."], ["MAC", "estimates", "the", "6", "-", "DoF", "pose", "transformation", "between", "P", "s", "and", "P", "t", "from", "C", "initial", "."], ["Here", ",", "we", "consider", "two", "approaches", "to", "construct", "a", "compatibility", "graph", ".", "\u2022", "First", "Order", "Graph", "."], ["The", "first", "order", "graph", "(", "FOG", ")", "is", "constructed", "based", "on", "the", "rigid", "distance", "constraint", "between", "the", "correspondence", "pair", "(", "c", "i", ",", "c", "j", ")", ",", "which", "can", "be", "quantitatively", "measured", "as", ":", "EQUATION", "The", "compatibility", "score", "between", "c", "i", "and", "c", "j", "is", "given", "as", ":", "EQUATION", "where", "d", "cmp", "is", "a", "distance", "parameter", "."], ["Since", "the", "compatibility", "graph", "is", "undirected", ",", "the", "weight", "matrix", "W", "F", "OG", "is", "symmetric", ".", "\u2022", "Second", "Order", "Graph", "."], ["The", "second", "order", "graph", "(", "SOG", ")", "evolves", "from", "FOG", "."], ["The", "weight", "matrix", "W", "SOG", "can", "be", "calculated", "as", ":", "EQUATION", "where", "\u2299", "represents", "the", "element-wise", "product", "between", "two", "matrices", "."], ["In", "Sec", ".", "4.5", ",", "we", "experimentally", "compare", "FOG", "and", "SOG", "in", "our", "MAC", "framework", "."], ["A", "maximal", "clique", "is", "a", "clique", "that", "cannot", "be", "extended", "by", "adding", "any", "nodes", "."], ["In", "particular", ",", "the", "maximal", "clique", "with", "the", "most", "nodes", "is", "the", "maximum", "clique", "of", "a", "graph", "."], ["Searching", "for", "Maximal", "cliques", "."], ["To", "generate", "hypotheses", ",", "RANSAC-based", "methods", "repeatedly", "take", "random", "samples", "from", "the", "correspondence", "set", "."], ["Previous", "works", "[", "23", ",", "24", ",", "28", ",", "36", "]", "focus", "on", "searching", "for", "maximum", "cliques", "in", "the", "graph", ",", "however", ",", "the", "maximum", "clique", "is", "a", "very", "tight", "constraint", "that", "only", "focuses", "on", "the", "global", "consensus", "information", "in", "a", "graph", "."], ["Instead", ",", "we", "loosen", "the", "constraint", "and", "leverage", "maximal", "cliques", "to", "mine", "more", "local", "graph", "information", "."], ["By", "using", "the", "igraph", "maximal", "cliques", "function", "in", "the", "igraph", "1", "C", "+", "+", "library", ",", "which", "makes", "use", "of", "a", "modified", "Bron-Kerbosch", "algorithm", "[", "12", "]", ",", "the", "search", "of", "maximal", "cliques", "can", "be", "very", "efficient", "."], ["Node-guided", "Clique", "Selection", "."], ["First", ",", "we", "calculate", "the", "weight", "for", "each", "clique", "in", "MAC", "initial", "."], ["Given", "a", "clique", "C", "i", "=", "(", "V", "i", ",", "E", "i", ")", ",", "the", "weight", "w", "Ci", "is", "calculated", "as", ":", "EQUATION", "where", "w", "ej", "represents", "the", "weight", "of", "edge", "e", "j", "in", "W", "SOG", "."], ["A", "node", "may", "be", "included", "by", "multiple", "maximal", "cliques", "and", "we", "1", "https", ":", "/", "/", "igraph.org", "only", "retain", "the", "one", "with", "the", "greatest", "weight", "for", "that", "node", "."], ["Then", ",", "duplicated", "cliques", "are", "removed", "from", "the", "rest", ",", "obtaining", "MAC", "selected", "."], ["We", "could", "send", "these", "maximal", "cliques", "directly", "to", "the", "following", "stages", "for", "3D", "registration", "."], ["However", ",", "when", "|", "V", "|", "is", "quite", "large", ",", "the", "number", "of", "retained", "maximal", "cliques", "can", "still", "be", "very", "large", "."], ["Here", ",", "we", "propose", "several", "techniques", "to", "further", "filter", "the", "maximal", "cliques", ".", "\u2022", "Normal", "consistency", "."], ["In", "the", "maximal", "cliques", ",", "we", "find", "that", "the", "normal", "consistency", "is", "satisfied", "between", "each", "correspondence", "."], ["The", "following", "inequality", "ought", "to", "hold", "if", "c", "i", "and", "c", "j", "are", "normal", "consistent", ":", "EQUATION", "where", "t", "\u03b1", "is", "a", "threshold", "for", "determining", "whether", "the", "angular", "differences", "are", "similar", ".", "\u2022", "Clique", "ranking", "."], ["We", "organize", "MAC", "selected", "in", "a", "descending", "order", "using", "the", "clique's", "weight", "w", "Ci", "."], ["Each", "maximal", "clique", "filtered", "from", "the", "previous", "step", "represents", "a", "consistent", "set", "of", "correspondences", "."], ["By", "applying", "the", "SVD", "algorithm", "to", "each", "consistency", "set", ",", "we", "can", "obtain", "a", "set", "of", "6", "-", "DoF", "pose", "hypotheses", ".", "\u2022", "Instance-equal", "SVD", "."], ["Transformation", "estimation", "of", "correspondences", "is", "often", "implemented", "with", "SVD", "."], ["Instance-equal", "means", "that", "the", "weights", "of", "all", "correspondences", "are", "equal", ".", "\u2022", "Weighted", "SVD", "."], ["Assigning", "weights", "to", "correspondences", "is", "commonly", "adopted", "by", "recent", "PCR", "methods", "[", "8", ",", "9", ",", "27", ",", "29", "]", "."], ["Here", ",", "we", "take", "the", "primary", "eigenvalues", "of", "W", "SOG", "as", "correspondence", "weights", "."], ["The", "final", "goal", "of", "MAC", "is", "to", "estimate", "the", "optimal", "6", "-", "DoF", "rigid", "transformation", "(", "composed", "of", "a", "rotation", "pose", "R", "*", "\u2208", "SO", "(", "3", ")", "and", "a", "translation", "pose", "t", "*", "\u2208", "R", "3", ")", "that", "maximizes", "the", "objective", "function", "as", "follow", ":", "EQUATION", "where", "c", "i", "\u2208", "C", "initial", ",", "N", "=", "|", "C", "initial", "|", ",", "and", "s", "(", "c", "i", ")", "represents", "the", "score", "of", "c", "i", "."], ["We", "consider", "several", "RANSAC", "hypothesis", "evaluation", "metrics", "here", "[", "40", "]", ",", "including", "mean", "average", "error", "(", "MAE", ")", ",", "mean", "square", "error", "(", "MSE", ")", "and", "inlier", "count", "."], ["The", "best", "hypothesis", "is", "taken", "to", "perform", "3D", "registration", "then", "."], ["We", "consider", "four", "datasets", ",", "i.e", ",", "the", "objectscale", "dataset", "U3M", "[", "26", "]", ",", "the", "scene-scale", "indoor", "datasets", "3DMatch", "[", "44", "]", "&", "3DLoMatch", "[", "18", "]", ",", "and", "the", "scene-scale", "outdoor", "dataset", "KITTI", "[", "15", "]", "."], ["U3M", "has", "496", "point", "cloud", "pairs", ".", "3DLoMatch", "is", "the", "subset", "of", "3DMatch", ",", "where", "the", "overlap", "rate", "of", "the", "point", "cloud", "pairs", "ranges", "from", "10%", "to", "30%", ",", "which", "is", "very", "challenging", "."], ["For", "KITTI", ",", "we", "follow", "[", "3", ",", "8", "]", "and", "obtain", "555", "pairs", "of", "point", "clouds", "for", "testing", "."], ["In", "addition", ",", "we", "employ", "the", "rotation", "error", "(", "RE", ")", "and", "translation", "error", "(", "TE", ")", "to", "evaluate", "the", "registration", "results", "on", "the", "scene-scale", "dataset", "."], ["By", "referring", "to", "the", "settings", "in", "[", "9", "]", ",", "the", "registration", "is", "considered", "successful", "when", "the", "RE", "\u2264", "15", "\u00b0", ",", "TE", "\u2264", "30", "cm", "on", "3DMatch", "&", "3DLoMatch", "datasets", ",", "and", "RE", "\u2264", "5", "\u00b0", ",", "TE", "\u2264", "60", "cm", "on", "KITTI", "dataset", "."], ["We", "define", "a", "dataset's", "registration", "accuracy", "as", "the", "ratio", "of", "success", "cases", "to", "the", "number", "of", "point", "cloud", "pairs", "to", "be", "registered", "."], ["Our", "method", "is", "implemented", "in", "C", "+", "+", "based", "on", "the", "point", "cloud", "library", "(", "PCL", ")", "[", "32", "]", "and", "igraph", "library", "."], ["For", "U3M", ",", "we", "use", "the", "Harris3D", "(", "H3D", ")", "[", "33", "]", "keypoint", "detector", "and", "the", "signatures", "of", "histograms", "of", "orientation", "(", "SHOT", ")", "[", "34", "]", "descriptor", "for", "initial", "correspondence", "generation", "as", "in", "[", "42", "]", "."], ["For", "3DMatch", "and", "3DLoMatch", "datasets", ",", "we", "use", "the", "fast", "point", "features", "histograms", "(", "FPFH", ")", "[", "31", "]", "descriptor", "and", "fully", "convolutional", "geometric", "features", "(", "FCGF", ")", "[", "10", "]", "descriptor", "to", "generate", "the", "initial", "correspondence", "set", "."], ["Here", ",", "the", "following", "methods", "are", "tested", ",", "including", "SAC-COT", "[", "39", "]", ",", "OSAC", "[", "37", "]", ",", "SAC-IA", "[", "31", "]", ",", "RANSAC", "[", "13", "]", ",", "SC", "2", "-", "PCR", "[", "8", "]", ",", "FGR", "[", "45", "]", ",", "GO-ICP", "[", "41", "]", ",", "and", "PPF", "[", "11", "]", ",", "where", "the", "former", "four", "are", "RANSAC-based", "methods", "."], ["The", "results", "indicate", "that", "MAC", "performs", "best", "and", "significantly", "outperforms", "all", "tested", "RANSAC-fashion", "estimators", ",", "such", "as", "SAC-COT", ",", "OSAC", ",", "SAC-IA", ",", "and", "RANSAC", "."], ["The", "registration", "performance", "of", "MAC", "based", "on", "the", "MAE", "evaluation", "metric", "is", "the", "best", "on", "U3M", "."], ["PCR", "methods", "comparison", "."], ["Both", "geometric-only", "and", "deep-learned", "methods", "are", "considered", "for", "comparison", ",", "including", "SM", "[", "20", "]", ",", "FGR", "[", "45", "]", ",", "RANSAC", "[", "13", "]", ",", "TEASER", "+", "+", "[", "36", "]", ",", "CG-SAC", "[", "30", "]", ",", "SC", "2", "-", "PCR", "[", "8", "]", ",", "3DRegNet", "[", "27", "]", ",", "DGR", "[", "9", "]", ",", "DHVR", "[", "19", "]", "and", "PointDSC", "[", "3", "]", "."], ["The", "following", "conclusions", "can", "be", "made", ":", "1", ")", "regardless", "of", "which", "descriptor", "is", "used", ",", "MAC", "outperforms", "all", "compared", "methods", "on", "both", "3DMatch", "and", "3DLoMatch", "datasets", ",", "indicating", "its", "strong", "ability", "to", "register", "indoor", "scene", "point", "clouds", ";", "2", ")", "even", "compared", "with", "deep-learned", "methods", ",", "MAC", "still", "achieves", "better", "performance", "without", "any", "data", "training", ";", "3", ")", "in", "addition", "to", "the", "registration", "recall", "(", "RR", ")", "metric", ",", "MAC", "achieves", "the", "best", "RE", "and", "TE", "metrics", "."], ["This", "indicates", "that", "registrations", "by", "MAC", "are", "very", "accurate", "and", "MAC", "is", "able", "to", "align", "low", "overlapping", "data", "."], ["Boosting", "deep-learned", "methods", "with", "MAC", "."], ["Several", "kinds", "of", "state-of-the-art", "deep-learned", "methods", "are", "integrated", "with", "MAC", "for", "evaluation", "."], ["The", "considered", "methods", "are", "FCGF", "[", "10", "]", ",", "SpinNet", "[", "1", "]", ",", "Predator", "[", "18", "]", ",", "CoFiNet", "[", "43", "]", "and", "Geo-Transformer", "[", "29", "]", "."], ["Remarkably", ",", "MAC", "dramatically", "improves", "the", "registration", "recall", "under", "all", "tested", "methods", "on", "both", "3DMatch", "and", "3DLoMatch", "datasets", "."], ["Notably", ",", "the", "performance", "of", "Spin-Net", ",", "Predator", "and", "CoFiNet", "after", "boosting", "by", "MAC", "exceeds", "In", "Table", "4", ",", "the", "results", "of", "DGR", "[", "9", "]", ",", "PointDSC", "[", "3", "]", ",", "TEASER", "+", "+", "[", "36", "]", ",", "RANSAC", "[", "13", "]", ",", "CG-SAC", "[", "30", "]", ",", "SC", "2", "-", "PCR", "[", "8", "]", "and", "MAC", "are", "reported", "for", "comparison", "."], ["As", "shown", "by", "the", "table", ",", "in", "terms", "of", "the", "registration", "recall", "performance", ",", "MAC", "presents", "the", "best", "and", "is", "tied", "for", "the", "best", "results", "with", "FPFH", "and", "FCGF", "descriptor", "settings", ",", "respectively", "."], ["MAC", "also", "has", "a", "lower", "TE", "than", "the", "state-ofthe-art", "geometric-only", "method", "SC", "2", "-", "PCR", "."], ["The", "registration", "experiments", "on", "the", "object", ",", "indoor", "scene", ",", "and", "outdoor", "scene", "datasets", "consistently", "verify", "that", "MAC", "holds", "good", "generalization", "ability", "in", "different", "application", "contexts", "."], ["In", "this", "section", ",", "we", "perform", "ablation", "studies", "and", "analysis", "experiments", "on", "both", "3DMatch", "and", "3DLoMatch", "datasets", "."], ["Table", "8", "presents", "the", "time", "efficiency", "analysis", "of", "MAC", "."], ["Performing", "feature", "matching", "selection", "."], ["Before", "3D", "registration", ",", "a", "popular", "way", "is", "to", "perform", "outlier", "rejection", "to", "reduce", "the", "correspondence", "set", "."], ["Here", "we", "employ", "geometric", "consistency", "(", "GC", ")", "[", "7", "]", ",", "which", "is", "independent", "of", "the", "feature", "space", "and", "associates", "the", "largest", "consistent", "cluster", "relating", "to", "the", "compatibility", "among", "correspondences", "."], ["This", "demonstrates", "that", "MAC", "can", "still", "perform", "well", "even", "if", "the", "initial", "correspondence", "set", "is", "directly", "utilized", "as", "input", "without", "any", "filtering", "."], ["We", "test", "the", "performance", "of", "MAC", "by", "using", "different", "graph", "construction", "approaches", "."], ["Also", ",", "the", "registration", "recall", "obtained", "by", "using", "SOG", "is", "0.12%", "higher", "than", "using", "FOG", "when", "combined", "with", "FPFH", ",", "and", "0.56%", "higher", "when", "combined", "with", "FCGF", "on", "3DLoMatch", "."], ["Therefore", ",", "SOG", "is", "more", "suitable", "for", "MAC", "."], ["Maximum", "or", "maximal", "clique", "."], ["To", "justify", "the", "advantages", "of", "maximal", "cliques", ",", "we", "change", "the", "search", "strategy", "of", "MAC", "to", "the", "maximum", "cliques", "and", "test", "the", "registration", "performance", "."], ["As", "shown", "in", "Row", "1", "and", "9", "in", "Table", "5", ",", "applying", "maximal", "cliques", "surpasses", "maximum", "by", "9.8%", "when", "combined", "with", "FPFH", ",", "and", "5.55%", "higher", "when", "combined", "with", "FCGF", "on", "3DMatch", "."], ["Besides", ",", "the", "registration", "recall", "obtained", "by", "using", "maximal", "cliques", "is", "8.03%", "higher", "than", "using", "the", "maximum", "cliques", "when", "combined", "with", "FPFH", "and", "10.45%", "higher", "when", "combined", "with", "FCGF", "on", "3DLoMatch", "."], ["There", "are", "several", "reasons", "for", "this", ":", "1", ")", "maximal", "cliques", "include", "the", "maximum", "cliques", "and", "additionally", "consider", "local", "graph", "constraints", ",", "so", "the", "search", "for", "maximal", "cliques", "can", "make", "use", "of", "both", "local", "and", "global", "information", "in", "the", "compatibility", "graph", ";", "2", ")", "the", "maximum", "clique", "is", "a", "very", "tight", "constraint", "which", "requires", "maximizing", "the", "number", "of", "mutually", "compatible", "correspondences", ",", "but", "it", "does", "not", "guarantee", "the", "opti-mal", "result", "."], ["Node-guided", "clique", "selection", "."], ["We", "compare", "the", "performance", "with", "and", "without", "node-guided", "(", "NG", ")", "clique", "selection", "for", "maximal", "cliques", "search", "."], ["Comparing", "Row", "1", "and", "4", "in", "Table", "5", ",", "using", "NG", "achieves", "a", "recall", "improvement", "of", "0.37%", "when", "combined", "with", "FPFH", ",", "and", "0.5%", "improvement", "when", "combined", "with", "FCGF", "on", "3DMatch", "."], ["Also", ",", "using", "NG", "achieves", "a", "recall", "improvement", "of", "0.23%", "with", "FPFH", "and", "0.73%", "improvement", "with", "FCGF", "on", "3DLoMatch", "."], ["It", "is", "worth", "noting", "that", "while", "NG", "improves", "recall", ",", "the", "mean", "RE", "and", "mean", "TE", "are", "also", "decreasing", "."], ["For", "example", ",", "NG", "reduces", "the", "mean", "RE", "by", "0.1", "\u00b0", "and", "the", "mean", "TE", "by", "0.11", "cm", "with", "FPFH", "on", "3DLoMatch", "."], ["Different", "approaches", "for", "clique", "filtering", "."], ["We", "test", "the", "effectiveness", "of", "the", "two", "filtering", "methods", ",", "normal", "consistency", "and", "clique", "ranking", ".", "1", ")", "Normal", "consistency", ":", "comparing", "Row", "1", "and", "8", "in", "Table", "5", ",", "NC", "slightly", "degrades", "MAC's", "performance", ".", "2", ")", "Clique", "ranking", ":", "Row", "10", "to", "14", "demonstrate", "that", "the", "registration", "recall", "tends", "to", "increase", "as", "K", "increases", ",", "suggesting", "that", "larger", "K", "yields", "a", "subset", "of", "cliques", "that", "generate", "more", "correct", "hypotheses", "."], ["Employing", "instance-equal", "or", "weighted", "SVD", "."], ["The", "comparisons", "of", "instance-equal", "and", "weighted", "SVD", "are", "shown", "in", "Rows", "1", "and", "5", "of", "Table", "5", "Weighted", "SVD", "is", "slightly", "inferior", "to", "instance-equal", "SVD", "."], ["This", "suggests", "that", "samples", "in", "MACs", "are", "already", "very", "consistent", ",", "indicating", "no", "additional", "weighting", "strategies", "are", "required", "."], ["Here", "we", "compare", "three", "evaluation", "metrics", ",", "including", "MAE", ",", "MSE", "and", "inlier", "count", ",", "for", "MAC", "hypothesis", "evaluation", "."], ["As", "shown", "in", "Row", "1", ",", "6", "and", "7", ",", "MAC", "with", "MAE", "achieves", "the", "best", "performance", "."], ["In", "Table", "5", ",", "MAE", "achieves", "a", "recall", "improvement", "of", "0.24%", "when", "combined", "with", "FPFH", ",", "and", "0.31%", "improvement", "when", "combined", "with", "FCGF", "on", "3DMatch", "compared", "with", "the", "commonly", "used", "inlier", "count", "metric", "."], ["Also", ",", "MAE", "has", "a", "1.74%", "improvement", "when", "combined", "with", "FPFH", ",", "and", "0.05%", "when", "combined", "with", "FCGF", "on", "3DLoMatch", "compared", "with", "inlier", "count", "."], ["MAE", "is", "also", "very", "effective", "in", "reducing", "RE", "and", "TE", "."], ["Comparison", "with", "RANSAC", "hypotheses", "."], ["We", "evaluate", "the", "quality", "of", "the", "generated", "hypotheses", "by", "comparing", "the", "hypotheses", "from", "RANSAC", "and", "MAC", "with", "the", "ground", "truth", "transformation", "."], ["Compared", "to", "RANSAC", ",", "which", "randomly", "selects", "correspondences", "and", "generates", "hypotheses", "from", "the", "correspondence", "set", "without", "geometric", "constraints", ",", "MAC", "effectively", "generates", "more", "convincing", "hypotheses", "from", "maximal", "cliques", "in", "the", "compatibility", "graph", ",", "which", "fully", "exploits", "the", "consensus", "information", "in", "the", "graph", "."], ["The", "performance", "upper", "bound", "of", "MAC", "."], ["This", "can", "test", "the", "performance", "upper", "bound", "of", "MAC", "."], ["We", "vary", "the", "judging", "threshold", "for", "the", "number", "of", "generated", "correct", "hypotheses", "and", "report", "the", "results", "in", "Impressively", ",", "MAC", "-", "1", "achieves", "registration", "recalls", "of", "98.46%", "/", "91.24%", "on", "3DMatch", "/", "3DLoMatch", "."], ["This", "indicates", "that", "even", "on", "low", "overlapping", "datasets", ",", "MAC", "is", "able", "to", "produce", "correct", "hypotheses", "for", "most", "point", "cloud", "pairs", "."], ["In", "addition", ",", "we", "can", "deduce", "that", "MAC's", "performance", "can", "be", "further", "improved", "with", "better", "hypothesis", "evaluation", "metrics", "."], ["Time", "consumption", "of", "MAC", "."], ["The", "following", "observations", "can", "be", "made", ".", "1", ")", "In", "general", ",", "MAC", "can", "complete", "3D", "registration", "in", "only", "tens", "of", "milliseconds", "when", "the", "number", "of", "correspondences", "is", "smaller", "than", "1000", "."], ["Note", "that", "MAC", "is", "implemented", "on", "the", "CPU", "only", ".", "2", ")", "As", "the", "number", "of", "correspondences", "increases", "from", "250", "to", "2500", ",", "there", "is", "an", "increase", "in", "time", "cost", "for", "graph", "construction", "due", "to", "W", "SOG", "computation", "taking", "more", "time", ".", "3", ")", "When", "the", "number", "of", "correspondences", "reaches", "5000", ",", "there", "is", "a", "large", "rise", "in", "the", "time", "cost", "of", "MAC's", "registration", "."], ["The", "significant", "increase", "in", "the", "input", "size", "makes", "the", "search", "for", "maximal", "cliques", "more", "timeconsuming", "."], ["However", ",", "MAC", "is", "not", "sensitive", "to", "the", "cardinality", "of", "the", "input", "correspondence", "set", ",", "as", "verified", "in", "Table", "3", "."], ["Hence", ",", "using", "sparse", "inputs", "for", "MAC", "can", "produce", "outstanding", "performance", "while", "making", "registration", "efficient", "."], ["In", "this", "paper", ",", "we", "presented", "MAC", "to", "solve", "PCR", "by", "using", "the", "maximal", "clique", "constraint", "to", "generate", "precise", "pose", "hypotheses", "from", "correspondences", "."], ["Our", "method", "achieves", "state-of-the-art", "performance", "on", "all", "tested", "datasets", "and", "can", "adapt", "to", "deep-learned", "methods", "to", "boost", "their", "performance", "."], ["As", "shown", "in", "Table", "7", "and", "Table", "1", ",", "MAC", "produces", "accurate", "hypotheses", "but", "may", "fail", "to", "find", "them", "."]], "ner": [[[0, 1, "Task"], [3, 4, "Method"], [10, 11, "Task"], [13, 16, "Task"], [18, 18, "Task"]], [[40, 42, "Method"], [44, 45, "Method"], [47, 47, "Method"]], [[58, 59, "Method"], [98, 99, "Method"]], [[114, 116, "Method"], [125, 126, "Method"], [145, 145, "Method"], [155, 155, "Task"]], [[160, 160, "Dataset"], [162, 162, "Dataset"], [164, 164, "Dataset"], [166, 166, "Dataset"], [169, 169, "Method"], [172, 172, "Task"], [184, 185, "Method"]], [[187, 187, "Method"], [190, 191, "Method"], [194, 194, "Task"], [201, 201, "Dataset"], [203, 203, "Dataset"]], [[221, 221, "Task"], [226, 226, "Task"], [228, 230, "Task"]], [[255, 255, "Task"]], [[261, 262, "Task"]], [[278, 278, "Method"], [280, 281, "Method"]], [[284, 285, "Method"], [310, 312, "Method"], [314, 314, "Method"], [325, 325, "Task"]], [[328, 329, "Method"]], [[364, 366, "Method"], [369, 369, "Method"], [371, 371, "Method"]], [[418, 418, "Task"], [448, 448, "Task"]], [[456, 458, "Method"]], [[482, 485, "Method"], [488, 489, "Method"], [491, 491, "Method"]], [[502, 504, "Method"]], [[524, 525, "Method"], [527, 527, "Method"]], [[556, 556, "Method"]], [[566, 566, "Task"], [574, 574, "Method"]], [[595, 595, "Method"]], [[598, 598, "Method"], [615, 616, "Method"]], [[622, 624, "Method"], [628, 630, "Method"]], [[641, 641, "Method"], [651, 652, "Method"]], [[669, 669, "Method"], [672, 672, "Method"], [676, 676, "Task"], [683, 683, "Dataset"], [685, 685, "Dataset"]], [[688, 689, "Method"]], [[708, 708, "Method"]], [[747, 747, "Method"]], [[781, 781, "Method"], [785, 785, "Task"]], [[821, 821, "Task"], [824, 824, "Method"]], [[839, 841, "Method"], [843, 843, "Method"]], [[864, 866, "Method"], [868, 868, "Method"], [875, 875, "Method"]], [[886, 888, "Method"], [890, 890, "Method"]], [[920, 922, "Method"], [924, 924, "Method"]], [[950, 950, "Method"]], [[964, 966, "Method"], [968, 968, "Method"], [976, 976, "Method"]], [[1002, 1004, "Method"], [1006, 1006, "Method"]], [[1036, 1036, "Method"], [1063, 1064, "Method"], [1066, 1066, "Method"], [1069, 1071, "Method"], [1073, 1073, "Method"]], [[1078, 1078, "Method"]], [[1098, 1099, "Method"], [1105, 1106, "Method"], [1110, 1110, "Task"]], [[1112, 1112, "Method"], [1125, 1128, "Method"], [1130, 1131, "Task"]], [[1133, 1133, "Method"], [1139, 1141, "Method"], [1151, 1153, "Method"], [1156, 1159, "Task"]], [[1163, 1163, "Method"], [1169, 1170, "Method"], [1186, 1186, "Task"]], [[1195, 1195, "Method"], [1212, 1212, "Task"]], [[1214, 1216, "Method"], [1218, 1218, "Method"], [1224, 1224, "Method"], [1235, 1236, "Method"], [1242, 1243, "Method"], [1245, 1246, "Method"]], [[1248, 1248, "Method"], [1262, 1264, "Task"]], [[1275, 1275, "Task"], [1279, 1281, "Method"], [1283, 1283, "Method"]], [[1306, 1307, "Method"]], [[1317, 1317, "Method"], [1328, 1329, "Task"]], [[1331, 1331, "Method"]], [[1354, 1354, "Method"], [1368, 1368, "Method"], [1382, 1382, "Method"], [1395, 1395, "Method"], [1407, 1407, "Method"], [1419, 1421, "Method"], [1446, 1448, "Method"], [1455, 1455, "Task"]], [[1477, 1477, "Method"], [1491, 1492, "Method"]], [[1496, 1496, "Method"], [1505, 1506, "Method"]], [[1526, 1528, "Method"]], [[1541, 1541, "Method"]], [[1572, 1574, "Method"]], [[1577, 1579, "Method"], [1581, 1581, "Method"]], [[1650, 1652, "Method"]], [[1655, 1657, "Method"], [1659, 1659, "Method"], [1663, 1663, "Method"]], [[1669, 1669, "Method"]], [[1694, 1694, "Method"], [1696, 1696, "Method"], [1699, 1699, "Method"]], [[1703, 1704, "Method"]], [[1721, 1722, "Method"], [1729, 1730, "Method"]], [[1737, 1738, "Method"]], [[1744, 1745, "Method"]], [[1770, 1771, "Method"], [1779, 1780, "Method"]], [[1806, 1807, "Method"]], [[1819, 1820, "Method"], [1837, 1838, "Method"], [1846, 1847, "Method"]], [[1853, 1855, "Method"]], [[1867, 1867, "Method"]], [[1905, 1905, "Method"]], [[1914, 1915, "Method"]], [[1947, 1947, "Method"]], [[1954, 1955, "Method"], [1962, 1963, "Task"]], [[1979, 1980, "Method"]], [[1997, 1998, "Method"], [2001, 2002, "Method"]], [[2006, 2007, "Method"], [2013, 2014, "Method"]], [[2054, 2055, "Method"]], [[2059, 2059, "Method"]], [[2073, 2074, "Method"]], [[2090, 2090, "Method"], [2110, 2111, "Method"]], [[2121, 2121, "Method"]], [[2135, 2136, "Method"]], [[2147, 2147, "Task"]], [[2168, 2168, "Method"]], [[2177, 2177, "Method"]], [[2250, 2250, "Method"], [2260, 2262, "Method"], [2264, 2264, "Method"], [2267, 2269, "Method"], [2271, 2271, "Method"], [2274, 2275, "Method"]], [[2284, 2285, "Task"]], [[2298, 2298, "Dataset"], [2307, 2307, "Dataset"], [2312, 2312, "Dataset"], [2322, 2322, "Dataset"]], [[2327, 2327, "Dataset"], [2334, 2334, "Dataset"], [2339, 2339, "Dataset"]], [[2362, 2362, "Dataset"]], [[2401, 2401, "Task"]], [[2419, 2419, "Task"], [2435, 2435, "Dataset"], [2437, 2437, "Dataset"], [2451, 2451, "Dataset"]], [[2458, 2458, "Task"]], [[2488, 2490, "Method"], [2492, 2492, "Method"]], [[2502, 2502, "Dataset"], [2507, 2507, "Method"], [2509, 2509, "Method"], [2518, 2522, "Method"], [2524, 2524, "Method"]], [[2541, 2541, "Dataset"], [2543, 2543, "Dataset"], [2549, 2552, "Method"], [2554, 2554, "Method"], [2561, 2564, "Method"], [2566, 2566, "Method"]], [[2588, 2588, "Method"], [2593, 2593, "Method"], [2598, 2598, "Method"], [2603, 2603, "Method"], [2608, 2611, "Method"], [2616, 2616, "Method"], [2621, 2621, "Method"], [2627, 2627, "Method"], [2637, 2638, "Method"]], [[2644, 2644, "Method"], [2652, 2653, "Method"], [2657, 2657, "Method"], [2659, 2659, "Method"], [2661, 2661, "Method"], [2664, 2664, "Method"]], [[2667, 2667, "Task"], [2670, 2670, "Method"], [2674, 2674, "Method"], [2681, 2681, "Dataset"]], [[2683, 2683, "Task"]], [[2688, 2688, "Method"], [2690, 2691, "Method"], [2698, 2698, "Method"], [2703, 2703, "Method"], [2708, 2708, "Method"], [2713, 2715, "Method"], [2720, 2720, "Method"], [2725, 2728, "Method"], [2733, 2733, "Method"], [2738, 2738, "Method"], [2743, 2743, "Method"], [2748, 2748, "Method"]], [[2769, 2769, "Method"], [2776, 2776, "Dataset"], [2778, 2778, "Dataset"], [2797, 2798, "Method"], [2800, 2800, "Method"], [2816, 2816, "Task"], [2823, 2823, "Method"]], [[2835, 2835, "Task"], [2837, 2837, "Method"], [2842, 2842, "Method"]], [[2852, 2853, "Method"], [2855, 2855, "Method"]], [[2861, 2862, "Method"], [2866, 2866, "Method"]], [[2874, 2874, "Method"], [2879, 2879, "Method"], [2884, 2884, "Method"], [2889, 2889, "Method"], [2894, 2894, "Method"]], [[2901, 2901, "Method"], [2905, 2905, "Task"], [2913, 2913, "Dataset"], [2915, 2915, "Dataset"]], [[2923, 2923, "Method"], [2925, 2925, "Method"], [2927, 2927, "Method"], [2931, 2931, "Method"], [2940, 2940, "Method"], [2945, 2945, "Method"], [2950, 2952, "Method"], [2957, 2957, "Method"], [2962, 2962, "Method"], [2967, 2970, "Method"], [2975, 2975, "Method"]], [[2991, 2991, "Task"], [2995, 2995, "Method"], [3007, 3007, "Method"], [3009, 3009, "Method"]], [[3015, 3015, "Method"], [3024, 3025, "Method"], [3026, 3029, "Method"]], [[3032, 3032, "Task"], [3048, 3048, "Method"]], [[3071, 3071, "Dataset"], [3073, 3073, "Dataset"]], [[3084, 3084, "Method"]], [[3087, 3089, "Task"]], [[3092, 3093, "Task"]], [[3112, 3113, "Method"], [3115, 3115, "Method"]], [[3144, 3144, "Method"]], [[3169, 3169, "Method"], [3173, 3175, "Method"]], [[3180, 3180, "Task"], [3185, 3185, "Method"], [3191, 3191, "Method"], [3195, 3195, "Method"], [3203, 3203, "Method"], [3205, 3205, "Dataset"]], [[3209, 3209, "Method"], [3214, 3214, "Method"]], [[3218, 3219, "Method"]], [[3226, 3227, "Method"], [3235, 3235, "Method"], [3238, 3239, "Method"], [3243, 3243, "Task"]], [[3258, 3259, "Method"], [3267, 3267, "Method"], [3275, 3275, "Method"], [3277, 3277, "Dataset"]], [[3282, 3282, "Task"], [3287, 3288, "Method"], [3295, 3296, "Method"], [3300, 3300, "Method"], [3307, 3307, "Method"], [3309, 3309, "Dataset"]], [[3320, 3321, "Method"], [3324, 3325, "Method"], [3337, 3338, "Method"], [3356, 3357, "Method"]], [[3382, 3384, "Task"]], [[3393, 3393, "Method"], [3395, 3395, "Method"], [3400, 3401, "Method"]], [[3414, 3414, "Method"], [3424, 3424, "Method"], [3432, 3432, "Method"], [3434, 3434, "Dataset"]], [[3439, 3439, "Method"], [3447, 3447, "Method"], [3452, 3452, "Method"], [3454, 3454, "Dataset"]], [[3462, 3462, "Method"]], [[3479, 3479, "Method"], [3495, 3495, "Method"], [3497, 3497, "Dataset"]], [[3502, 3503, "Method"]], [[3515, 3516, "Method"], [3518, 3519, "Method"], [3523, 3524, "Method"], [3535, 3535, "Method"], [3538, 3538, "Method"], [3543, 3544, "Method"], [3553, 3553, "Task"]], [[3580, 3581, "Method"]], [[3588, 3589, "Method"], [3600, 3601, "Method"], [3606, 3607, "Method"]], [[3614, 3614, "Method"]], [[3636, 3636, "Method"], [3638, 3638, "Method"], [3640, 3641, "Method"], [3644, 3644, "Method"]], [[3658, 3658, "Method"], [3660, 3660, "Method"]], [[3670, 3670, "Method"], [3680, 3680, "Method"], [3688, 3688, "Method"], [3690, 3690, "Dataset"], [3696, 3697, "Method"]], [[3702, 3702, "Method"], [3710, 3710, "Method"], [3717, 3717, "Method"], [3719, 3719, "Dataset"], [3722, 3723, "Method"]], [[3725, 3725, "Method"]], [[3738, 3738, "Method"]], [[3754, 3754, "Method"], [3756, 3756, "Method"]], [[3765, 3765, "Method"], [3782, 3782, "Method"], [3789, 3790, "Method"]], [[3811, 3811, "Method"]], [[3821, 3821, "Method"]], [[3842, 3842, "Method"], [3846, 3846, "Task"], [3853, 3853, "Dataset"], [3855, 3855, "Dataset"]], [[3866, 3866, "Method"]], [[3886, 3886, "Method"]], [[3901, 3901, "Method"]], [[3915, 3915, "Method"], [3918, 3919, "Task"]], [[3937, 3937, "Method"], [3971, 3971, "Method"], [3997, 3997, "Method"], [3998, 3998, "Task"]], [[4011, 4012, "Method"]], [[4018, 4018, "Method"]], [[4043, 4043, "Method"], [4050, 4050, "Task"]], [[4059, 4059, "Method"], [4062, 4062, "Task"], [4066, 4067, "Method"]], [[4090, 4091, "Method"]], [[4106, 4106, "Method"]]], "relations": [[[3, 4, 0, 1, "Used-For"], [0, 1, 10, 11, "SubTask-Of"], [13, 16, 10, 11, "SubTask-Of"], [18, 18, 13, 16, "Synonym-Of"]], [[44, 45, 40, 42, "Part-Of"], [47, 47, 44, 45, "Synonym-Of"]], [], [[145, 145, 155, 155, "Used-For"]], [[169, 169, 160, 160, "Evaluated-With"], [169, 169, 162, 162, "Evaluated-With"], [169, 169, 164, 164, "Evaluated-With"], [169, 169, 172, 172, "Used-For"], [160, 160, 172, 172, "Benchmark-For"], [162, 162, 172, 172, "Benchmark-For"], [164, 164, 172, 172, "Benchmark-For"], [166, 166, 172, 172, "Benchmark-For"], [169, 169, 184, 185, "Part-Of"]], [[187, 187, 190, 191, "Part-Of"], [190, 191, 194, 194, "Used-For"], [203, 203, 194, 194, "Benchmark-For"], [201, 201, 194, 194, "Benchmark-For"], [190, 191, 201, 201, "Evaluated-With"], [190, 191, 203, 203, "Evaluated-With"]], [[228, 230, 226, 226, "Synonym-Of"], [221, 221, 226, 226, "Used-For"]], [], [], [], [[310, 312, 284, 285, "SubClass-Of"], [314, 314, 310, 312, "Synonym-Of"], [310, 312, 325, 325, "Used-For"]], [], [[369, 369, 364, 366, "Part-Of"], [371, 371, 369, 369, "Synonym-Of"]], [], [], [[488, 489, 482, 485, "Part-Of"], [491, 491, 488, 489, "Synonym-Of"]], [], [[527, 527, 524, 525, "Compare-With"]], [], [[574, 574, 566, 566, "Used-For"]], [], [[598, 598, 615, 616, "Compare-With"]], [[622, 624, 628, 630, "Compare-With"]], [[641, 641, 651, 652, "Part-Of"]], [[669, 669, 672, 672, "Part-Of"], [672, 672, 676, 676, "Used-For"], [683, 683, 676, 676, "Benchmark-For"], [685, 685, 676, 676, "Benchmark-For"], [672, 672, 683, 683, "Evaluated-With"], [672, 672, 685, 685, "Evaluated-With"]], [], [], [], [[781, 781, 785, 785, "Used-For"]], [[824, 824, 821, 821, "Used-For"]], [[843, 843, 839, 841, "Synonym-Of"]], [[868, 868, 864, 866, "Synonym-Of"], [875, 875, 864, 866, "Part-Of"]], [[890, 890, 886, 888, "Synonym-Of"]], [[924, 924, 920, 922, "Synonym-Of"]], [], [[968, 968, 964, 966, "Synonym-Of"]], [[1006, 1006, 1002, 1004, "Synonym-Of"]], [[1066, 1066, 1063, 1064, "Synonym-Of"], [1073, 1073, 1069, 1071, "Synonym-Of"]], [], [[1098, 1099, 1110, 1110, "Used-For"], [1105, 1106, 1110, 1110, "Used-For"]], [[1125, 1128, 1112, 1112, "Part-Of"]], [[1139, 1141, 1133, 1133, "Part-Of"], [1151, 1153, 1133, 1133, "Part-Of"], [1151, 1153, 1156, 1159, "Used-For"]], [[1169, 1170, 1163, 1163, "Part-Of"], [1163, 1163, 1186, 1186, "Used-For"]], [[1195, 1195, 1212, 1212, "Used-For"]], [[1218, 1218, 1214, 1216, "Synonym-Of"], [1235, 1236, 1214, 1216, "Part-Of"], [1235, 1236, 1224, 1224, "Part-Of"], [1242, 1243, 1235, 1236, "Part-Of"], [1245, 1246, 1235, 1236, "Part-Of"]], [[1248, 1248, 1262, 1264, "Used-For"]], [[1279, 1281, 1275, 1275, "Used-For"], [1283, 1283, 1279, 1281, "Synonym-Of"]], [], [], [], [[1446, 1448, 1455, 1455, "Used-For"]], [[1477, 1477, 1491, 1492, "Compare-With"]], [[1496, 1496, 1505, 1506, "Part-Of"]], [], [], [], [[1581, 1581, 1577, 1579, "Synonym-Of"]], [], [[1659, 1659, 1655, 1657, "Synonym-Of"], [1655, 1657, 1663, 1663, "SubClass-Of"]], [], [[1694, 1694, 1696, 1696, "Compare-With"], [1696, 1696, 1699, 1699, "Part-Of"], [1694, 1694, 1699, 1699, "Part-Of"]], [], [], [], [], [], [], [[1837, 1838, 1819, 1820, "Used-For"]], [], [], [], [], [], [[1954, 1955, 1962, 1963, "Used-For"]], [], [], [[2013, 2014, 2006, 2007, "Part-Of"]], [], [], [], [], [], [], [], [], [], [[2264, 2264, 2260, 2262, "Synonym-Of"], [2271, 2271, 2267, 2269, "Synonym-Of"]], [], [], [[2334, 2334, 2339, 2339, "SubClass-Of"]], [], [], [[2435, 2435, 2419, 2419, "Benchmark-For"], [2437, 2437, 2419, 2419, "Benchmark-For"], [2451, 2451, 2419, 2419, "Benchmark-For"]], [], [[2492, 2492, 2488, 2490, "Synonym-Of"]], [[2507, 2507, 2502, 2502, "Evaluated-With"], [2518, 2522, 2502, 2502, "Evaluated-With"], [2509, 2509, 2507, 2507, "Synonym-Of"], [2524, 2524, 2518, 2522, "Synonym-Of"]], [[2561, 2564, 2541, 2541, "Evaluated-With"], [2549, 2552, 2541, 2541, "Evaluated-With"], [2549, 2552, 2543, 2543, "Evaluated-With"], [2561, 2564, 2543, 2543, "Evaluated-With"], [2554, 2554, 2549, 2552, "Synonym-Of"], [2566, 2566, 2561, 2564, "Synonym-Of"]], [[2588, 2588, 2637, 2638, "SubClass-Of"], [2593, 2593, 2637, 2638, "SubClass-Of"], [2598, 2598, 2637, 2638, "SubClass-Of"], [2603, 2603, 2637, 2638, "SubClass-Of"]], [[2644, 2644, 2652, 2653, "Compare-With"], [2657, 2657, 2652, 2653, "SubClass-Of"], [2659, 2659, 2652, 2653, "SubClass-Of"], [2661, 2661, 2652, 2653, "SubClass-Of"], [2664, 2664, 2652, 2653, "SubClass-Of"], [2644, 2644, 2657, 2657, "Compare-With"], [2644, 2644, 2659, 2659, "Compare-With"], [2644, 2644, 2661, 2661, "Compare-With"], [2644, 2644, 2664, 2664, "Compare-With"]], [[2670, 2670, 2667, 2667, "Used-For"], [2681, 2681, 2667, 2667, "Benchmark-For"], [2674, 2674, 2670, 2670, "Part-Of"], [2670, 2670, 2681, 2681, "Evaluated-With"]], [], [[2688, 2688, 2690, 2691, "Compare-With"]], [[2769, 2769, 2776, 2776, "Evaluated-With"], [2769, 2769, 2778, 2778, "Evaluated-With"], [2800, 2800, 2797, 2798, "Compare-With"], [2823, 2823, 2816, 2816, "Used-For"]], [[2837, 2837, 2835, 2835, "Used-For"]], [[2855, 2855, 2852, 2853, "Part-Of"]], [[2866, 2866, 2861, 2862, "Part-Of"]], [], [[2901, 2901, 2905, 2905, "Used-For"], [2915, 2915, 2905, 2905, "Benchmark-For"], [2913, 2913, 2905, 2905, "Benchmark-For"], [2901, 2901, 2913, 2913, "Evaluated-With"], [2901, 2901, 2915, 2915, "Evaluated-With"]], [], [[2995, 2995, 2991, 2991, "Used-For"], [3007, 3007, 2995, 2995, "Part-Of"], [3009, 3009, 2995, 2995, "Part-Of"]], [[3015, 3015, 3024, 3025, "Compare-With"], [3026, 3029, 3024, 3025, "SubClass-Of"], [3015, 3015, 3026, 3029, "Compare-With"]], [[3048, 3048, 3032, 3032, "Used-For"]], [], [], [], [], [[3115, 3115, 3112, 3113, "Synonym-Of"]], [], [[3173, 3175, 3169, 3169, "Part-Of"]], [[3185, 3185, 3180, 3180, "Used-For"], [3191, 3191, 3180, 3180, "Used-For"], [3205, 3205, 3180, 3180, "Benchmark-For"], [3195, 3195, 3185, 3185, "Part-Of"], [3203, 3203, 3185, 3185, "Part-Of"], [3185, 3185, 3191, 3191, "Compare-With"], [3195, 3195, 3191, 3191, "Part-Of"], [3203, 3203, 3191, 3191, "Part-Of"], [3185, 3185, 3205, 3205, "Evaluated-With"], [3191, 3191, 3205, 3205, "Evaluated-With"]], [[3209, 3209, 3214, 3214, "Part-Of"]], [], [[3235, 3235, 3243, 3243, "Used-For"], [3238, 3239, 3243, 3243, "Used-For"]], [[3267, 3267, 3275, 3275, "Compare-With"], [3267, 3267, 3277, 3277, "Evaluated-With"], [3275, 3275, 3277, 3277, "Evaluated-With"]], [[3287, 3288, 3282, 3282, "Used-For"], [3307, 3307, 3287, 3288, "Part-Of"], [3300, 3300, 3287, 3288, "Part-Of"], [3300, 3300, 3295, 3296, "Part-Of"], [3307, 3307, 3295, 3296, "Part-Of"], [3309, 3309, 3295, 3296, "Evaluated-With"], [3300, 3300, 3307, 3307, "Compare-With"], [3300, 3300, 3309, 3309, "Evaluated-With"], [3307, 3307, 3309, 3309, "Evaluated-With"]], [[3324, 3325, 3320, 3321, "Part-Of"]], [], [[3395, 3395, 3393, 3393, "Synonym-Of"]], [[3424, 3424, 3414, 3414, "Part-Of"], [3432, 3432, 3414, 3414, "Part-Of"], [3414, 3414, 3434, 3434, "Evaluated-With"], [3424, 3424, 3434, 3434, "Evaluated-With"], [3432, 3432, 3434, 3434, "Evaluated-With"]], [[3447, 3447, 3439, 3439, "Part-Of"], [3452, 3452, 3439, 3439, "Part-Of"], [3439, 3439, 3454, 3454, "Evaluated-With"], [3447, 3447, 3454, 3454, "Evaluated-With"], [3452, 3452, 3454, 3454, "Evaluated-With"]], [], [[3495, 3495, 3479, 3479, "Part-Of"], [3479, 3479, 3497, 3497, "Evaluated-With"], [3495, 3495, 3497, 3497, "Evaluated-With"]], [], [[3535, 3535, 3538, 3538, "Part-Of"], [3543, 3544, 3553, 3553, "Used-For"]], [], [[3600, 3601, 3606, 3607, "Compare-With"]], [], [], [[3660, 3660, 3658, 3658, "Part-Of"]], [[3680, 3680, 3670, 3670, "Part-Of"], [3688, 3688, 3670, 3670, "Part-Of"], [3680, 3680, 3688, 3688, "Compare-With"], [3680, 3680, 3690, 3690, "Evaluated-With"], [3688, 3688, 3690, 3690, "Evaluated-With"], [3670, 3670, 3690, 3690, "Evaluated-With"], [3696, 3697, 3690, 3690, "Evaluated-With"], [3670, 3670, 3696, 3697, "Compare-With"]], [[3710, 3710, 3702, 3702, "Part-Of"], [3717, 3717, 3702, 3702, "Part-Of"], [3710, 3710, 3717, 3717, "Compare-With"], [3702, 3702, 3719, 3719, "Evaluated-With"], [3717, 3717, 3719, 3719, "Evaluated-With"], [3722, 3723, 3719, 3719, "Evaluated-With"], [3702, 3702, 3722, 3723, "Compare-With"]], [], [], [[3754, 3754, 3756, 3756, "Compare-With"]], [], [], [], [[3842, 3842, 3846, 3846, "Used-For"], [3855, 3855, 3846, 3846, "Benchmark-For"], [3853, 3853, 3846, 3846, "Benchmark-For"], [3842, 3842, 3853, 3853, "Evaluated-With"], [3842, 3842, 3855, 3855, "Evaluated-With"]], [], [], [], [[3915, 3915, 3918, 3919, "Used-For"]], [[3997, 3997, 3998, 3998, "Used-For"]], [], [], [[4043, 4043, 4050, 4050, "Used-For"]], [[4066, 4067, 4059, 4059, "Part-Of"], [4059, 4059, 4062, 4062, "Used-For"]], [], []]}
{"doc_id": "ICLR2024-AI4Material", "doc_tokens": ["MOFDIFF", ":", "COARSE-GRAINED", "DIFFUSION", "FOR", "METAL-ORGANIC", "FRAMEWORK", "DESIGN", "Metal-organic", "frameworks", "(", "MOFs", ")", "are", "of", "immense", "interest", "in", "applications", "such", "as", "gas", "storage", "and", "carbon", "capture", "due", "to", "their", "exceptional", "porosity", "and", "tunable", "chemistry", ".", "In", "this", "work", ",", "we", "propose", "MOFDiff", ":", "a", "coarse-grained", "(", "CG", ")", "diffusion", "model", "that", "generates", "CG", "MOF", "structures", "through", "a", "denoising", "diffusion", "process", "over", "the", "coordinates", "and", "identities", "of", "the", "building", "blocks", ".", "Equivariant", "graph", "neural", "networks", "are", "used", "for", "the", "diffusion", "model", "to", "respect", "the", "permutational", "and", "roto-translational", "symmetries", ".", "A", "denoising", "diffusion", "process", "conditional", "on", "z", "generates", "the", "building", "block", "identities", "and", "coordinates", ".", "To", "address", "the", "challenges", "above", ",", "we", "propose", "MOFDiff", ",", "a", "coarse-grained", "diffusion", "model", "for", "generating", "3D", "MOF", "structures", "that", "leverages", "the", "modular", "and", "hierarchical", "structure", "of", "MOFs", "(", "Figure", "1", "(", "a", ")", ")", ".", "We", "train", "MOFDiff", "on", "BW-DB", "and", "use", "MOFDiff", "to", "generate", "and", "optimize", "MOF", "structures", "for", "carbon", "capture", ".", "We", "propose", "to", "learn", "a", "contrastive", "embedding", "to", "represent", "the", "vast", "building", "block", "design", "space", ".", "\u2022", "We", "formulate", "a", "diffusion", "process", "for", "generating", "coarse-grained", "MOF", "3D", "structures", ".", "In", "order", "to", "construct", "a", "compact", "representation", "of", "building", "blocks", "for", "diffusion-based", "modeling", ",", "we", "use", "a", "contrastive", "learning", "approach", "[", "Hadsell", "et", "al", ".", ",", "2006", ",", "Chen", "et", "al", ".", ",", "2020", "]", "to", "embed", "building", "blocks", "into", "a", "low", "dimensional", "latent", "space", ".", "A", "building", "block", "i", "is", "encoded", "as", "a", "vector", "b", "i", "using", "a", "GemNet-OC", "encoder", "[", "Gasteiger", "et", "al", ".", ",", "2021", "[", "Gasteiger", "et", "al", ".", ",", ",", "2022", "]", "]", ",", "an", "SE", "(", "3", ")", "-", "invariant", "graph", "neural", "network", "model", ".", "We", "then", "train", "the", "GNN", "building", "block", "encoder", "using", "a", "contrastive", "loss", "to", "map", "small", "geometric", "variations", "of", "the", "same", "building", "block", "to", "similar", "latent", "vectors", "in", "the", "embedding", "space", ".", "The", "projected", "embedding", "is", "obtained", "by", "projecting", "the", "building", "block", "embedding", "b", "i", "using", "a", "multi-layer", "perceptron", "(", "MLP", ")", "projection", "head", ":", "s", "i", ",", "j", "=", "\u22ef", "\u22ef", "\u22ef", "\u22ef", "\u22ef", "p", "i", "=", "MLP", "(", "b", "i", ")", ".", "MOFDiff", ".", "The", "MOFDiff", "model", "is", "composed", "of", "four", "components", "(", "Figure", "1", "(", "a", ")", ")", ":", "(", "1", ")", "A", "periodic", "GemNet-OC", "encoder5", "that", "outputs", "a", "latent", "vector", "z", "=", "PGNN", "E", "(", "M", "C", ")", ";", "(", "2", ")", "an", "MLP", "predictor", "that", "predicts", "the", "lattice", "parameters", "and", "the", "number", "of", "building", "blocks", "from", "the", "latent", "code", "z", ":", "L", ",", "K", "=", "MLP", "L", ",", "K", "(", "z", ")", ";", "(", "3", ")", "a", "periodic", "GemNet-OC", "denoiser", "that", "outputs", "SE", "(", "3", ")", "-", "equivariant", "scores", "to", "denoise", "random", "structures", "to", "CG", "MOF", "structures", "conditional", "on", "the", "latent", "code", ":", "s", "A", "C", ",", "s", "X", "C", "=", "PGNN", "D", "(", "M", "C", "t", ",", "z", ")", ",", "where", "s", "A", "C", ",", "s", "X", "C", "are", "the", "predicted", "scores", "for", "building", "block", "identities", "A", "C", "and", "coordinates", "X", "C", ",", "and", "M", "C", "t", "is", "a", "noisy", "CG", "structure", "at", "time", "t", "in", "the", "diffusion", "process", ";", "(", "4", ")", "an", "MLP", "predictor", "that", "predicts", "properties", "c", "(", "such", "as", "CO", "2", "working", "capacity", ")", "from", "z", ":", "\u0109", "=", "MLP", "P", "(", "z", ")", ".", "We", "design", "an", "assembly", "algorithm", "that", "optimizes", "the", "building", "block", "orientations", "to", "match", "the", "connection", "points", "of", "adjacent", "building", "blocks", "such", "that", "the", "MOF", "becomes", "connected", "(", "visualized", "in", "Figure", "4", ")", ".", "This", "optimization", "algorithm", "places", "Gaussian", "densities", "at", "the", "position", "of", "each", "connection", "point", "and", "maximizes", "the", "overlap", "of", "these", "densities", "between", "compatible", "connection", "points", ".", "The", "radius", "of", "the", "Gaussian", "densities", "is", "gradually", "reduced", "in", "the", "optimization", "process", ":", "at", "the", "beginning", ",", "the", "radius", "is", "high", ",", "so", "the", "optimization", "problem", "is", "smoother", ",", "and", "it", "is", "simpler", "to", "find", "an", "approximate", "solution", ".", "Details", "regarding", "the", "assembly", "algorithm", "are", "included", "in", "Appendix", "A", ".2", ".", "Our", "experiments", "aim", "to", "evaluate", "two", "capabilities", "of", "MOFDiff", ":", "1", ".", "Can", "MOFDiff", "design", "functional", "MOF", "structures", "optimized", "for", "carbon", "capture", "?", "We", "train", "and", "evaluate", "our", "method", "on", "the", "BW-DB", "dataset", ",", "which", "contains", "304k", "MOFs", "with", "less", "than", "20", "building", "blocks", "(", "as", "defined", "by", "the", "metal-oxo", "decomposition", "algorithm", ")", "from", "the", "324k", "MOFs", "in", "Boyd", "et", "al", ".", "2019", ".", "We", "use", "289k", "MOFs", "(", "95%", ")", "for", "training", "and", "the", "rest", "for", "validation", ".", "We", "do", "not", "keep", "a", "test", "split", ",", "as", "we", "evaluate", "our", "generative", "model", "on", "random", "sampling", "and", "inverse", "design", "capabilities", ".", "For", "the", "relaxed", "structure", ",", "we", "adopt", "MOFChecker", "[", "Jablonka", ",", "2023", "]", "to", "check", "validity", ".", "MOFChecker", "includes", "a", "variety", "of", "criteria", ":", "the", "presence", "of", "metal", "and", "organic", "elements", ",", "porosity", ",", "no", "overlapping", "atoms", ",", "no", "non-physical", "atomic", "valences", "or", "coordination", "environments", ",", "no", "atoms", "or", "molecules", "disconnected", "from", "the", "primary", "MOF", "structure", ",", "and", "no", "excessively", "large", "atomic", "charges", ".", "For", "novelty", ",", "we", "adopt", "the", "MOF", "identifier", "extracted", "by", "MOFid", "and", "say", "a", "MOF", "is", "novel", "if", "its", "MOFid", "differs", "from", "any", "other", "MOFs", "in", "the", "training", "dataset", ".", "We", "also", "count", "the", "number", "of", "unique", "generations", "by", "filtering", "out", "replicate", "samples", "using", "their", "MOFid", ".", "MOFDiff", "generates", "valid", "and", "novel", "MOFs", ".", "We", "randomly", "sample", "10,000", "latent", "vectors", "from", "N", "(", "0", ",", "I", ")", ",", "decode", "through", "MOFDiff", ",", "assemble", ",", "and", "apply", "force", "field", "relaxation", "to", "obtain", "the", "atomic", "structures", ".", "For", "faithful", "evaluation", ",", "we", "carry", "out", "grand", "canonical", "Monte", "Carlo", "(", "GCMC", ")", "simulations", "to", "calculate", "the", "gas", "adsorption", "properties", "of", "MOF", "structures", ".", "In", "the", "appendix", ",", "Figure", "11", "shows", "the", "benchmark", "results", "of", "our", "implementation", "compared", "to", "the", "original", "labels", "of", "BW-DB", ",", "which", "demonstrate", "a", "strong", "positive", "correlation", "with", "our", "implementation", "underestimating", "the", "original", "labels", "by", "an", "average", "of", "around", "30%", ".", "MOFDiff", "is", "trained", "over", "the", "original", "BW-DB", "labels", "and", "uses", "latent-space", "optimization", "to", "maximize", "the", "BW-DB", "property", "values", ".", "MOFDiff", "discovers", "promising", "candidates", "for", "carbon", "capture", ".", "After", "conducting", "the", "validity", "checks", "described", "in", "Section", "4.1", ",", "we", "find", "2054", "MOFs", "that", "are", "valid", ",", "novel", ",", "and", "unique", "(", "Figure", "8", "(", "a", ")", ")", ".", "These", "2054", "MOFs", "are", "then", "simulated", "with", "our", "GCMC", "workflow", "to", "compute", "gas", "adsorption", "properties", ".", "Given", "the", "systematic", "differences", "between", "the", "original", "labels", "of", "BW-DB", "and", "those", "calculated", "with", "our", "reimplemented", "GCMC", "workflow", ",", "we", "randomly", "sampled", "5,000", "MOFs", "from", "the", "BW-DB", "dataset", "and", "recalculated", "the", "gas", "adsorption", "properties", "using", "our", "GCMC", "workflow", "to", "provide", "a", "fair", "baseline", "for", "comparison", ".", "We", "observe", "that", "MOFDiff", "From", "an", "efficiency", "perspective", ",", "GCMC", "simulations", "take", "orders", "of", "magnitude", "more", "computational", "time", "(", "tens", "of", "minutes", "to", "hours", ")", "than", "other", "components", "of", "the", "MOF", "design", "pipeline", "(", "seconds", "to", "tens", "of", "seconds", ")", ".", "These", "simulations", "can", "also", "be", "made", "more", "accurate", "at", "significantly", "higher", "computational", "costs", "(", "days", ")", "by", "converging", "sampling", "to", "tighter", "confidence", "intervals", "or", "using", "more", "advanced", "techniques", ",", "such", "as", "including", "blocking", "spheres", ",", "which", "prohibit", "Monte", "Carlo", "insertion", "of", "gas", "molecules", "into", "kinetically", "prohibited", "pores", "of", "the", "MOF", ",", "and", "calculating", "atomic", "charges", "with", "density", "functional", "theory", "(", "DFT", ")", ".", "Therefore", ",", "the", "efficiency", "of", "a", "MOF", "design", "pipeline", "can", "be", "evaluated", "by", "the", "average", "number", "of", "GCMC", "simulations", "required", "to", "find", "one", "qualifying", "MOF", "for", "carbon", "capture", "applications", ".", "Naively", "sampling", "from", "the", "BW-DB", "dataset", "requires", ",", "on", "average", ",", "58.1", "GCMC", "simulations", "to", "find", "one", "MOF", "with", "a", "working", "capacity", "of", "more", "than", "2", "mol", "/", "kg", ".", "Beyond", "efficiency", ",", "MOFDiff's", "generation", "flexibility", "also", "allows", "it", "to", "discover", "top", "MOF", "candidates", "that", "are", "outstanding", "for", "carbon", "capture", ".", "We", "compute", "gas", "adsorption", "properties", "of", "18", "MOFs", "that", "have", "been", "investigated", "for", "CO", "2", "adsorption", "from", "previous", "literature", "[", "Madden", "et", "al", ".", ",", "2017", ",", "Coelho", "et", "al", ".", ",", "2016", ",", "Gonz\u00e1lez-Zamora", "and", "Ibarra", ",", "2017", ",", "Boyd", "et", "al", ".", ",", "2019", "]", "using", "our", "GCMC", "simulation", "workflow", ".", "MOFDiff", "can", "discover", "highly", "promising", "candidates", ",", "making", "up", "9", "out", "of", "the", "top", "10", "MOFs", ".", "This", "comparison", "confirms", "MOFDiff's", "capability", "in", "advancing", "functional", "MOF", "design", ".", "We", "proposed", "MOFDiff", ",", "a", "coarse-grained", "diffusion", "model", "for", "metal-organic", "framework", "design", ".", "Our", "work", "presents", "a", "complete", "pipeline", "of", "representation", ",", "generative", "model", ",", "structural", "relaxation", ",", "and", "molecular", "simulation", "to", "address", "a", "specific", "carbon", "capture", "materials", "design", "problem", ".", "We", "then", "design", "an", "assembly", "algorithm", "to", "realize", "the", "all-atom", "MOF", "structures", "and", "characterize", "their", "properties", "with", "molecular", "simulations", ".", "MOFDiff", "can", "generate", "valid", "and", "novel", "MOF", "structures", "covering", "a", "wide", "range", "of", "structural", "properties", "as", "well", "as", "optimize", "MOFs", "for", "carbon", "capture", "applications", "that", "surpass", "state-of-the-art", "MOFs", "in", "molecular", "simulations", "."], "sentences": [["MOFDIFF", ":", "COARSE-GRAINED", "DIFFUSION", "FOR", "METAL-ORGANIC", "FRAMEWORK", "DESIGN", "Metal-organic", "frameworks", "(", "MOFs", ")", "are", "of", "immense", "interest", "in", "applications", "such", "as", "gas", "storage", "and", "carbon", "capture", "due", "to", "their", "exceptional", "porosity", "and", "tunable", "chemistry", "."], ["In", "this", "work", ",", "we", "propose", "MOFDiff", ":", "a", "coarse-grained", "(", "CG", ")", "diffusion", "model", "that", "generates", "CG", "MOF", "structures", "through", "a", "denoising", "diffusion", "process", "over", "the", "coordinates", "and", "identities", "of", "the", "building", "blocks", "."], ["Equivariant", "graph", "neural", "networks", "are", "used", "for", "the", "diffusion", "model", "to", "respect", "the", "permutational", "and", "roto-translational", "symmetries", "."], ["A", "denoising", "diffusion", "process", "conditional", "on", "z", "generates", "the", "building", "block", "identities", "and", "coordinates", "."], ["To", "address", "the", "challenges", "above", ",", "we", "propose", "MOFDiff", ",", "a", "coarse-grained", "diffusion", "model", "for", "generating", "3D", "MOF", "structures", "that", "leverages", "the", "modular", "and", "hierarchical", "structure", "of", "MOFs", "(", "Figure", "1", "(", "a", ")", ")", "."], ["We", "train", "MOFDiff", "on", "BW-DB", "and", "use", "MOFDiff", "to", "generate", "and", "optimize", "MOF", "structures", "for", "carbon", "capture", "."], ["We", "propose", "to", "learn", "a", "contrastive", "embedding", "to", "represent", "the", "vast", "building", "block", "design", "space", ".", "\u2022", "We", "formulate", "a", "diffusion", "process", "for", "generating", "coarse-grained", "MOF", "3D", "structures", "."], ["In", "order", "to", "construct", "a", "compact", "representation", "of", "building", "blocks", "for", "diffusion-based", "modeling", ",", "we", "use", "a", "contrastive", "learning", "approach", "[", "Hadsell", "et", "al", ".", ",", "2006", ",", "Chen", "et", "al", ".", ",", "2020", "]", "to", "embed", "building", "blocks", "into", "a", "low", "dimensional", "latent", "space", "."], ["A", "building", "block", "i", "is", "encoded", "as", "a", "vector", "b", "i", "using", "a", "GemNet-OC", "encoder", "[", "Gasteiger", "et", "al", ".", ",", "2021", "[", "Gasteiger", "et", "al", ".", ",", ",", "2022", "]", "]", ",", "an", "SE", "(", "3", ")", "-", "invariant", "graph", "neural", "network", "model", "."], ["We", "then", "train", "the", "GNN", "building", "block", "encoder", "using", "a", "contrastive", "loss", "to", "map", "small", "geometric", "variations", "of", "the", "same", "building", "block", "to", "similar", "latent", "vectors", "in", "the", "embedding", "space", "."], ["The", "projected", "embedding", "is", "obtained", "by", "projecting", "the", "building", "block", "embedding", "b", "i", "using", "a", "multi-layer", "perceptron", "(", "MLP", ")", "projection", "head", ":", "s", "i", ",", "j", "=", "\u22ef", "\u22ef", "\u22ef", "\u22ef", "\u22ef", "p", "i", "=", "MLP", "(", "b", "i", ")", "."], ["MOFDiff", "."], ["The", "MOFDiff", "model", "is", "composed", "of", "four", "components", "(", "Figure", "1", "(", "a", ")", ")", ":", "(", "1", ")", "A", "periodic", "GemNet-OC", "encoder5", "that", "outputs", "a", "latent", "vector", "z", "=", "PGNN", "E", "(", "M", "C", ")", ";", "(", "2", ")", "an", "MLP", "predictor", "that", "predicts", "the", "lattice", "parameters", "and", "the", "number", "of", "building", "blocks", "from", "the", "latent", "code", "z", ":", "L", ",", "K", "=", "MLP", "L", ",", "K", "(", "z", ")", ";", "(", "3", ")", "a", "periodic", "GemNet-OC", "denoiser", "that", "outputs", "SE", "(", "3", ")", "-", "equivariant", "scores", "to", "denoise", "random", "structures", "to", "CG", "MOF", "structures", "conditional", "on", "the", "latent", "code", ":", "s", "A", "C", ",", "s", "X", "C", "=", "PGNN", "D", "(", "M", "C", "t", ",", "z", ")", ",", "where", "s", "A", "C", ",", "s", "X", "C", "are", "the", "predicted", "scores", "for", "building", "block", "identities", "A", "C", "and", "coordinates", "X", "C", ",", "and", "M", "C", "t", "is", "a", "noisy", "CG", "structure", "at", "time", "t", "in", "the", "diffusion", "process", ";", "(", "4", ")", "an", "MLP", "predictor", "that", "predicts", "properties", "c", "(", "such", "as", "CO", "2", "working", "capacity", ")", "from", "z", ":", "\u0109", "=", "MLP", "P", "(", "z", ")", "."], ["We", "design", "an", "assembly", "algorithm", "that", "optimizes", "the", "building", "block", "orientations", "to", "match", "the", "connection", "points", "of", "adjacent", "building", "blocks", "such", "that", "the", "MOF", "becomes", "connected", "(", "visualized", "in", "Figure", "4", ")", "."], ["This", "optimization", "algorithm", "places", "Gaussian", "densities", "at", "the", "position", "of", "each", "connection", "point", "and", "maximizes", "the", "overlap", "of", "these", "densities", "between", "compatible", "connection", "points", "."], ["The", "radius", "of", "the", "Gaussian", "densities", "is", "gradually", "reduced", "in", "the", "optimization", "process", ":", "at", "the", "beginning", ",", "the", "radius", "is", "high", ",", "so", "the", "optimization", "problem", "is", "smoother", ",", "and", "it", "is", "simpler", "to", "find", "an", "approximate", "solution", "."], ["Details", "regarding", "the", "assembly", "algorithm", "are", "included", "in", "Appendix", "A", ".2", "."], ["Our", "experiments", "aim", "to", "evaluate", "two", "capabilities", "of", "MOFDiff", ":", "1", "."], ["Can", "MOFDiff", "design", "functional", "MOF", "structures", "optimized", "for", "carbon", "capture", "?"], ["We", "train", "and", "evaluate", "our", "method", "on", "the", "BW-DB", "dataset", ",", "which", "contains", "304k", "MOFs", "with", "less", "than", "20", "building", "blocks", "(", "as", "defined", "by", "the", "metal-oxo", "decomposition", "algorithm", ")", "from", "the", "324k", "MOFs", "in", "Boyd", "et", "al", ".", "2019", "."], ["We", "use", "289k", "MOFs", "(", "95%", ")", "for", "training", "and", "the", "rest", "for", "validation", "."], ["We", "do", "not", "keep", "a", "test", "split", ",", "as", "we", "evaluate", "our", "generative", "model", "on", "random", "sampling", "and", "inverse", "design", "capabilities", "."], ["For", "the", "relaxed", "structure", ",", "we", "adopt", "MOFChecker", "[", "Jablonka", ",", "2023", "]", "to", "check", "validity", "."], ["MOFChecker", "includes", "a", "variety", "of", "criteria", ":", "the", "presence", "of", "metal", "and", "organic", "elements", ",", "porosity", ",", "no", "overlapping", "atoms", ",", "no", "non-physical", "atomic", "valences", "or", "coordination", "environments", ",", "no", "atoms", "or", "molecules", "disconnected", "from", "the", "primary", "MOF", "structure", ",", "and", "no", "excessively", "large", "atomic", "charges", "."], ["For", "novelty", ",", "we", "adopt", "the", "MOF", "identifier", "extracted", "by", "MOFid", "and", "say", "a", "MOF", "is", "novel", "if", "its", "MOFid", "differs", "from", "any", "other", "MOFs", "in", "the", "training", "dataset", "."], ["We", "also", "count", "the", "number", "of", "unique", "generations", "by", "filtering", "out", "replicate", "samples", "using", "their", "MOFid", "."], ["MOFDiff", "generates", "valid", "and", "novel", "MOFs", "."], ["We", "randomly", "sample", "10,000", "latent", "vectors", "from", "N", "(", "0", ",", "I", ")", ",", "decode", "through", "MOFDiff", ",", "assemble", ",", "and", "apply", "force", "field", "relaxation", "to", "obtain", "the", "atomic", "structures", "."], ["For", "faithful", "evaluation", ",", "we", "carry", "out", "grand", "canonical", "Monte", "Carlo", "(", "GCMC", ")", "simulations", "to", "calculate", "the", "gas", "adsorption", "properties", "of", "MOF", "structures", "."], ["In", "the", "appendix", ",", "Figure", "11", "shows", "the", "benchmark", "results", "of", "our", "implementation", "compared", "to", "the", "original", "labels", "of", "BW-DB", ",", "which", "demonstrate", "a", "strong", "positive", "correlation", "with", "our", "implementation", "underestimating", "the", "original", "labels", "by", "an", "average", "of", "around", "30%", "."], ["MOFDiff", "is", "trained", "over", "the", "original", "BW-DB", "labels", "and", "uses", "latent-space", "optimization", "to", "maximize", "the", "BW-DB", "property", "values", "."], ["MOFDiff", "discovers", "promising", "candidates", "for", "carbon", "capture", "."], ["After", "conducting", "the", "validity", "checks", "described", "in", "Section", "4.1", ",", "we", "find", "2054", "MOFs", "that", "are", "valid", ",", "novel", ",", "and", "unique", "(", "Figure", "8", "(", "a", ")", ")", "."], ["These", "2054", "MOFs", "are", "then", "simulated", "with", "our", "GCMC", "workflow", "to", "compute", "gas", "adsorption", "properties", "."], ["Given", "the", "systematic", "differences", "between", "the", "original", "labels", "of", "BW-DB", "and", "those", "calculated", "with", "our", "reimplemented", "GCMC", "workflow", ",", "we", "randomly", "sampled", "5,000", "MOFs", "from", "the", "BW-DB", "dataset", "and", "recalculated", "the", "gas", "adsorption", "properties", "using", "our", "GCMC", "workflow", "to", "provide", "a", "fair", "baseline", "for", "comparison", "."], ["We", "observe", "that", "MOFDiff", "From", "an", "efficiency", "perspective", ",", "GCMC", "simulations", "take", "orders", "of", "magnitude", "more", "computational", "time", "(", "tens", "of", "minutes", "to", "hours", ")", "than", "other", "components", "of", "the", "MOF", "design", "pipeline", "(", "seconds", "to", "tens", "of", "seconds", ")", "."], ["These", "simulations", "can", "also", "be", "made", "more", "accurate", "at", "significantly", "higher", "computational", "costs", "(", "days", ")", "by", "converging", "sampling", "to", "tighter", "confidence", "intervals", "or", "using", "more", "advanced", "techniques", ",", "such", "as", "including", "blocking", "spheres", ",", "which", "prohibit", "Monte", "Carlo", "insertion", "of", "gas", "molecules", "into", "kinetically", "prohibited", "pores", "of", "the", "MOF", ",", "and", "calculating", "atomic", "charges", "with", "density", "functional", "theory", "(", "DFT", ")", "."], ["Therefore", ",", "the", "efficiency", "of", "a", "MOF", "design", "pipeline", "can", "be", "evaluated", "by", "the", "average", "number", "of", "GCMC", "simulations", "required", "to", "find", "one", "qualifying", "MOF", "for", "carbon", "capture", "applications", "."], ["Naively", "sampling", "from", "the", "BW-DB", "dataset", "requires", ",", "on", "average", ",", "58.1", "GCMC", "simulations", "to", "find", "one", "MOF", "with", "a", "working", "capacity", "of", "more", "than", "2", "mol", "/", "kg", "."], ["Beyond", "efficiency", ",", "MOFDiff's", "generation", "flexibility", "also", "allows", "it", "to", "discover", "top", "MOF", "candidates", "that", "are", "outstanding", "for", "carbon", "capture", "."], ["We", "compute", "gas", "adsorption", "properties", "of", "18", "MOFs", "that", "have", "been", "investigated", "for", "CO", "2", "adsorption", "from", "previous", "literature", "[", "Madden", "et", "al", ".", ",", "2017", ",", "Coelho", "et", "al", ".", ",", "2016", ",", "Gonz\u00e1lez-Zamora", "and", "Ibarra", ",", "2017", ",", "Boyd", "et", "al", ".", ",", "2019", "]", "using", "our", "GCMC", "simulation", "workflow", "."], ["MOFDiff", "can", "discover", "highly", "promising", "candidates", ",", "making", "up", "9", "out", "of", "the", "top", "10", "MOFs", "."], ["This", "comparison", "confirms", "MOFDiff's", "capability", "in", "advancing", "functional", "MOF", "design", "."], ["We", "proposed", "MOFDiff", ",", "a", "coarse-grained", "diffusion", "model", "for", "metal-organic", "framework", "design", "."], ["Our", "work", "presents", "a", "complete", "pipeline", "of", "representation", ",", "generative", "model", ",", "structural", "relaxation", ",", "and", "molecular", "simulation", "to", "address", "a", "specific", "carbon", "capture", "materials", "design", "problem", "."], ["We", "then", "design", "an", "assembly", "algorithm", "to", "realize", "the", "all-atom", "MOF", "structures", "and", "characterize", "their", "properties", "with", "molecular", "simulations", "."], ["MOFDiff", "can", "generate", "valid", "and", "novel", "MOF", "structures", "covering", "a", "wide", "range", "of", "structural", "properties", "as", "well", "as", "optimize", "MOFs", "for", "carbon", "capture", "applications", "that", "surpass", "state-of-the-art", "MOFs", "in", "molecular", "simulations", "."]], "ner": [[[0, 0, "Method"], [2, 3, "Method"], [5, 7, "Task"], [8, 9, "Method"], [11, 11, "Method"], [21, 22, "Task"], [24, 25, "Task"]], [[41, 41, "Method"], [44, 49, "Method"], [52, 53, "Task"]], [[70, 73, "Method"]], [[89, 91, "Method"]], [[111, 111, "Method"], [114, 116, "Method"]], [[141, 141, "Method"], [143, 143, "Dataset"], [146, 146, "Method"], [154, 155, "Task"]], [[162, 163, "Method"]], [[197, 198, "Task"], [203, 204, "Method"]], [[245, 245, "Method"], [272, 274, "Method"]], [[281, 284, "Method"], [287, 288, "Method"]], [[323, 324, "Method"], [326, 326, "Method"], [344, 344, "Method"]], [[350, 350, "Method"]], [[353, 353, "Method"], [373, 373, "Method"], [393, 393, "Method"], [416, 416, "Method"], [429, 429, "Method"], [516, 516, "Method"], [535, 535, "Method"]], [[544, 545, "Method"]], [[575, 576, "Method"], [578, 579, "Method"]], [[603, 604, "Method"]], [[642, 643, "Method"]], [[659, 659, "Method"]], [[664, 664, "Method"], [671, 672, "Task"]], [[682, 682, "Dataset"]], [[718, 718, "Method"]], [[742, 743, "Method"]], [[759, 759, "Method"]], [[769, 769, "Method"]], [[826, 826, "Method"], [835, 835, "Method"], [840, 840, "Method"]], [[861, 861, "Method"]], [[863, 863, "Method"]], [[886, 886, "Method"]], [[908, 911, "Method"], [913, 913, "Method"]], [[945, 945, "Dataset"]], [[967, 967, "Method"], [973, 973, "Dataset"], [982, 982, "Dataset"]], [[986, 986, "Method"], [991, 992, "Task"]], [[1007, 1007, "Method"]], [[1026, 1026, "Method"], [1032, 1032, "Method"]], [[1049, 1049, "Dataset"], [1056, 1056, "Method"], [1066, 1066, "Dataset"], [1076, 1076, "Method"]], [[1089, 1089, "Method"], [1095, 1095, "Method"]], [[1183, 1185, "Method"], [1187, 1187, "Method"]], [[1207, 1207, "Method"], [1216, 1217, "Task"]], [[1224, 1224, "Dataset"], [1232, 1232, "Method"]], [[1253, 1253, "Method"], [1268, 1269, "Task"]], [[1278, 1278, "Method"], [1320, 1320, "Method"]], [[1324, 1324, "Method"], [1339, 1339, "Method"]], [[1344, 1344, "Method"]], [[1354, 1354, "Method"], [1357, 1359, "Method"], [1361, 1363, "Task"]], [[1372, 1372, "Method"], [1374, 1375, "Method"], [1377, 1378, "Method"], [1381, 1382, "Method"], [1387, 1390, "Task"]], [[1397, 1398, "Method"]], [[1413, 1413, "Method"], [1432, 1432, "Method"], [1434, 1435, "Task"], [1440, 1440, "Method"], [1442, 1443, "Task"]]], "relations": [[[2, 3, 5, 7, "Used-For"], [11, 11, 8, 9, "Synonym-Of"], [8, 9, 21, 22, "Used-For"], [8, 9, 24, 25, "Used-For"]], [[41, 41, 44, 49, "SubClass-Of"], [41, 41, 52, 53, "Used-For"]], [], [], [[111, 111, 114, 116, "SubClass-Of"]], [[141, 141, 143, 143, "Trained-With"], [146, 146, 154, 155, "Used-For"], [143, 143, 154, 155, "Benchmark-For"]], [], [[203, 204, 197, 198, "Used-For"]], [[245, 245, 272, 274, "SubClass-Of"]], [[287, 288, 281, 284, "Part-Of"]], [[326, 326, 323, 324, "Synonym-Of"]], [], [[373, 373, 353, 353, "Part-Of"], [393, 393, 353, 353, "Part-Of"], [429, 429, 353, 353, "Part-Of"], [516, 516, 353, 353, "Part-Of"]], [], [], [], [], [], [[664, 664, 671, 672, "Used-For"]], [], [], [], [], [], [[835, 835, 840, 840, "Compare-With"]], [], [], [], [[913, 913, 908, 911, "Synonym-Of"]], [], [[967, 967, 973, 973, "Trained-With"]], [[986, 986, 991, 992, "Used-For"]], [], [], [], [], [[1187, 1187, 1183, 1185, "Synonym-Of"]], [[1207, 1207, 1216, 1217, "Used-For"]], [[1232, 1232, 1224, 1224, "Evaluated-With"]], [[1253, 1253, 1268, 1269, "Used-For"]], [], [], [], [[1354, 1354, 1357, 1359, "SubClass-Of"], [1354, 1354, 1361, 1363, "Used-For"], [1357, 1359, 1361, 1363, "Used-For"]], [[1372, 1372, 1387, 1390, "Used-For"], [1374, 1375, 1387, 1390, "Used-For"], [1377, 1378, 1387, 1390, "Used-For"], [1381, 1382, 1387, 1390, "Used-For"]], [], [[1413, 1413, 1432, 1432, "Used-For"], [1413, 1413, 1434, 1435, "Used-For"], [1432, 1432, 1434, 1435, "Used-For"], [1440, 1440, 1442, 1443, "Used-For"]]]}
